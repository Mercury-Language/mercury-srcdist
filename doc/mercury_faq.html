<html lang="en">
<head>
<title>The Mercury FAQ list</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The Mercury FAQ list">
<meta name="generator" content="makeinfo 4.11">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
This file is the Mercury Frequently Asked Questions List, version rotd-2009-06-06. 
It contains a list of frequently asked questions about Mercury, with answers.

   <p>Copyright (C) 1995-1997,1999,2001-2009 The University of Melbourne.

   <p>Permission is granted to make and distribute verbatim copies of
this FAQ list provided the copyright notice and this permission notice
are preserved on all copies.

   <p>Permission is granted to copy and distribute modified versions of this
FAQ list under the conditions for verbatim copying, provided also that
the entire resulting derived work is distributed under the terms of a
permission notice identical to this one.

   <p>Permission is granted to copy and distribute translations of this FAQ list
into another language, under the above conditions for modified versions.

   <div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">The Mercury Frequently Asked Questions List, version rotd-2009-06-06</a>
<li><a name="toc_Installing" href="#Installing">1 Problems during compilation and installation.</a>
<li><a name="toc_Programming" href="#Programming">2 Common programming errors</a>
<li><a name="toc_Unimplemented" href="#Unimplemented">3 Problems caused by unimplemented Mercury features</a>
<li><a name="toc_Last-resort" href="#Last-resort">4 What to do when all else fails</a>
</li></ul>
</div>

<div class="node">
<p><hr>
<a name="Top"></a>
Up:&nbsp;<a rel="up" accesskey="u" href="#g_t_0028mercury_0029">(mercury)</a>

</div>

<h2 class="unnumbered">The Mercury Frequently Asked Questions List, version rotd-2009-06-06</h2>

<ul class="menu">
<li><a accesskey="1" href="#Installing">Installing</a>:       Problems during compilation and installation. 
<li><a accesskey="2" href="#Programming">Programming</a>:      Common programming errors. 
<li><a accesskey="3" href="#Unimplemented">Unimplemented</a>:    Problems caused by unimplemented Mercury features. 
<li><a accesskey="4" href="#Last-resort">Last resort</a>:      What to do when all else fails. 
</ul>

<div class="node">
<p><hr>
<a name="Installing"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="#Programming">Programming</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">1 Problems during compilation and installation.</h2>

     <ol type=1 start=1>

     <li><em>The compiler crashes during the &ldquo;make install&rdquo; phase</em>
     <pre class="sp">
     
     </pre>
     
An incompatibility between Mercury's low-level C backend and some GCC
optimizations in GCC 4.2 seems to be causing problems.  Try using a different
version of GCC, otherwise the following instructions may help.

     <p>After unpacking the tarball but before running &lsquo;<samp><span class="samp">configure</span></samp>&rsquo;, create a file in
the root directory of the unpacked source named &lsquo;<samp><span class="samp">Mmake.params</span></samp>&rsquo; containing
the line &lsquo;<samp><span class="samp">-EXTRA_CFLAGS=-O0</span></samp>&rsquo;, and run &lsquo;<samp><span class="samp">configure</span></samp>&rsquo; as
&lsquo;<samp><span class="samp">./configure --with-llds-base-grade=none --with-default-grade=hlc.gc</span></samp>&rsquo;. 
This disables GCC's optimizations and nearly all of Mercury's optimizations for
the low-level C backend.

     <p>Programs built using this Mercury installation will use the high-level C
backend by default.  To build a program in the low-level C grade the GCC
optimizations should be disabled by creating a &lsquo;<samp><span class="samp">Mmake.params</span></samp>&rsquo; file in the
root directory of the program, as described above for the compiler.

     <p>See bugs 66 and 77 in the bug database.

     <pre class="sp">
     
     </pre>
     <li><em>The &ldquo;make install&rdquo; phase takes ages!  What's going on?</em>
     <pre class="sp">
     
     </pre>
     
Mercury supports many grades.  A grade is a combination the target language and
feature options.  These features include garbage collection, debugging and
profiling support.  See &ldquo;Grades and grade components&rdquo; in the User's Guide.

     <p>During the &ldquo;make install&rdquo; phase the newly built compiler is used to compile
the standard library in each of the selected grades.  The runtime system is
also rebuilt for each grade.

     <p>To install fewer grades and reduce the time &ldquo;make install&rdquo; takes, see the
configure script's options, in particular &lsquo;<samp><span class="samp">--disable-most-grades</span></samp>&rsquo;. 
Alternatively, run &lsquo;<samp><span class="samp">make install LIBGRADES=&lt;grades&gt;</span></samp>&rsquo; instead, where
&ldquo;&lt;grades&gt;&rdquo; is a space-separated list of grades.

     </ol>

<div class="node">
<p><hr>
<a name="Programming"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="#Unimplemented">Unimplemented</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Installing">Installing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">2 Common programming errors</h2>

     <ol type=1 start=1>

     <li><em>What does the error message &ldquo;undefined symbol &lsquo;</em><samp><span class="samp">'.'/2</span></samp><em>&rsquo;&rdquo; mean?</em>
     <pre class="sp">
     
     </pre>
     
You need to explicitly import the &lsquo;<samp><span class="samp">list</span></samp>&rsquo; module

     <pre class="example">          :- import_module list.
</pre>
     <p class="noindent">if your code uses lists. Similarly, if your code uses arithmetic operations,
you will need to import the &lsquo;<samp><span class="samp">int</span></samp>&rsquo; and possibly &lsquo;<samp><span class="samp">float</span></samp>&rsquo; modules.

     <pre class="sp">
     
     </pre>
     <li><em>Why doesn't &lsquo;</em><samp><span class="samp">X &lt;= 3</span></samp><em>&rsquo; work?</em>
     <pre class="sp">
     
     </pre>
     
In Mercury, less-than-or-equal-to is written as &lsquo;<samp><span class="samp">=&lt;</span></samp>&rsquo; not
as &lsquo;<samp><span class="samp">&lt;=</span></samp>&rsquo;, which is used for reverse implication.

     <pre class="sp">
     
     </pre>
     <li><em>I defined a type like this: &lsquo;</em><samp><span class="samp">:- type number ---&gt; int ; float.</span></samp><em>&rsquo;
Why doesn't this work?</em>
     <pre class="sp">
     
     </pre>
     
You tried to define a type that is an undiscriminated union of two types,
which is not allowed by the Mercury type system. 
The declaration above defines an enumerated type with two constants,
&ldquo;int&rdquo; and &ldquo;float&rdquo;. 
This is not what you want, but it is legal Mercury,
which is why you don't get an error message on the type declaration itself.

     <pre class="sp">
     
     </pre>
     <li><em>I get a &ldquo;scope error&rdquo; in an if-then-else. 
I checked and both branches bind the same variables. What is the error?</em>
     <pre class="sp">
     
     </pre>
     
This error generally happens if you attempt bind non-local variables
in the <em>condition</em> of the if-then-else.  For example, the following
code attempts to bind &lsquo;<samp><span class="samp">Value</span></samp>&rsquo; in the call to &lsquo;<samp><span class="samp">map.search</span></samp>&rsquo;,
but &lsquo;<samp><span class="samp">Value</span></samp>&rsquo; occurs outside of the if-then-else &mdash; in particular,
it occurs in the head of the clause.

     <pre class="example">          :- pred map.search(map(K, V), K, V).
          :- mode map.search(in, in, out) is semidet.
          
          :- pred lookup(map(string, int), string, int).
          :- mode lookup(in, in, out) is det.
          
          lookup(Map, Key, Value) :-
                  (if map.search(Map, Key, Value) then
                          true
                  else
                          Value = -1
                  ).
</pre>
     <p>Binding non-local variables in the condition of an if-then-else
is forbidden since it would be unsound; it would lead to inconsistent
results.  For example, &lsquo;<samp><span class="samp">(X = 1 -&gt; Y = 1 ; Y = 2), X = 2</span></samp>&rsquo; would fail,
but &lsquo;<samp><span class="samp">X = 2, (X = 1 -&gt; Y = 1 ; Y = 2)</span></samp>&rsquo; would succeed &mdash; breaking
one of the fundamental laws of logic, &lsquo;<samp><span class="samp">(P, Q) &lt;=&gt; (Q, P)</span></samp>&rsquo;.

     <p>Mode analysis therefore rejects such programs. 
(In certain rare circumstances, the compiler may report this as a
&ldquo;mode error&rdquo; rather than a &ldquo;scope error&rdquo;.) 
The way to fix such errors is to avoid binding non-local
variables in the <em>condition</em>, and instead bind them in the <em>then</em>
part of the if-then-else.  So in the above example, you should introduce
a new local variable, which we will call &lsquo;<samp><span class="samp">Value1</span></samp>&rsquo;:

     <pre class="example">          lookup(Map, Key, Value) :-
                  (if some [Value1]
                          map.search(Map, Key, Value1)
                  then
                          Value = Value1
                  else
                          Value = -1
                  ).
</pre>
     <p class="noindent">The explicit existential quantifier is optional; if you
prefer a slightly more succinct style you can write this as

     <pre class="example">          lookup(Map, Key, Value) :-
                  ( map.search(Map, Key, Value1) -&gt;
                          Value = Value1
                  ;
                          Value = -1
                  ).
</pre>
     <li><em>&ldquo;I keep getting a link error &lsquo;</em><samp><span class="samp">undefined symbol init_gc</span></samp><em>&rsquo;.  Why?&rdquo;</em>
     <pre class="sp">
     
     </pre>
     
If you are using &lsquo;<samp><span class="samp">mmake</span></samp>&rsquo; to recompile your program, and you are
overriding the default grade (e.g. by setting &lsquo;<samp><span class="samp">GRADE=asm_fast</span></samp>&rsquo; in your
&lsquo;<samp><span class="samp">Mmake</span></samp>&rsquo; file), you must make sure that you do &lsquo;<samp><span class="samp">mmake clean</span></samp>&rsquo; every
time you change grades.

     </ol>

<div class="node">
<p><hr>
<a name="Unimplemented"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="#Last-resort">Last resort</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Programming">Programming</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">3 Problems caused by unimplemented Mercury features</h2>

     <ol type=1 start=1>
<li><em>How can I avoid getting a compile-time error when I try to
fill in a partially instantiated data structure?</em>
     <pre class="sp">
     
     </pre>
     
At the moment, you can create a partially instantiated data structure,
but you can't fill in the holes. 
The reason is that the code that does the filling in
must temporarily alias two variables together,
and the current mode checker does not allow this. 
This limitation will go away in the future.

     <pre class="sp">
     
     </pre>
     <li><em>I'm getting an error from the C compiler:</em>
     <pre class="example">          foo.c:45: initializer is not computable at load time
</pre>
     <pre class="sp">
     
     </pre>
     
You're using an old version of &lsquo;<samp><span class="samp">gcc</span></samp>&rsquo;. 
Check that the version of &lsquo;<samp><span class="samp">gcc</span></samp>&rsquo; in your PATH is version 2.6.3 or later. 
Mercury does not (at the current time) support versions of gcc earlier
than 2.6.3.  (Using the &lsquo;<samp><span class="samp">--no-static-ground-terms</span></samp>&rsquo; option may also solve
this problem, but results in less efficient code.)

     </ol>

<div class="node">
<p><hr>
<a name="Last-resort"></a>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Unimplemented">Unimplemented</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">4 What to do when all else fails</h2>

     <ol type=1 start=1>

     <li><em>I'm getting an error message that I don't understand.  What can I do?</em>
     <pre class="sp">
     
     </pre>
     
Try compiling with the &lsquo;<samp><span class="samp">-E</span></samp>&rsquo; (&lsquo;<samp><span class="samp">--verbose-error-messages</span></samp>&rsquo;) option. 
This option causes the compiler to give even more verbose descriptions
than usual.

     <pre class="sp">
     
     </pre>
     <li><em>I followed the instructions in the user's guide,
but it still didn't work. What do I do next?</em>
     <pre class="sp">
     
     </pre>
     
Send email to <code>mercury-bugs@csse.unimelb.edu.au</code>,
and we'll try to solve your problem.

     </ol>

</body></html>

