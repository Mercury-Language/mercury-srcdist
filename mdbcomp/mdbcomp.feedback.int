:- module (mdbcomp.feedback).
:- interface.
:- import_module int.
:- import_module io.
:- import_module list.
:- import_module maybe.
:- import_module string.
:- import_module (mdbcomp.program_representation).
:- type feedback_data
	--->	feedback_data_calls_above_threshold_sorted(((mdbcomp.feedback).threshold) :: int, ((mdbcomp.feedback).stat_measure) :: ((mdbcomp.feedback).stat_measure), ((mdbcomp.feedback).calls) :: (list.list(((mdbcomp.program_representation).call_site)))).
:- type feedback_info.
:- type feedback_read_error
	--->	open_error((io.error))
	;	read_error((io.error))
	;	parse_error(((mdbcomp.feedback).message) :: string, ((mdbcomp.feedback).line_no) :: int)
	;	unexpected_eof 
	;	incorrect_version 
	;	incorrect_first_line 
	;	incorrect_program_name .
:- type feedback_type
	--->	feedback_type_calls_above_threshold_sorted .
:- type feedback_write_result
	--->	ok 
	;	open_error((io.error))
	;	write_error((io.error)).
:- type stat_measure
	--->	stat_mean 
	;	stat_median .
:- type feedback_read_result(T)
	--->	ok(T)
	;	error(((mdbcomp.feedback).feedback_read_error)).
:- pred get_feedback_data(((mdbcomp.feedback).feedback_type), (maybe.maybe(((mdbcomp.feedback).feedback_data))), ((mdbcomp.feedback).feedback_info)).
:- mode get_feedback_data((builtin.in), (builtin.out), (builtin.in)) is det.
:- func init_feedback_info = ((mdbcomp.feedback).feedback_info).
:- pred put_feedback_data(((mdbcomp.feedback).feedback_type), ((mdbcomp.feedback).feedback_data), ((mdbcomp.feedback).feedback_info), ((mdbcomp.feedback).feedback_info)).
:- mode put_feedback_data((builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred read_error_message_string(string, ((mdbcomp.feedback).feedback_read_error), string).
:- mode read_error_message_string((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred read_feedback_file(string, ((mdbcomp.feedback).feedback_read_result(((mdbcomp.feedback).feedback_info))), (io.io), (io.io)).
:- mode read_feedback_file((builtin.in), (builtin.out), (builtin.di), (builtin.uo)) is det.
:- pred read_or_create(string, ((mdbcomp.feedback).feedback_info), (io.io), (io.io)).
:- mode read_or_create((builtin.in), (builtin.out), (builtin.di), (builtin.uo)) is det.
:- pred write_feedback_file(string, string, ((mdbcomp.feedback).feedback_info), ((mdbcomp.feedback).feedback_write_result), (io.io), (io.io)).
:- mode write_feedback_file((builtin.in), (builtin.in), (builtin.in), (builtin.out), (builtin.di), (builtin.uo)) is det.
