:- module (backend_libs.builtin_ops).
:- interface.
:- use_module hlds.
:- use_module list.
:- use_module mdbcomp.
:- use_module parse_tree.
:- use_module (hlds.hlds_pred).
:- use_module (mdbcomp.sym_name).
:- use_module (parse_tree.prog_data).
:- type array_elem_type
    --->    array_elem_scalar(backend_libs.builtin_ops.scalar_array_elem_type)
    ;       array_elem_struct(list.list(backend_libs.builtin_ops.scalar_array_elem_type)).
:- type binary_op
    --->    int_add(parse_tree.prog_data.int_type)
    ;       int_sub(parse_tree.prog_data.int_type)
    ;       int_mul(parse_tree.prog_data.int_type)
    ;       int_div(parse_tree.prog_data.int_type)
    ;       int_mod(parse_tree.prog_data.int_type)
    ;       unchecked_left_shift(parse_tree.prog_data.int_type, backend_libs.builtin_ops.shift_by_type)
    ;       unchecked_right_shift(parse_tree.prog_data.int_type, backend_libs.builtin_ops.shift_by_type)
    ;       bitwise_and(parse_tree.prog_data.int_type)
    ;       bitwise_or(parse_tree.prog_data.int_type)
    ;       bitwise_xor(parse_tree.prog_data.int_type)
    ;       logical_and 
    ;       logical_or 
    ;       eq(parse_tree.prog_data.int_type)
    ;       ne(parse_tree.prog_data.int_type)
    ;       body 
    ;       array_index(backend_libs.builtin_ops.array_elem_type)
    ;       string_unsafe_index_code_unit 
    ;       str_eq 
    ;       str_ne 
    ;       str_lt 
    ;       str_gt 
    ;       str_le 
    ;       str_ge 
    ;       str_cmp 
    ;       offset_str_eq(int)
    ;       int_lt(parse_tree.prog_data.int_type)
    ;       int_gt(parse_tree.prog_data.int_type)
    ;       int_le(parse_tree.prog_data.int_type)
    ;       int_ge(parse_tree.prog_data.int_type)
    ;       unsigned_lt 
    ;       unsigned_le 
    ;       float_add 
    ;       float_sub 
    ;       float_mul 
    ;       float_div 
    ;       float_eq 
    ;       float_ne 
    ;       float_lt 
    ;       float_gt 
    ;       float_le 
    ;       float_ge 
    ;       float_from_dword 
    ;       int64_from_dword 
    ;       uint64_from_dword 
    ;       pointer_equal_conservative 
    ;       compound_eq 
    ;       compound_lt .
:- type scalar_array_elem_type
    --->    scalar_elem_string 
    ;       scalar_elem_int 
    ;       scalar_elem_generic .
:- type shift_by_type
    --->    shift_by_int 
    ;       shift_by_uint .
:- type simple_code(T)
    --->    assign(T, backend_libs.builtin_ops.simple_expr(T))
    ;       ref_assign(T, T)
    ;       test(backend_libs.builtin_ops.simple_expr(T))
    ;       noop(list.list(T)).
:- type simple_expr(T)
    --->    leaf(T)
    ;       int_const(int)
    ;       uint_const(uint)
    ;       int8_const(int8)
    ;       uint8_const(uint8)
    ;       int16_const(int16)
    ;       uint16_const(uint16)
    ;       int32_const(int32)
    ;       uint32_const(uint32)
    ;       int64_const(int64)
    ;       uint64_const(uint64)
    ;       float_const(float)
    ;       unary(backend_libs.builtin_ops.unary_op, backend_libs.builtin_ops.simple_expr(T))
    ;       binary(backend_libs.builtin_ops.binary_op, backend_libs.builtin_ops.simple_expr(T), backend_libs.builtin_ops.simple_expr(T)).
:- type unary_op
    --->    tag 
    ;       strip_tag 
    ;       mkbody 
    ;       unmkbody 
    ;       bitwise_complement(parse_tree.prog_data.int_type)
    ;       logical_not 
    ;       hash_string 
    ;       hash_string2 
    ;       hash_string3 
    ;       hash_string4 
    ;       hash_string5 
    ;       hash_string6 
    ;       dword_float_get_word0 
    ;       dword_float_get_word1 
    ;       dword_int64_get_word0 
    ;       dword_int64_get_word1 
    ;       dword_uint64_get_word0 
    ;       dword_uint64_get_word1 .
:- inst (int_binary_op) for (backend_libs.builtin_ops).binary_op/0 == bound(bitwise_and(ground) ; bitwise_or(ground) ; bitwise_xor(ground) ; int_add(ground) ; int_div(ground) ; int_ge(ground) ; int_gt(ground) ; int_le(ground) ; int_lt(ground) ; int_mod(ground) ; int_mul(ground) ; int_sub(ground) ; unchecked_left_shift(ground, ground) ; unchecked_right_shift(ground, ground)).
:- inst (simple_arg_expr) for (backend_libs.builtin_ops).simple_expr/1 == bound(float_const(ground) ; int16_const(ground) ; int32_const(ground) ; int64_const(ground) ; int8_const(ground) ; int_const(ground) ; leaf(ground) ; uint16_const(ground) ; uint32_const(ground) ; uint64_const(ground) ; uint8_const(ground) ; uint_const(ground)).
:- inst (simple_assign_expr) for (backend_libs.builtin_ops).simple_expr/1 == bound(binary(ground, ((backend_libs.builtin_ops).simple_arg_expr), ((backend_libs.builtin_ops).simple_arg_expr)) ; leaf(ground) ; unary(ground, ((backend_libs.builtin_ops).simple_arg_expr))).
:- inst (simple_code) for (backend_libs.builtin_ops).simple_code/1 == bound(assign(ground, ((backend_libs.builtin_ops).simple_assign_expr)) ; noop(ground) ; ref_assign(ground, ground) ; test(((backend_libs.builtin_ops).simple_test_expr))).
:- inst (simple_test_expr) for (backend_libs.builtin_ops).simple_expr/1 == bound(binary(ground, ((backend_libs.builtin_ops).simple_arg_expr), ((backend_libs.builtin_ops).simple_arg_expr)) ; unary(ground, ((backend_libs.builtin_ops).simple_arg_expr))).
