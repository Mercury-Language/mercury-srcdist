:- module (parse_tree.prog_io_util).
:- interface.
:- import_module assoc_list.
:- import_module list.
:- import_module map.
:- import_module maybe.
:- import_module pair.
:- import_module term.
:- import_module varset.
:- import_module (mdbcomp.prim_data).
:- import_module (mdbcomp.sym_name).
:- import_module (parse_tree.error_util).
:- import_module (parse_tree.prog_data).
:- type allow_constrained_inst_var
    --->    allow_constrained_inst_var 
    ;       no_allow_constrained_inst_var .
:- type decl_attribute
    --->    decl_attr_purity(parse_tree.prog_data.purity)
    ;       decl_attr_quantifier(parse_tree.prog_io_util.quantifier_type, list.list(term.var))
    ;       decl_attr_constraints(parse_tree.prog_io_util.quantifier_type, term.term)
    ;       decl_attr_solver_type .
:- type decl_attrs == assoc_list.assoc_list(parse_tree.prog_io_util.decl_attribute, term.context).
:- type maybe1(T1)
    --->    error1(list.list(parse_tree.error_util.error_spec))
    ;       ok1(T1).
:- type maybe2(T1, T2)
    --->    error2(list.list(parse_tree.error_util.error_spec))
    ;       ok2(T1, T2).
:- type maybe3(T1, T2, T3)
    --->    error3(list.list(parse_tree.error_util.error_spec))
    ;       ok3(T1, T2, T3).
:- type maybe4(T1, T2, T3, T4)
    --->    error4(list.list(parse_tree.error_util.error_spec))
    ;       ok4(T1, T2, T3, T4).
:- type maybe_functor == parse_tree.prog_io_util.maybe_functor(term.generic).
:- type maybe_functor(T) == parse_tree.prog_io_util.maybe2(mdbcomp.sym_name.sym_name, list.list(term.term(T))).
:- type maybe_pred_or_func(T) == parse_tree.prog_io_util.maybe2(mdbcomp.sym_name.sym_name, pair.pair(list.list(T), maybe.maybe(T))).
:- type parser(T) == pred(term.term, parse_tree.prog_io_util.maybe1(T)).
:- type quantifier_type
    --->    quant_type_exist 
    ;       quant_type_univ .
:- type var2pvar == map.map(term.var, parse_tree.prog_data.prog_var).
:- type var2tvar == map.map(term.var, parse_tree.prog_data.tvar).
:- mode (parser) == (pred((builtin.in), (builtin.out)) is det).
:- func attribute_description(parse_tree.prog_io_util.decl_attribute) = string.
:- pred check_no_attributes(parse_tree.prog_io_util.maybe1(T), parse_tree.prog_io_util.decl_attrs, parse_tree.prog_io_util.maybe1(T)).
:- mode check_no_attributes((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred conjunction_to_list(term.term(T), list.list(term.term(T))).
:- mode conjunction_to_list((builtin.in), (builtin.out)) is det.
:- pred conjunction_to_one_or_more(term.term(T), list.one_or_more(term.term(T))).
:- mode conjunction_to_one_or_more((builtin.in), (builtin.out)) is det.
:- pred convert_inst(parse_tree.prog_io_util.allow_constrained_inst_var, term.term, parse_tree.prog_data.mer_inst).
:- mode convert_inst((builtin.in), (builtin.in), (builtin.out)) is semidet.
:- pred convert_inst_list(parse_tree.prog_io_util.allow_constrained_inst_var, list.list(term.term), list.list(parse_tree.prog_data.mer_inst)).
:- mode convert_inst_list((builtin.in), (builtin.in), (builtin.out)) is semidet.
:- pred convert_mode(parse_tree.prog_io_util.allow_constrained_inst_var, term.term, parse_tree.prog_data.mer_mode).
:- mode convert_mode((builtin.in), (builtin.in), (builtin.out)) is semidet.
:- pred convert_mode_list(parse_tree.prog_io_util.allow_constrained_inst_var, list.list(term.term), list.list(parse_tree.prog_data.mer_mode)).
:- mode convert_mode_list((builtin.in), (builtin.in), (builtin.out)) is semidet.
:- pred disjunction_to_list(term.term(T), list.list(term.term(T))).
:- mode disjunction_to_list((builtin.in), (builtin.out)) is det.
:- pred disjunction_to_one_or_more(term.term(T), list.one_or_more(term.term(T))).
:- mode disjunction_to_one_or_more((builtin.in), (builtin.out)) is det.
:- func get_any_errors1(parse_tree.prog_io_util.maybe1(T1)) = list.list(parse_tree.error_util.error_spec).
:- func get_any_errors2(parse_tree.prog_io_util.maybe2(T1, T2)) = list.list(parse_tree.error_util.error_spec).
:- func get_any_errors3(parse_tree.prog_io_util.maybe3(T1, T2, T3)) = list.list(parse_tree.error_util.error_spec).
:- func get_any_errors4(parse_tree.prog_io_util.maybe4(T1, T2, T3, T4)) = list.list(parse_tree.error_util.error_spec).
:- pred is_known_inst_name(string).
:- mode is_known_inst_name((builtin.in)) is semidet.
:- pred is_known_mode_name(string).
:- mode is_known_mode_name((builtin.in)) is semidet.
:- pred list_term_to_term_list(term.term, list.list(term.term)).
:- mode list_term_to_term_list((builtin.in), (builtin.out)) is semidet.
:- pred map_parser(parse_tree.prog_io_util.parser(T), list.list(term.term), parse_tree.prog_io_util.maybe1(list.list(T))).
:- mode map_parser(((parse_tree.prog_io_util).parser), (builtin.in), (builtin.out)) is det.
:- pred maybe_parse_type(term.term, parse_tree.prog_data.mer_type).
:- mode maybe_parse_type((builtin.in), (builtin.out)) is semidet.
:- pred maybe_parse_types(list.list(term.term), list.list(parse_tree.prog_data.mer_type)).
:- mode maybe_parse_types((builtin.in), (builtin.out)) is semidet.
:- pred one_or_more_to_conjunction(parse_tree.prog_data.prog_context, list.one_or_more(term.term(T)), term.term(T)).
:- mode one_or_more_to_conjunction((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred parse_decl_attribute(string, list.list(term.term), parse_tree.prog_io_util.decl_attribute, term.term).
:- mode parse_decl_attribute((builtin.in), (builtin.in), (builtin.out), (builtin.out)) is semidet.
:- pred parse_list(parse_tree.prog_io_util.parser(T), term.term, parse_tree.prog_io_util.maybe1(list.list(T))).
:- mode parse_list(((parse_tree.prog_io_util).parser), (builtin.in), (builtin.out)) is det.
:- pred parse_list_of_vars(term.term(T), list.list(term.var(T))).
:- mode parse_list_of_vars((builtin.in), (builtin.out)) is semidet.
:- pred parse_name_and_arity(mdbcomp.sym_name.module_name, term.term(T), mdbcomp.sym_name.sym_name, parse_tree.prog_data.arity).
:- mode parse_name_and_arity((builtin.in), (builtin.in), (builtin.out), (builtin.out)) is semidet.
:- pred parse_name_and_arity_unqualified(term.term(T), mdbcomp.sym_name.sym_name, parse_tree.prog_data.arity).
:- mode parse_name_and_arity_unqualified((builtin.in), (builtin.out), (builtin.out)) is semidet.
:- pred parse_one_or_more(parse_tree.prog_io_util.parser(T), term.term, parse_tree.prog_io_util.maybe1(list.one_or_more(T))).
:- mode parse_one_or_more(((parse_tree.prog_io_util).parser), (builtin.in), (builtin.out)) is det.
:- pred parse_pred_or_func_and_args(term.term(_T), mdbcomp.prim_data.pred_or_func, mdbcomp.sym_name.sym_name, list.list(term.term(_T))).
:- mode parse_pred_or_func_and_args((builtin.in), (builtin.out), (builtin.out), (builtin.out)) is semidet.
:- pred parse_pred_or_func_and_args_general(maybe.maybe(mdbcomp.sym_name.module_name), term.term(_T), varset.varset(_T), list.list(parse_tree.error_util.format_component), parse_tree.prog_io_util.maybe_pred_or_func(term.term(_T))).
:- mode parse_pred_or_func_and_args_general((builtin.in), (builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred parse_pred_or_func_name_and_arity(term.term(T), mdbcomp.prim_data.pred_or_func, mdbcomp.sym_name.sym_name, parse_tree.prog_data.arity).
:- mode parse_pred_or_func_name_and_arity((builtin.in), (builtin.out), (builtin.out), (builtin.out)) is semidet.
:- pred parse_purity_annotation(term.term(T), parse_tree.prog_data.purity, term.term(T)).
:- mode parse_purity_annotation((builtin.in), (builtin.out), (builtin.out)) is det.
:- pred parse_quantifier_vars(term.term(T), varset.varset(T), list.list(parse_tree.error_util.format_component), parse_tree.prog_io_util.maybe2(list.list(term.var(T)), list.list(term.var(T)))).
:- mode parse_quantifier_vars((builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred parse_type(term.term, varset.varset, list.list(parse_tree.error_util.format_component), parse_tree.prog_io_util.maybe1(parse_tree.prog_data.mer_type)).
:- mode parse_type((builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred parse_types(list.list(term.term), varset.varset, list.list(parse_tree.error_util.format_component), parse_tree.prog_io_util.maybe1(list.list(parse_tree.prog_data.mer_type))).
:- mode parse_types((builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred parse_vars(term.term(T), varset.varset(T), list.list(parse_tree.error_util.format_component), parse_tree.prog_io_util.maybe1(list.list(term.var(T)))).
:- mode parse_vars((builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred parse_vars_and_state_vars(term.term(T), varset.varset(T), list.list(parse_tree.error_util.format_component), parse_tree.prog_io_util.maybe4(list.list(term.var(T)), list.list(term.var(T)), list.list(term.var(T)), list.list(term.var(T)))).
:- mode parse_vars_and_state_vars((builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred standard_det(string, parse_tree.prog_data.determinism).
:- mode standard_det((builtin.in), (builtin.out)) is semidet.
:- pred sum_to_list(term.term(T), list.list(term.term(T))).
:- mode sum_to_list((builtin.in), (builtin.out)) is det.
:- pred sum_to_one_or_more(term.term(T), list.one_or_more(term.term(T))).
:- mode sum_to_one_or_more((builtin.in), (builtin.out)) is det.
:- pred unparse_type(parse_tree.prog_data.mer_type, term.term).
:- mode unparse_type((builtin.in), (builtin.out)) is det.
