:- module (parse_tree.module_imports).
:- interface.
:- import_module cord.
:- import_module list.
:- import_module map.
:- import_module maybe.
:- import_module (libs.file_util).
:- import_module (libs.globals).
:- import_module (libs.timestamp).
:- import_module (mdbcomp.sym_name).
:- import_module (parse_tree.error_util).
:- import_module (parse_tree.prog_data).
:- import_module (parse_tree.prog_io_error).
:- import_module (parse_tree.prog_item).
:- import_module (parse_tree.status).
:- type module_and_imports
    --->    module_and_imports(((parse_tree.module_imports).mai_source_file_name) :: libs.file_util.file_name, ((parse_tree.module_imports).mai_source_file_module_name) :: mdbcomp.sym_name.module_name, ((parse_tree.module_imports).mai_module_name) :: mdbcomp.sym_name.module_name, ((parse_tree.module_imports).mai_module_name_context) :: parse_tree.prog_data.prog_context, ((parse_tree.module_imports).mai_parent_deps) :: list.list(mdbcomp.sym_name.module_name), ((parse_tree.module_imports).mai_int_deps) :: list.list(mdbcomp.sym_name.module_name), ((parse_tree.module_imports).mai_impl_deps) :: list.list(mdbcomp.sym_name.module_name), ((parse_tree.module_imports).mai_indirect_deps) :: list.list(mdbcomp.sym_name.module_name), ((parse_tree.module_imports).mai_children) :: list.list(mdbcomp.sym_name.module_name), ((parse_tree.module_imports).mai_public_children) :: list.list(mdbcomp.sym_name.module_name), ((parse_tree.module_imports).mai_nested_children) :: list.list(mdbcomp.sym_name.module_name), ((parse_tree.module_imports).mai_fact_table_deps) :: list.list(string), ((parse_tree.module_imports).mai_foreign_import_modules) :: parse_tree.prog_data.foreign_import_module_infos, ((parse_tree.module_imports).mai_foreign_include_files) :: parse_tree.prog_data.foreign_include_file_infos, ((parse_tree.module_imports).mai_has_foreign_code) :: parse_tree.prog_item.contains_foreign_code, ((parse_tree.module_imports).mai_contains_foreign_export) :: parse_tree.prog_item.contains_foreign_export, ((parse_tree.module_imports).mai_blocks_cord) :: cord.cord(parse_tree.prog_item.aug_item_block), ((parse_tree.module_imports).mai_specs) :: list.list(parse_tree.error_util.error_spec), ((parse_tree.module_imports).mai_errors) :: parse_tree.prog_io_error.read_module_errors, ((parse_tree.module_imports).mai_maybe_timestamp_map) :: maybe.maybe(parse_tree.module_imports.module_timestamp_map), ((parse_tree.module_imports).mai_has_main) :: parse_tree.prog_data.has_main, ((parse_tree.module_imports).mai_module_dir) :: libs.file_util.dir_name).
:- type module_timestamp
    --->    module_timestamp(((parse_tree.module_imports).mts_file_kind) :: parse_tree.prog_item.file_kind, ((parse_tree.module_imports).mts_timestamp) :: libs.timestamp.timestamp, ((parse_tree.module_imports).mts_need_qualifier) :: parse_tree.status.need_qualifier).
:- type module_timestamp_map == map.map(mdbcomp.sym_name.module_name, parse_tree.module_imports.module_timestamp).
:- pred get_dependencies_in_item_blocks(list.list(parse_tree.prog_item.item_block(MS)), list.list(mdbcomp.sym_name.module_name), list.list(mdbcomp.sym_name.module_name)).
:- mode get_dependencies_in_item_blocks((builtin.in), (builtin.out), (builtin.out)) is det.
:- pred get_dependencies_in_items(list.list(parse_tree.prog_item.item), list.list(mdbcomp.sym_name.module_name), list.list(mdbcomp.sym_name.module_name)).
:- mode get_dependencies_in_items((builtin.in), (builtin.out), (builtin.out)) is det.
:- pred get_dependencies_int_imp_in_raw_item_blocks(list.list(parse_tree.prog_item.raw_item_block), list.list(mdbcomp.sym_name.module_name), list.list(mdbcomp.sym_name.module_name), list.list(mdbcomp.sym_name.module_name), list.list(mdbcomp.sym_name.module_name)).
:- mode get_dependencies_int_imp_in_raw_item_blocks((builtin.in), (builtin.out), (builtin.out), (builtin.out), (builtin.out)) is det.
:- pred get_fact_table_dependencies_in_item_blocks(list.list(parse_tree.prog_item.item_block(MS)), list.list(string)).
:- mode get_fact_table_dependencies_in_item_blocks((builtin.in), (builtin.out)) is det.
:- pred get_foreign_include_files_in_item_blocks(list.list(parse_tree.prog_item.item_block(MS)), parse_tree.prog_data.foreign_include_file_infos).
:- mode get_foreign_include_files_in_item_blocks((builtin.in), (builtin.out)) is det.
:- pred get_implicit_dependencies_in_item_blocks(libs.globals.globals, list.list(parse_tree.prog_item.item_block(MS)), list.list(mdbcomp.sym_name.module_name), list.list(mdbcomp.sym_name.module_name)).
:- mode get_implicit_dependencies_in_item_blocks((builtin.in), (builtin.in), (builtin.out), (builtin.out)) is det.
:- pred get_implicit_dependencies_in_items(libs.globals.globals, list.list(parse_tree.prog_item.item), list.list(mdbcomp.sym_name.module_name), list.list(mdbcomp.sym_name.module_name)).
:- mode get_implicit_dependencies_in_items((builtin.in), (builtin.in), (builtin.out), (builtin.out)) is det.
:- pred init_module_and_imports(libs.globals.globals, libs.file_util.file_name, mdbcomp.sym_name.module_name, list.list(mdbcomp.sym_name.module_name), list.list(parse_tree.error_util.error_spec), parse_tree.prog_io_error.read_module_errors, parse_tree.prog_item.raw_compilation_unit, parse_tree.module_imports.module_and_imports).
:- mode init_module_and_imports((builtin.in), (builtin.in), (builtin.in), (builtin.in), (builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred module_and_imports_add_interface_error(parse_tree.prog_io_error.read_module_errors, parse_tree.module_imports.module_and_imports, parse_tree.module_imports.module_and_imports).
:- mode module_and_imports_add_interface_error((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred module_and_imports_add_item_blocks(list.list(parse_tree.prog_item.aug_item_block), parse_tree.module_imports.module_and_imports, parse_tree.module_imports.module_and_imports).
:- mode module_and_imports_add_item_blocks((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred module_and_imports_add_item_blocks_specs_errors(list.list(parse_tree.prog_item.aug_item_block), list.list(parse_tree.error_util.error_spec), parse_tree.prog_io_error.read_module_errors, parse_tree.module_imports.module_and_imports, parse_tree.module_imports.module_and_imports).
:- mode module_and_imports_add_item_blocks_specs_errors((builtin.in), (builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred module_and_imports_add_specs(list.list(parse_tree.error_util.error_spec), parse_tree.module_imports.module_and_imports, parse_tree.module_imports.module_and_imports).
:- mode module_and_imports_add_specs((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred module_and_imports_get_impl_deps(parse_tree.module_imports.module_and_imports, list.list(mdbcomp.sym_name.module_name)).
:- mode module_and_imports_get_impl_deps((builtin.in), (builtin.out)) is det.
:- pred module_and_imports_get_module_name(parse_tree.module_imports.module_and_imports, mdbcomp.sym_name.module_name).
:- mode module_and_imports_get_module_name((builtin.in), (builtin.out)) is det.
:- pred module_and_imports_get_module_name_context(parse_tree.module_imports.module_and_imports, parse_tree.prog_data.prog_context).
:- mode module_and_imports_get_module_name_context((builtin.in), (builtin.out)) is det.
:- pred module_and_imports_get_results(parse_tree.module_imports.module_and_imports, list.list(parse_tree.prog_item.aug_item_block), list.list(parse_tree.error_util.error_spec), parse_tree.prog_io_error.read_module_errors).
:- mode module_and_imports_get_results((builtin.in), (builtin.out), (builtin.out), (builtin.out)) is det.
:- pred module_and_imports_get_source_file_name(parse_tree.module_imports.module_and_imports, libs.file_util.file_name).
:- mode module_and_imports_get_source_file_name((builtin.in), (builtin.out)) is det.
:- pred module_and_imports_set_errors(parse_tree.prog_io_error.read_module_errors, parse_tree.module_imports.module_and_imports, parse_tree.module_imports.module_and_imports).
:- mode module_and_imports_set_errors((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred module_and_imports_set_impl_deps(list.list(mdbcomp.sym_name.module_name), parse_tree.module_imports.module_and_imports, parse_tree.module_imports.module_and_imports).
:- mode module_and_imports_set_impl_deps((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred module_and_imports_set_indirect_deps(list.list(mdbcomp.sym_name.module_name), parse_tree.module_imports.module_and_imports, parse_tree.module_imports.module_and_imports).
:- mode module_and_imports_set_indirect_deps((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred module_and_imports_set_int_deps(list.list(mdbcomp.sym_name.module_name), parse_tree.module_imports.module_and_imports, parse_tree.module_imports.module_and_imports).
:- mode module_and_imports_set_int_deps((builtin.in), (builtin.in), (builtin.out)) is det.
