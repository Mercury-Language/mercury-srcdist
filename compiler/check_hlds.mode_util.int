:- module (check_hlds.mode_util).
:- interface.
:- use_module hlds.
:- use_module list.
:- use_module parse_tree.
:- use_module (hlds.hlds_goal).
:- use_module (hlds.hlds_module).
:- use_module (hlds.hlds_pred).
:- use_module (hlds.instmap).
:- use_module (hlds.vartypes).
:- use_module (parse_tree.prog_data).
:- type recompute_atomic_instmap_deltas
    --->    recompute_atomic_instmap_deltas 
    ;       do_not_recompute_atomic_instmap_deltas .
:- pred constructors_to_bound_any_insts(hlds.hlds_module.module_info, parse_tree.prog_data.uniqueness, parse_tree.prog_data.type_ctor, list.list(parse_tree.prog_data.constructor), list.list(parse_tree.prog_data.bound_inst)).
:- mode constructors_to_bound_any_insts((builtin.in), (builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred constructors_to_bound_insts(hlds.hlds_module.module_info, parse_tree.prog_data.uniqueness, parse_tree.prog_data.type_ctor, list.list(parse_tree.prog_data.constructor), list.list(parse_tree.prog_data.bound_inst)).
:- mode constructors_to_bound_insts((builtin.in), (builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- func from_to_insts_to_final_inst(parse_tree.prog_data.from_to_insts) = parse_tree.prog_data.mer_inst.
:- func from_to_insts_to_init_inst(parse_tree.prog_data.from_to_insts) = parse_tree.prog_data.mer_inst.
:- func from_to_insts_to_mode(parse_tree.prog_data.from_to_insts) = parse_tree.prog_data.mer_mode.
:- pred from_to_insts_to_unify_mode(parse_tree.prog_data.from_to_insts, parse_tree.prog_data.from_to_insts, hlds.hlds_goal.unify_mode).
:- mode from_to_insts_to_unify_mode((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred from_to_insts_to_unify_modes(list.list(parse_tree.prog_data.from_to_insts), list.list(parse_tree.prog_data.from_to_insts), list.list(hlds.hlds_goal.unify_mode)).
:- mode from_to_insts_to_unify_modes((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred get_arg_lives(hlds.hlds_module.module_info, list.list(parse_tree.prog_data.mer_mode), list.list(parse_tree.prog_data.is_live)).
:- mode get_arg_lives((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred init_final_insts_is_fully_output(hlds.hlds_module.module_info, parse_tree.prog_data.mer_inst, parse_tree.prog_data.mer_inst).
:- mode init_final_insts_is_fully_output((builtin.in), (builtin.in), (builtin.in)) is semidet.
:- pred init_final_insts_is_output(hlds.hlds_module.module_info, parse_tree.prog_data.mer_inst, parse_tree.prog_data.mer_inst).
:- mode init_final_insts_is_output((builtin.in), (builtin.in), (builtin.in)) is semidet.
:- pred init_final_insts_is_unused(hlds.hlds_module.module_info, parse_tree.prog_data.mer_inst, parse_tree.prog_data.mer_inst).
:- mode init_final_insts_is_unused((builtin.in), (builtin.in), (builtin.in)) is semidet.
:- pred init_final_insts_to_top_functor_mode(hlds.hlds_module.module_info, parse_tree.prog_data.mer_inst, parse_tree.prog_data.mer_inst, parse_tree.prog_data.mer_type, hlds.hlds_pred.top_functor_mode).
:- mode init_final_insts_to_top_functor_mode((builtin.in), (builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred init_inst_is_fully_input(hlds.hlds_module.module_info, parse_tree.prog_data.mer_inst).
:- mode init_inst_is_fully_input((builtin.in), (builtin.in)) is semidet.
:- pred init_inst_is_input(hlds.hlds_module.module_info, parse_tree.prog_data.mer_inst).
:- mode init_inst_is_input((builtin.in), (builtin.in)) is semidet.
:- pred inst_lookup(hlds.hlds_module.module_info, parse_tree.prog_data.inst_name, parse_tree.prog_data.mer_inst).
:- mode inst_lookup((builtin.in), (builtin.in), (builtin.out)) is det.
:- func mode_get_final_inst(hlds.hlds_module.module_info, parse_tree.prog_data.mer_mode) = parse_tree.prog_data.mer_inst.
:- pred mode_get_from_to_insts(hlds.hlds_module.module_info, parse_tree.prog_data.mer_mode, parse_tree.prog_data.from_to_insts).
:- mode mode_get_from_to_insts((builtin.in), (builtin.in), (builtin.out)) is det.
:- func mode_get_initial_inst(hlds.hlds_module.module_info, parse_tree.prog_data.mer_mode) = parse_tree.prog_data.mer_inst.
:- pred mode_get_insts(hlds.hlds_module.module_info, parse_tree.prog_data.mer_mode, parse_tree.prog_data.mer_inst, parse_tree.prog_data.mer_inst).
:- mode mode_get_insts((builtin.in), (builtin.in), (builtin.out), (builtin.out)) is det.
:- pred mode_get_insts_semidet(hlds.hlds_module.module_info, parse_tree.prog_data.mer_mode, parse_tree.prog_data.mer_inst, parse_tree.prog_data.mer_inst).
:- mode mode_get_insts_semidet((builtin.in), (builtin.in), (builtin.out), (builtin.out)) is semidet.
:- pred mode_is_fully_input(hlds.hlds_module.module_info, parse_tree.prog_data.mer_mode).
:- mode mode_is_fully_input((builtin.in), (builtin.in)) is semidet.
:- pred mode_is_fully_output(hlds.hlds_module.module_info, parse_tree.prog_data.mer_mode).
:- mode mode_is_fully_output((builtin.in), (builtin.in)) is semidet.
:- pred mode_is_input(hlds.hlds_module.module_info, parse_tree.prog_data.mer_mode).
:- mode mode_is_input((builtin.in), (builtin.in)) is semidet.
:- pred mode_is_output(hlds.hlds_module.module_info, parse_tree.prog_data.mer_mode).
:- mode mode_is_output((builtin.in), (builtin.in)) is semidet.
:- pred mode_is_unused(hlds.hlds_module.module_info, parse_tree.prog_data.mer_mode).
:- mode mode_is_unused((builtin.in), (builtin.in)) is semidet.
:- pred mode_list_get_final_insts(hlds.hlds_module.module_info, list.list(parse_tree.prog_data.mer_mode), list.list(parse_tree.prog_data.mer_inst)).
:- mode mode_list_get_final_insts((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred mode_list_get_initial_insts(hlds.hlds_module.module_info, list.list(parse_tree.prog_data.mer_mode), list.list(parse_tree.prog_data.mer_inst)).
:- mode mode_list_get_initial_insts((builtin.in), (builtin.in), (builtin.out)) is det.
:- func mode_to_from_to_insts(hlds.hlds_module.module_info, parse_tree.prog_data.mer_mode) = parse_tree.prog_data.from_to_insts.
:- pred mode_to_top_functor_mode(hlds.hlds_module.module_info, parse_tree.prog_data.mer_mode, parse_tree.prog_data.mer_type, hlds.hlds_pred.top_functor_mode).
:- mode mode_to_top_functor_mode((builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred modes_to_top_functor_modes(hlds.hlds_module.module_info, list.list(parse_tree.prog_data.mer_mode), list.list(parse_tree.prog_data.mer_type), list.list(hlds.hlds_pred.top_functor_mode)).
:- mode modes_to_top_functor_modes((builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred modes_to_unify_mode(hlds.hlds_module.module_info, parse_tree.prog_data.mer_mode, parse_tree.prog_data.mer_mode, hlds.hlds_goal.unify_mode).
:- mode modes_to_unify_mode((builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred modes_to_unify_modes(hlds.hlds_module.module_info, list.list(parse_tree.prog_data.mer_mode), list.list(parse_tree.prog_data.mer_mode), list.list(hlds.hlds_goal.unify_mode)).
:- mode modes_to_unify_modes((builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred propagate_ctor_info_into_bound_inst(hlds.hlds_module.module_info, parse_tree.prog_data.mer_type, parse_tree.prog_data.mer_inst, parse_tree.prog_data.mer_inst).
:- mode propagate_ctor_info_into_bound_inst((builtin.in), (builtin.in), builtin.in(((parse_tree.prog_data).mer_inst_is_bound)), (builtin.out)) is det.
:- pred propagate_types_into_inst_list(hlds.hlds_module.module_info, parse_tree.prog_data.tsubst, list.list(parse_tree.prog_data.mer_type), list.list(parse_tree.prog_data.mer_inst), list.list(parse_tree.prog_data.mer_inst)).
:- mode propagate_types_into_inst_list((builtin.in), (builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred propagate_types_into_mode_list(hlds.hlds_module.module_info, list.list(parse_tree.prog_data.mer_type), list.list(parse_tree.prog_data.mer_mode), list.list(parse_tree.prog_data.mer_mode)).
:- mode propagate_types_into_mode_list((builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred recompute_instmap_delta(check_hlds.mode_util.recompute_atomic_instmap_deltas, hlds.hlds_goal.hlds_goal, hlds.hlds_goal.hlds_goal, hlds.vartypes.vartypes, parse_tree.prog_data.inst_varset, hlds.instmap.instmap, hlds.hlds_module.module_info, hlds.hlds_module.module_info).
:- mode recompute_instmap_delta((builtin.in), (builtin.in), (builtin.out), (builtin.in), (builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- pred recompute_instmap_delta_proc(check_hlds.mode_util.recompute_atomic_instmap_deltas, hlds.hlds_pred.proc_info, hlds.hlds_pred.proc_info, hlds.hlds_module.module_info, hlds.hlds_module.module_info).
:- mode recompute_instmap_delta_proc((builtin.in), (builtin.in), (builtin.out), (builtin.in), (builtin.out)) is det.
:- func unify_mode_to_lhs_from_to_insts(hlds.hlds_goal.unify_mode) = parse_tree.prog_data.from_to_insts.
:- func unify_mode_to_lhs_mode(hlds.hlds_goal.unify_mode) = parse_tree.prog_data.mer_mode.
:- pred unify_mode_to_lhs_rhs_from_to_insts(hlds.hlds_goal.unify_mode, parse_tree.prog_data.from_to_insts, parse_tree.prog_data.from_to_insts).
:- mode unify_mode_to_lhs_rhs_from_to_insts((builtin.in), (builtin.out), (builtin.out)) is det.
:- func unify_mode_to_rhs_from_to_insts(hlds.hlds_goal.unify_mode) = parse_tree.prog_data.from_to_insts.
:- func unify_mode_to_rhs_mode(hlds.hlds_goal.unify_mode) = parse_tree.prog_data.mer_mode.
