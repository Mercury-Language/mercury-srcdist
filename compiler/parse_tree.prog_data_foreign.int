:- module (parse_tree.prog_data_foreign).
:- interface.
:- use_module bool.
:- use_module cord.
:- use_module libs.
:- use_module list.
:- use_module maybe.
:- use_module mdbcomp.
:- use_module set.
:- use_module (libs.globals).
:- use_module (mdbcomp.sym_name).
:- use_module (parse_tree.prog_data).
:- use_module (parse_tree.prog_data_pragma).
:- type box_policy
    --->    bp_native_if_possible 
    ;       bp_always_boxed .
:- type export_enum_attributes
    --->    export_enum_attributes(((parse_tree.prog_data_foreign).ee_attr_prefix) :: maybe.maybe(string), ((parse_tree.prog_data_foreign).ee_attr_upper) :: parse_tree.prog_data_foreign.uppercase_export_enum).
:- type fim_spec
    --->    fim_spec(((parse_tree.prog_data_foreign).fimspec_lang) :: libs.globals.foreign_language, ((parse_tree.prog_data_foreign).fimspec_module_name) :: mdbcomp.sym_name.module_name).
:- type foreign_arg_name_mode
    --->    foreign_arg_name_mode(string, parse_tree.prog_data.mer_mode).
:- type foreign_arg_name_mode_box
    --->    foreign_arg_name_mode_box(maybe.maybe(parse_tree.prog_data_foreign.foreign_arg_name_mode), parse_tree.prog_data_foreign.box_policy).
:- type foreign_decl_is_local
    --->    foreign_decl_is_local 
    ;       foreign_decl_is_exported .
:- type foreign_import_modules
    --->    foreign_import_modules(((parse_tree.prog_data_foreign).fim_c) :: set.set(mdbcomp.sym_name.module_name), ((parse_tree.prog_data_foreign).fim_csharp) :: set.set(mdbcomp.sym_name.module_name), ((parse_tree.prog_data_foreign).fim_java) :: set.set(mdbcomp.sym_name.module_name), ((parse_tree.prog_data_foreign).fim_erlang) :: set.set(mdbcomp.sym_name.module_name)).
:- type foreign_include_file_info
    --->    foreign_include_file_info(((parse_tree.prog_data_foreign).fifi_lang) :: libs.globals.foreign_language, ((parse_tree.prog_data_foreign).fifi_filename) :: string).
:- type foreign_include_file_infos == cord.cord(parse_tree.prog_data_foreign.foreign_include_file_info).
:- type foreign_literal_or_include
    --->    floi_literal(string)
    ;       floi_include_file(string).
:- type foreign_proc_shared_code_treatment
    --->    shared_code_duplicate 
    ;       shared_code_share 
    ;       shared_code_automatic .
:- type pragma_foreign_proc_attributes.
:- type pragma_foreign_proc_extra_attribute
    --->    refers_to_llds_stack 
    ;       backend(libs.globals.backend)
    ;       needs_call_standard_output_registers .
:- type pragma_foreign_proc_extra_attributes == list.list(parse_tree.prog_data_foreign.pragma_foreign_proc_extra_attribute).
:- type pragma_foreign_proc_impl
    --->    fp_impl_ordinary(string, maybe.maybe(parse_tree.prog_data.prog_context)).
:- type pragma_var
    --->    pragma_var(parse_tree.prog_data.prog_var, string, parse_tree.prog_data.mer_mode, parse_tree.prog_data_foreign.box_policy).
:- type proc_affects_liveness
    --->    proc_affects_liveness 
    ;       proc_does_not_affect_liveness 
    ;       proc_default_affects_liveness .
:- type proc_allocates_memory
    --->    proc_does_not_allocate_memory 
    ;       proc_allocates_bounded_memory 
    ;       proc_allocates_unbounded_memory 
    ;       proc_default_allocates_memory .
:- type proc_may_call_mercury
    --->    proc_may_call_mercury 
    ;       proc_will_not_call_mercury .
:- type proc_may_call_mm_tabled
    --->    proc_may_call_mm_tabled 
    ;       proc_will_not_call_mm_tabled 
    ;       proc_default_calls_mm_tabled .
:- type proc_may_duplicate
    --->    proc_may_duplicate 
    ;       proc_may_not_duplicate .
:- type proc_may_modify_trail
    --->    proc_may_modify_trail 
    ;       proc_will_not_modify_trail .
:- type proc_may_throw_exception
    --->    proc_will_not_throw_exception 
    ;       default_exception_behaviour .
:- type proc_registers_roots
    --->    proc_registers_roots 
    ;       proc_does_not_register_roots 
    ;       proc_does_not_have_roots 
    ;       proc_default_registers_roots .
:- type proc_tabled_for_io
    --->    proc_not_tabled_for_io 
    ;       proc_tabled_for_io 
    ;       proc_tabled_for_io_unitize 
    ;       proc_tabled_for_descendant_io .
:- type proc_terminates
    --->    proc_terminates 
    ;       proc_does_not_terminate 
    ;       depends_on_mercury_calls .
:- type proc_thread_safe
    --->    proc_not_thread_safe 
    ;       proc_thread_safe 
    ;       proc_maybe_thread_safe .
:- type uppercase_export_enum
    --->    uppercase_export_enum 
    ;       do_not_uppercase_export_enum .
:- pred add_extra_attribute(parse_tree.prog_data_foreign.pragma_foreign_proc_extra_attribute, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode add_extra_attribute((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred add_fim_spec(parse_tree.prog_data_foreign.fim_spec, parse_tree.prog_data_foreign.foreign_import_modules, parse_tree.prog_data_foreign.foreign_import_modules).
:- mode add_fim_spec((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred add_foreign_import_module(libs.globals.foreign_language, mdbcomp.sym_name.module_name, parse_tree.prog_data_foreign.foreign_import_modules, parse_tree.prog_data_foreign.foreign_import_modules).
:- mode add_foreign_import_module((builtin.in), (builtin.in), (builtin.in), (builtin.out)) is det.
:- func default_attributes(libs.globals.foreign_language) = parse_tree.prog_data_foreign.pragma_foreign_proc_attributes.
:- func default_export_enum_attributes = parse_tree.prog_data_foreign.export_enum_attributes.
:- func foreign_arg_name_mode_box_project_maybe_name_mode(parse_tree.prog_data_foreign.foreign_arg_name_mode_box) = maybe.maybe(parse_tree.prog_data_foreign.foreign_arg_name_mode).
:- func get_affects_liveness(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data_foreign.proc_affects_liveness.
:- func get_all_fim_specs(parse_tree.prog_data_foreign.foreign_import_modules) = set.set(parse_tree.prog_data_foreign.fim_spec).
:- func get_all_foreign_import_modules(parse_tree.prog_data_foreign.foreign_import_modules) = set.set(mdbcomp.sym_name.module_name).
:- func get_allocates_memory(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data_foreign.proc_allocates_memory.
:- func get_box_policy(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data_foreign.box_policy.
:- func get_extra_attributes(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data_foreign.pragma_foreign_proc_extra_attributes.
:- func get_foreign_language(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = libs.globals.foreign_language.
:- func get_lang_fim_modules(parse_tree.prog_data_foreign.foreign_import_modules, libs.globals.foreign_language) = set.set(mdbcomp.sym_name.module_name).
:- func get_lang_fim_specs(parse_tree.prog_data_foreign.foreign_import_modules, libs.globals.foreign_language) = set.set(parse_tree.prog_data_foreign.fim_spec).
:- func get_may_call_mercury(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data_foreign.proc_may_call_mercury.
:- func get_may_call_mm_tabled(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data_foreign.proc_may_call_mm_tabled.
:- func get_may_duplicate(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = maybe.maybe(parse_tree.prog_data_foreign.proc_may_duplicate).
:- func get_may_modify_trail(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data_foreign.proc_may_modify_trail.
:- func get_may_throw_exception(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data_foreign.proc_may_throw_exception.
:- func get_ordinary_despite_detism(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = bool.bool.
:- func get_purity(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data.purity.
:- func get_registers_roots(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data_foreign.proc_registers_roots.
:- func get_tabled_for_io(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data_foreign.proc_tabled_for_io.
:- func get_terminates(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data_foreign.proc_terminates.
:- func get_thread_safe(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data_foreign.proc_thread_safe.
:- func get_user_annotated_sharing(parse_tree.prog_data_foreign.pragma_foreign_proc_attributes) = parse_tree.prog_data_pragma.user_annotated_sharing.
:- func init_foreign_import_modules = parse_tree.prog_data_foreign.foreign_import_modules.
:- pred pragma_get_modes(list.list(parse_tree.prog_data_foreign.pragma_var), list.list(parse_tree.prog_data.mer_mode)).
:- mode pragma_get_modes((builtin.in), (builtin.out)) is det.
:- pred pragma_get_var_infos(list.list(parse_tree.prog_data_foreign.pragma_var), list.list(parse_tree.prog_data_foreign.foreign_arg_name_mode_box)).
:- mode pragma_get_var_infos((builtin.in), (builtin.out)) is det.
:- pred pragma_get_vars(list.list(parse_tree.prog_data_foreign.pragma_var), list.list(parse_tree.prog_data.prog_var)).
:- mode pragma_get_vars((builtin.in), (builtin.out)) is det.
:- pred set_affects_liveness(parse_tree.prog_data_foreign.proc_affects_liveness, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_affects_liveness((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_allocates_memory(parse_tree.prog_data_foreign.proc_allocates_memory, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_allocates_memory((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_box_policy(parse_tree.prog_data_foreign.box_policy, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_box_policy((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_foreign_language(libs.globals.foreign_language, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_foreign_language((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_may_call_mercury(parse_tree.prog_data_foreign.proc_may_call_mercury, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_may_call_mercury((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_may_call_mm_tabled(parse_tree.prog_data_foreign.proc_may_call_mm_tabled, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_may_call_mm_tabled((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_may_duplicate(maybe.maybe(parse_tree.prog_data_foreign.proc_may_duplicate), parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_may_duplicate((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_may_modify_trail(parse_tree.prog_data_foreign.proc_may_modify_trail, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_may_modify_trail((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_may_throw_exception(parse_tree.prog_data_foreign.proc_may_throw_exception, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_may_throw_exception((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_ordinary_despite_detism(bool.bool, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_ordinary_despite_detism((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_purity(parse_tree.prog_data.purity, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_purity((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_registers_roots(parse_tree.prog_data_foreign.proc_registers_roots, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_registers_roots((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_tabled_for_io(parse_tree.prog_data_foreign.proc_tabled_for_io, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_tabled_for_io((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_terminates(parse_tree.prog_data_foreign.proc_terminates, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_terminates((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_thread_safe(parse_tree.prog_data_foreign.proc_thread_safe, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_thread_safe((builtin.in), (builtin.in), (builtin.out)) is det.
:- pred set_user_annotated_sharing(parse_tree.prog_data_pragma.user_annotated_sharing, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes, parse_tree.prog_data_foreign.pragma_foreign_proc_attributes).
:- mode set_user_annotated_sharing((builtin.in), (builtin.in), (builtin.out)) is det.
