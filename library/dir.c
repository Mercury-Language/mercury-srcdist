/*
** Automatically generated from `dir.m'
** by the Mercury compiler,
** version rotd-2016-05-13
** configured for x86_64-apple-darwin13.4.0.
** Do not edit.
**
** The autoconfigured grade settings governing
** the generation of this C file were
**
** TAG_BITS=2
** UNBOXED_FLOAT=no
** PREGENERATED_DIST=yes
** HIGHLEVEL_CODE=yes
**
** END_OF_C_GRADE_INFO
*/


/* :- module dir. */
/* :- implementation. */

/*
INIT mercury__dir__init
ENDINIT
*/

#include "dir.mih"
#include "dir.mh"


#include "array.mih"
#include "assoc_list.mih"
#include "benchmarking.mih"
#include "bitmap.mih"
#include "bool.mih"
#include "builtin.mih"
#include "calendar.mih"
#include "char.mih"
#include "construct.mih"
#include "cord.mih"
#include "deconstruct.mih"
#include "enum.mih"
#include "erlang_rtti_implementation.mih"
#include "exception.mih"
#include "float.mih"
#include "int.mih"
#include "integer.mih"
#include "io.mih"
#include "lexer.mih"
#include "list.mih"
#include "map.mih"
#include "math.mih"
#include "maybe.mih"
#include "mutvar.mih"
#include "ops.mih"
#include "pair.mih"
#include "parser.mih"
#include "pretty_printer.mih"
#include "private_builtin.mih"
#include "random.mih"
#include "require.mih"
#include "rtti_implementation.mih"
#include "set.mih"
#include "set_ordlist.mih"
#include "set_tree234.mih"
#include "solutions.mih"
#include "std_util.mih"
#include "stm_builtin.mih"
#include "store.mih"
#include "stream.mih"
#include "string.mih"
#include "table_builtin.mih"
#include "term.mih"
#include "term_conversion.mih"
#include "term_io.mih"
#include "time.mih"
#include "tree234.mih"
#include "type_desc.mih"
#include "unit.mih"
#include "univ.mih"
#include "varset.mih"
#include "version_array.mih"
#include "stream.string_writer.mih"
#include "string.format.mih"
#include "string.parse_runtime.mih"
#include "string.parse_util.mih"
#include "string.to_string.mih"




static const MR_VA_PseudoTypeInfo_Struct8 mercury__dir____vpti_pred_8__plain_builtin__type_ctor_info_string_0__plain_builtin__type_ctor_info_string_0__plain_io__type_ctor_info_file_type_0__plain_bool__type_ctor_info_bool_0__pseudo_1__pseudo_1__plain_io__type_ctor_info_state_0__plain_io__type_ctor_info_state_0;

static const MR_FA_PseudoTypeInfo_Struct1 mercury__dir__list__pti_list_1__plain_io__type_ctor_info_file_id_0;

static const MR_FA_PseudoTypeInfo_Struct1 mercury__dir__io__pti_maybe_partial_res_1__pseudo_1;

static const MR_VA_PseudoTypeInfo_Struct3 mercury__dir____vpti_tuple_3__pseudo_io__pti_maybe_partial_res_1__pseudo_1__plain_bool__type_ctor_info_bool_0__plain_dir__type_ctor_info_stream_0;

static const MR_VA_PseudoTypeInfo_Struct3 mercury__dir____vpti_pred_3__pseudo_1__plain_io__type_ctor_info_state_0__plain_io__type_ctor_info_state_0;

static const MR_VA_PseudoTypeInfo_Struct2 mercury__dir____vpti_tuple_2__pseudo_1__plain_io__type_ctor_info_state_0;

static MR_bool MR_CALL 
mercury__dir____Unify____foldl_pred_1_0_10001(
  MR_Box mercury__dir__wrapper_arg_1,
  MR_Box mercury__dir__wrapper_arg_2,
  MR_Box mercury__dir__wrapper_arg_3);

static void MR_CALL 
mercury__dir____Compare____foldl_pred_1_0_10001(
  MR_Box mercury__dir__wrapper_arg_1,
  MR_Box * mercury__dir__wrapper_arg_2,
  MR_Box mercury__dir__wrapper_arg_3,
  MR_Box mercury__dir__wrapper_arg_4);

static MR_bool MR_CALL 
mercury__dir____Unify____stream_0_0_10001(
  MR_Box mercury__dir__wrapper_arg_1,
  MR_Box mercury__dir__wrapper_arg_2);

static void MR_CALL 
mercury__dir____Compare____stream_0_0_10001(
  MR_Box * mercury__dir__wrapper_arg_1,
  MR_Box mercury__dir__wrapper_arg_2,
  MR_Box mercury__dir__wrapper_arg_3);

static void MR_CALL 
mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_112_114_101_100_95_95_116_114_121_95_105_111_95_95_104_111_53_95_95_91_49_44_32_50_44_32_51_44_32_52_44_32_53_44_32_54_44_32_55_44_32_56_44_32_57_44_32_49_48_44_32_49_49_44_32_49_50_44_32_49_51_93_95_48_4_p_in__exception_0_1(
  MR_Box mercury__dir__closure_arg,
  MR_Box * mercury__dir__wrapper_arg_1);

static void MR_CALL 
mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_112_114_101_100_95_95_116_114_121_95_105_111_95_95_104_111_53_95_95_91_49_44_32_50_44_32_51_44_32_52_44_32_53_44_32_54_44_32_55_44_32_56_44_32_57_44_32_49_48_44_32_49_49_44_32_49_50_44_32_49_51_93_95_48_4_p_in__exception_0(
  MR_Word mercury__dir__TypeInfo_for_T_16,
  MR_Word mercury__dir__V_5_5,
  MR_Word * mercury__dir__V_6_6);

static MR_Word MR_CALL 
mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_109_97_112_95_95_104_111_51_95_95_91_50_93_95_48_2_f_in__list_0(
  MR_Word mercury__dir__V_12_12,
  MR_Word mercury__dir__HeadVar__2_2);

static MR_Word MR_CALL 
mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_109_97_112_95_95_104_111_50_95_95_91_50_93_95_48_2_f_in__list_0(
  MR_Char mercury__dir__V_12_12,
  MR_Word mercury__dir__HeadVar__2_2);

static MR_Word MR_CALL 
mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_109_97_112_95_95_104_111_49_95_95_91_50_93_95_48_2_f_in__list_0(
  MR_Word mercury__dir__V_12_12,
  MR_Word mercury__dir__HeadVar__2_2);

static MR_Integer MR_CALL 
mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_67_108_97_115_115_77_101_116_104_111_100_95_102_111_114_95_111_112_115_95_95_111_112_95_116_97_98_108_101_95_95_95_95_111_112_115_95_95_109_101_114_99_117_114_121_95_111_112_95_116_97_98_108_101_95_95_97_114_105_116_121_48_95_95_95_95_95_95_111_112_115_95_95_109_97_120_95_112_114_105_111_114_105_116_121_95_49_95_95_91_49_93_95_48_1_f_in__ops_0(void);

static MR_Word MR_CALL 
mercury__dir__map__ho9_2_f_in__list_0(
  MR_Word mercury__dir__HeadVar__2_2);

static void MR_CALL 
mercury__dir__take_while__ho8_4_p_in__list_0(
  MR_Word mercury__dir__HeadVar__2_2,
  MR_Word * mercury__dir__HeadVar__3_3,
  MR_Word * mercury__dir__HeadVar__4_4);

static void MR_CALL 
mercury__dir__take_while__ho7_4_p_in__list_0(
  MR_Word mercury__dir__HeadVar__2_2,
  MR_Word * mercury__dir__HeadVar__3_3,
  MR_Word * mercury__dir__HeadVar__4_4);

static void MR_CALL 
mercury__dir__take_while__ho6_4_p_in__list_0(
  MR_Word mercury__dir__HeadVar__2_2,
  MR_Word * mercury__dir__HeadVar__3_3,
  MR_Word * mercury__dir__HeadVar__4_4);

static MR_Word MR_CALL 
mercury__dir__map__ho4_2_f_in__list_0(
  MR_Word mercury__dir__HeadVar__2_2);

static void MR_CALL 
mercury__dir__IntroducedFrom__pred__foldl2_process_dir__1348__1_13_p_0(
  MR_Word mercury__dir__TypeInfo_for_T_69,
  MR_Word mercury__dir__SymLinkParent_12,
  MR_Word mercury__dir__P_13,
  MR_String mercury__dir__DirName_14,
  MR_Word mercury__dir__Recursive_16,
  MR_Word mercury__dir__FollowLinks_17,
  MR_Box mercury__dir__T0_19,
  MR_Word mercury__dir__ParentIds_23,
  MR_Box mercury__dir__Dir0_25,
  MR_String mercury__dir__FirstEntry_26,
  MR_Tuple * mercury__dir__LambdaHeadVar__1_50);

static void MR_CALL 
mercury__dir__find_matching_brace_or_comma_6_p_0(
  MR_Word mercury__dir__HeadVar__1_1,
  MR_Word mercury__dir__Alternatives0_2,
  MR_Word mercury__dir__CurAlternative_3,
  MR_Integer mercury__dir__BraceLevel_4,
  MR_Word * mercury__dir__Alternatives_5,
  MR_Word * mercury__dir__Left_6);

static void MR_CALL 
mercury__dir__read_entry_2_7_p_0(
  MR_Box mercury__dir__Dir0_1,
  MR_Box * mercury__dir__Dir_2,
  MR_Integer * mercury__dir__Status_3,
  MR_Box * mercury__dir__Error_4,
  MR_String * mercury__dir__FileName_5);

static void MR_CALL 
mercury__dir__read_entry_4_p_0(
  MR_Box mercury__dir__Dir0_5,
  MR_Word * mercury__dir__Res_6);

static void MR_CALL 
mercury__dir__close_2_5_p_0(
  MR_Box mercury__dir__Dir_1,
  MR_Integer * mercury__dir__Status_2,
  MR_Box * mercury__dir__Error_3);

static void MR_CALL 
mercury__dir__close_4_p_0(
  MR_Box mercury__dir__Dir_5,
  MR_Word * mercury__dir__Res_6);

static void MR_CALL 
mercury__dir__make_dir_open_result_error_4_p_0(
  MR_Box mercury__dir__Error_5,
  MR_Word * mercury__dir__HeadVar__2_2);

static MR_Word MR_CALL 
mercury__dir__make_dir_open_result_eof_0_f_0(void);

static void MR_CALL 
mercury__dir__make_win32_dir_open_result_ok_5_p_0(
  MR_Box mercury__dir__Dir_6,
  MR_String mercury__dir__FirstFile0_7,
  MR_Word * mercury__dir__Result_8);

static void MR_CALL 
mercury__dir__read_first_entry_4_p_0(
  MR_Box mercury__dir__Dir_5,
  MR_Word * mercury__dir__Result_6);

static void MR_CALL 
mercury__dir__check_dir_readable_5_p_0(
  MR_String mercury__dir__DirName_6,
  MR_Integer * mercury__dir__IsReadable_7,
  MR_Word * mercury__dir__Result_8);

static void MR_CALL 
mercury__dir__open_2_4_p_0(
  MR_String mercury__dir__DirName_1,
  MR_Word * mercury__dir__Result_2);

static MR_bool MR_CALL 
mercury__dir__can_implement_dir_foldl_0_p_0(void);

static void MR_CALL 
mercury__dir__check_for_symlink_loop_7_p_0(
  MR_Word mercury__dir__SymLinkParent_8,
  MR_String mercury__dir__DirName_9,
  MR_Word * mercury__dir__LoopRes_10,
  MR_Word mercury__dir__STATE_VARIABLE_ParentIds_0_17,
  MR_Word * mercury__dir__STATE_VARIABLE_ParentIds_18);

static void MR_CALL 
mercury__dir__foldl2_process_entries_14_p_0(
  MR_Word mercury__dir__TypeInfo_for_T_87,
  MR_Box mercury__dir__STATE_VARIABLE_Dir_0_1,
  MR_Box * mercury__dir__STATE_VARIABLE_Dir_2,
  MR_Word mercury__dir__SymLinkParent_3,
  MR_Word mercury__dir__P_4,
  MR_String mercury__dir__DirName_5,
  MR_Word mercury__dir__HeadVar__6_6,
  MR_Word mercury__dir__ParentIds_7,
  MR_Word mercury__dir__Recursive_8,
  MR_Word mercury__dir__FollowLinks_9,
  MR_Word * mercury__dir__HeadVar__10_10,
  MR_Box mercury__dir__T0_11,
  MR_Word * mercury__dir__HeadVar__12_12);

static void MR_CALL 
mercury__dir__foldl2_process_dir2_13_p_0(
  MR_Word mercury__dir__TypeInfo_for_T_33,
  MR_Box mercury__dir__STATE_VARIABLE_Dir_0_26,
  MR_Box * mercury__dir__STATE_VARIABLE_Dir_27,
  MR_Word mercury__dir__SymLinkParent_15,
  MR_Word mercury__dir__P_16,
  MR_String mercury__dir__DirName_17,
  MR_Word mercury__dir__ParentIds_18,
  MR_String mercury__dir__FirstEntry_19,
  MR_Word mercury__dir__Recursive_20,
  MR_Word mercury__dir__FollowLinks_21,
  MR_Box mercury__dir__T0_22,
  MR_Tuple * mercury__dir__HeadVar__11_11);

static void MR_CALL 
mercury__dir__foldl2_process_dir_11_p_0_1(
  MR_Box mercury__dir__closure_arg,
  MR_Box * mercury__dir__wrapper_arg_1,
  MR_Box mercury__dir__wrapper_arg_2,
  MR_Box * mercury__dir__wrapper_arg_3);

static void MR_CALL 
mercury__dir__check_dir_accessibility_4_p_0(
  MR_String mercury__dir__DirName_5,
  MR_Word * mercury__dir__Res_6);

static void MR_CALL 
mercury__dir__make_mkdir_res_exists_5_p_0(
  MR_Box mercury__dir__Error_6,
  MR_String mercury__dir__DirName_7,
  MR_Word * mercury__dir__Res_8);

static void MR_CALL 
mercury__dir__make_mkdir_res_error_4_p_0(
  MR_Box mercury__dir__Error_5,
  MR_Word * mercury__dir__HeadVar__2_2);

static MR_Word MR_CALL 
mercury__dir__make_mkdir_res_ok_0_f_0(void);

static MR_bool MR_CALL 
mercury__dir__can_implement_make_directory_0_p_0(void);

static MR_Word MR_CALL 
mercury__dir__canonicalize_path_chars_2_2_f_0(
  MR_Word mercury__dir__HeadVar__1_1,
  MR_Word mercury__dir__HeadVar__2_2);


static /* final */ const MR_Box mercury__dir_scalar_common_1[8][2];

static /* final */ const MR_Box mercury__dir_scalar_common_2[1][3];

static /* final */ const MR_Box mercury__dir_scalar_common_3[1][4];

static /* final */ const MR_Box mercury__dir_scalar_common_4[2][5];

static /* final */ const MR_Box mercury__dir_scalar_common_5[5][1];

static /* final */ const MR_Integer mercury__dir_scalar_common_6[1][2];

static /* final */ const MR_Box mercury__dir_scalar_common_7[1][16];

static /* final */ const MR_Box mercury__dir_scalar_common_8[1][7];




static /* final */ const MR_Box mercury__dir_scalar_common_1[8][2] = {
  /* row 0 */
  {
    ((MR_Box) (&mercury__list__list__type_ctor_info_list_1)),
    ((MR_Box) (&mercury__builtin__builtin__type_ctor_info_character_0))
  },
  /* row 1 */
  {
    ((MR_Box) ((MR_Integer) 2)),
    ((MR_Box) (MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0))))
  },
  /* row 2 */
  {
    ((MR_Box) ((MR_Integer) 1)),
    ((MR_Box) (MR_mkword(MR_mktag(1), &mercury__dir_scalar_common_1[1])))
  },
  /* row 3 */
  {
    ((MR_Box) ((MR_Integer) 0)),
    ((MR_Box) (MR_mkword(MR_mktag(1), &mercury__dir_scalar_common_1[2])))
  },
  /* row 4 */
  {
    ((MR_Box) ((MR_Integer) 0)),
    ((MR_Box) (MR_mkword(MR_mktag(1), &mercury__dir_scalar_common_1[1])))
  },
  /* row 5 */
  {
    ((MR_Box) (MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))),
    ((MR_Box) (MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0))))
  },
  /* row 6 */
  {
    ((MR_Box) (MR_Word) ((MR_Char) 58)),
    ((MR_Box) (MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0))))
  },
  /* row 7 */
  {
    ((MR_Box) (&mercury__list__list__type_ctor_info_list_1)),
    ((MR_Box) (&mercury__dir_scalar_common_1[0]))
  },
};

static /* final */ const MR_Box mercury__dir_scalar_common_2[1][3] = {
  /* row 0 */
  {
    ((MR_Box) (base_typeclass_info_stream__stream__arity2__io__output_stream__arity0__io__state__arity0__)),
    ((MR_Box) (&mercury__io__io__type_ctor_info_output_stream_0)),
    ((MR_Box) (&mercury__io__io__type_ctor_info_state_0))
  },
};

static /* final */ const MR_Box mercury__dir_scalar_common_3[1][4] = {
  /* row 0 */
  {
    ((MR_Box) (base_typeclass_info_stream__output__arity2__io__output_stream__arity0__io__state__arity0__)),
    ((MR_Box) (&mercury__dir_scalar_common_2[0])),
    ((MR_Box) (&mercury__io__io__type_ctor_info_output_stream_0)),
    ((MR_Box) (&mercury__io__io__type_ctor_info_state_0))
  },
};

static /* final */ const MR_Box mercury__dir_scalar_common_4[2][5] = {
  /* row 0 */
  {
    ((MR_Box) (base_typeclass_info_stream__writer__arity3__io__output_stream__arity0__string__arity0__io__state__arity0__)),
    ((MR_Box) (&mercury__dir_scalar_common_3[0])),
    ((MR_Box) (&mercury__io__io__type_ctor_info_output_stream_0)),
    ((MR_Box) (&mercury__builtin__builtin__type_ctor_info_string_0)),
    ((MR_Box) (&mercury__io__io__type_ctor_info_state_0))
  },
  /* row 1 */
  {
    ((MR_Box) (base_typeclass_info_stream__writer__arity3__io__output_stream__arity0__character__arity0__io__state__arity0__)),
    ((MR_Box) (&mercury__dir_scalar_common_3[0])),
    ((MR_Box) (&mercury__io__io__type_ctor_info_output_stream_0)),
    ((MR_Box) (&mercury__builtin__builtin__type_ctor_info_character_0)),
    ((MR_Box) (&mercury__io__io__type_ctor_info_state_0))
  },
};

static /* final */ const MR_Box mercury__dir_scalar_common_5[5][1] = {
  /* row 0 */
  {
    ((MR_Box) (((MR_Box) ((MR_String) "dir.make_directory not implemented on this platform"))))
  },
  /* row 1 */
  {
    ((MR_Box) ((MR_Integer) 0))
  },
  /* row 2 */
  {
    ((MR_Box) (((MR_Box) ((MR_String) "dir.foldl2 not implemented on this platform"))))
  },
  /* row 3 */
  {
    ((MR_Box) (((MR_Box) ((MR_String) "dir.foldl2: pathname is not a directory"))))
  },
  /* row 4 */
  {
    ((MR_Box) (((MR_Box) ((MR_String) "no error"))))
  },
};

static /* final */ const MR_Integer mercury__dir_scalar_common_6[1][2] = {
  /* row 0 */
  {
    (MR_Integer) 1,
    (MR_Integer) 33
  },
};

static /* final */ const MR_Box mercury__dir_scalar_common_7[1][16] = {
  /* row 0 */
  {
    NULL,
    ((MR_Box) (&mercury__dir_scalar_common_6[0])),
    ((MR_Box) (MR_Word) ((MR_Integer) 13)),
    ((MR_Box) (&mercury__private_builtin__private_builtin__type_ctor_info_type_info_0)),
    ((MR_Box) (&mercury__bool__bool__type_ctor_info_bool_0)),
    ((MR_Box) (&mercury__dir____vpti_pred_8__plain_builtin__type_ctor_info_string_0__plain_builtin__type_ctor_info_string_0__plain_io__type_ctor_info_file_type_0__plain_bool__type_ctor_info_bool_0__pseudo_1__pseudo_1__plain_io__type_ctor_info_state_0__plain_io__type_ctor_info_state_0)),
    ((MR_Box) (&mercury__builtin__builtin__type_ctor_info_string_0)),
    ((MR_Box) (&mercury__bool__bool__type_ctor_info_bool_0)),
    ((MR_Box) (&mercury__bool__bool__type_ctor_info_bool_0)),
    ((MR_Box) (MR_Word) ((MR_Integer) 1)),
    ((MR_Box) (&mercury__dir__list__pti_list_1__plain_io__type_ctor_info_file_id_0)),
    ((MR_Box) (&mercury__dir__dir__type_ctor_info_stream_0)),
    ((MR_Box) (&mercury__builtin__builtin__type_ctor_info_string_0)),
    ((MR_Box) (&mercury__dir____vpti_tuple_3__pseudo_io__pti_maybe_partial_res_1__pseudo_1__plain_bool__type_ctor_info_bool_0__plain_dir__type_ctor_info_stream_0)),
    ((MR_Box) (&mercury__io__io__type_ctor_info_state_0)),
    ((MR_Box) (&mercury__io__io__type_ctor_info_state_0))
  },
};

static /* final */ const MR_Box mercury__dir_scalar_common_8[1][7] = {
  /* row 0 */
  {
    NULL,
    ((MR_Box) (&mercury__dir_scalar_common_6[0])),
    ((MR_Box) (MR_Word) ((MR_Integer) 4)),
    ((MR_Box) (&mercury__private_builtin__private_builtin__type_ctor_info_type_info_0)),
    ((MR_Box) (&mercury__dir____vpti_pred_3__pseudo_1__plain_io__type_ctor_info_state_0__plain_io__type_ctor_info_state_0)),
    ((MR_Box) (&mercury__io__io__type_ctor_info_state_0)),
    ((MR_Box) (&mercury__dir____vpti_tuple_2__pseudo_1__plain_io__type_ctor_info_state_0))
  },
};



#include "array.mh"
#include "benchmarking.mh"
#include "bitmap.mh"
#include "builtin.mh"
#include "char.mh"
#include "construct.mh"
#include "dir.mh"
#include "exception.mh"
#include "float.mh"
#include "int.mh"
#include "io.mh"
#include "math.mh"
#include "pretty_printer.mh"
#include "private_builtin.mh"
#include "rtti_implementation.mh"
#include "stm_builtin.mh"
#include "store.mh"
#include "string.mh"
#include "table_builtin.mh"
#include "time.mh"
#include "type_desc.mh"
#include "version_array.mh"

#line 327 "dir.m"
MR_String 
ML_dir_this_directory(void)
#line 327 "dir.m"
{
#line 327 "dir.m"
	MR_String ret_value;
	ret_value = (MR_String)mercury__dir__this_directory_0_f_0();
	return ret_value;
}

#line 785 "dir.m"
MR_String 
ML_make_path_name(
  MR_String mercury__dir__DirName_4,
  MR_String mercury__dir__FileName_5)
#line 785 "dir.m"
{
#line 785 "dir.m"
	MR_String ret_value;
	ret_value = (MR_String)mercury__dir__make_path_name_2_f_0((MR_String) mercury__dir__DirName_4, (MR_String) mercury__dir__FileName_5);
	return ret_value;
}

#line 1219 "dir.m"
MR_Word 
ML_make_mkdir_res_ok(void)
#line 1219 "dir.m"
{
#line 1219 "dir.m"
	MR_Word ret_value;
	ret_value = (MR_Word)mercury__dir__make_mkdir_res_ok_0_f_0();
	return ret_value;
}

#line 1232 "dir.m"
void 
ML_make_mkdir_res_error(
  MR_Integer mercury__dir__Error_5,
  MR_Word * mercury__dir__HeadVar__2_2)
#line 1232 "dir.m"
{
#line 1232 "dir.m"
	MR_Box mercury__dir__boxed_Error_5;
	MR_MAYBE_BOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_5, mercury__dir__boxed_Error_5);
	mercury__dir__make_mkdir_res_error_4_p_0(mercury__dir__boxed_Error_5, (MR_Word *) mercury__dir__HeadVar__2_2);
}

#line 1247 "dir.m"
void 
ML_make_mkdir_res_exists(
  MR_Integer mercury__dir__Error_6,
  MR_String mercury__dir__DirName_7,
  MR_Word * mercury__dir__Res_8)
#line 1247 "dir.m"
{
#line 1247 "dir.m"
	MR_Box mercury__dir__boxed_Error_6;
	MR_MAYBE_BOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_6, mercury__dir__boxed_Error_6);
	mercury__dir__make_mkdir_res_exists_5_p_0(mercury__dir__boxed_Error_6, (MR_String) mercury__dir__DirName_7, (MR_Word *) mercury__dir__Res_8);
}

#line 1270 "dir.m"
void 
ML_check_dir_accessibility(
  MR_String mercury__dir__DirName_5,
  MR_Word * mercury__dir__Res_6)
#line 1270 "dir.m"
{
#line 1270 "dir.m"
	mercury__dir__check_dir_accessibility_4_p_0((MR_String) mercury__dir__DirName_5, (MR_Word *) mercury__dir__Res_6);
}

#line 1718 "dir.m"
void 
ML_check_dir_readable(
  MR_String mercury__dir__DirName_6,
  MR_Integer * mercury__dir__IsReadable_7,
  MR_Word * mercury__dir__Result_8)
#line 1718 "dir.m"
{
#line 1718 "dir.m"
	mercury__dir__check_dir_readable_5_p_0((MR_String) mercury__dir__DirName_6, (MR_Integer *) mercury__dir__IsReadable_7, (MR_Word *) mercury__dir__Result_8);
}

#line 1763 "dir.m"
void 
ML_dir_read_first_entry(
  ML_DIR_STREAM mercury__dir__Dir_5,
  MR_Word * mercury__dir__Result_6)
#line 1763 "dir.m"
{
#line 1763 "dir.m"
	MR_Box mercury__dir__boxed_Dir_5;
	MR_MAYBE_BOX_FOREIGN_TYPE(ML_DIR_STREAM, mercury__dir__Dir_5, mercury__dir__boxed_Dir_5);
	mercury__dir__read_first_entry_4_p_0(mercury__dir__boxed_Dir_5, (MR_Word *) mercury__dir__Result_6);
}

#line 1786 "dir.m"
void 
ML_make_win32_dir_open_result_ok(
  ML_DIR_STREAM mercury__dir__Dir_6,
  MR_String mercury__dir__FirstFile0_7,
  MR_Word * mercury__dir__Result_8)
#line 1786 "dir.m"
{
#line 1786 "dir.m"
	MR_Box mercury__dir__boxed_Dir_6;
	MR_MAYBE_BOX_FOREIGN_TYPE(ML_DIR_STREAM, mercury__dir__Dir_6, mercury__dir__boxed_Dir_6);
	mercury__dir__make_win32_dir_open_result_ok_5_p_0(mercury__dir__boxed_Dir_6, (MR_String) mercury__dir__FirstFile0_7, (MR_Word *) mercury__dir__Result_8);
}

#line 1816 "dir.m"
MR_Word 
ML_make_dir_open_result_eof(void)
#line 1816 "dir.m"
{
#line 1816 "dir.m"
	MR_Word ret_value;
	ret_value = (MR_Word)mercury__dir__make_dir_open_result_eof_0_f_0();
	return ret_value;
}

#line 1827 "dir.m"
void 
ML_make_dir_open_result_error(
  MR_Integer mercury__dir__Error_5,
  MR_Word * mercury__dir__HeadVar__2_2)
#line 1827 "dir.m"
{
#line 1827 "dir.m"
	MR_Box mercury__dir__boxed_Error_5;
	MR_MAYBE_BOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_5, mercury__dir__boxed_Error_5);
	mercury__dir__make_dir_open_result_error_4_p_0(mercury__dir__boxed_Error_5, (MR_Word *) mercury__dir__HeadVar__2_2);
}


static const MR_VA_PseudoTypeInfo_Struct8 mercury__dir____vpti_pred_8__plain_builtin__type_ctor_info_string_0__plain_builtin__type_ctor_info_string_0__plain_io__type_ctor_info_file_type_0__plain_bool__type_ctor_info_bool_0__pseudo_1__pseudo_1__plain_io__type_ctor_info_state_0__plain_io__type_ctor_info_state_0 = {
  &mercury__builtin__builtin__type_ctor_info_pred_0,
  (MR_Integer) 8,
  {
    (MR_PseudoTypeInfo) &mercury__builtin__builtin__type_ctor_info_string_0,
    (MR_PseudoTypeInfo) &mercury__builtin__builtin__type_ctor_info_string_0,
    (MR_PseudoTypeInfo) &mercury__io__io__type_ctor_info_file_type_0,
    (MR_PseudoTypeInfo) &mercury__bool__bool__type_ctor_info_bool_0,
    (MR_PseudoTypeInfo) (MR_Integer) 1,
    (MR_PseudoTypeInfo) (MR_Integer) 1,
    (MR_PseudoTypeInfo) &mercury__io__io__type_ctor_info_state_0,
    (MR_PseudoTypeInfo) &mercury__io__io__type_ctor_info_state_0
  }
};

static const MR_FA_PseudoTypeInfo_Struct1 mercury__dir__list__pti_list_1__plain_io__type_ctor_info_file_id_0 = {
  &mercury__list__list__type_ctor_info_list_1,
  {
    (MR_PseudoTypeInfo) &mercury__io__io__type_ctor_info_file_id_0
  }
};

static const MR_FA_PseudoTypeInfo_Struct1 mercury__dir__io__pti_maybe_partial_res_1__pseudo_1 = {
  &mercury__io__io__type_ctor_info_maybe_partial_res_1,
  {
    (MR_PseudoTypeInfo) (MR_Integer) 1
  }
};

static const MR_VA_PseudoTypeInfo_Struct3 mercury__dir____vpti_tuple_3__pseudo_io__pti_maybe_partial_res_1__pseudo_1__plain_bool__type_ctor_info_bool_0__plain_dir__type_ctor_info_stream_0 = {
  &mercury__builtin__builtin__type_ctor_info_tuple_0,
  (MR_Integer) 3,
  {
    (MR_PseudoTypeInfo) &mercury__dir__io__pti_maybe_partial_res_1__pseudo_1,
    (MR_PseudoTypeInfo) &mercury__bool__bool__type_ctor_info_bool_0,
    (MR_PseudoTypeInfo) &mercury__dir__dir__type_ctor_info_stream_0
  }
};

static const MR_VA_PseudoTypeInfo_Struct3 mercury__dir____vpti_pred_3__pseudo_1__plain_io__type_ctor_info_state_0__plain_io__type_ctor_info_state_0 = {
  &mercury__builtin__builtin__type_ctor_info_pred_0,
  (MR_Integer) 3,
  {
    (MR_PseudoTypeInfo) (MR_Integer) 1,
    (MR_PseudoTypeInfo) &mercury__io__io__type_ctor_info_state_0,
    (MR_PseudoTypeInfo) &mercury__io__io__type_ctor_info_state_0
  }
};

static const MR_VA_PseudoTypeInfo_Struct2 mercury__dir____vpti_tuple_2__pseudo_1__plain_io__type_ctor_info_state_0 = {
  &mercury__builtin__builtin__type_ctor_info_tuple_0,
  (MR_Integer) 2,
  {
    (MR_PseudoTypeInfo) (MR_Integer) 1,
    (MR_PseudoTypeInfo) &mercury__io__io__type_ctor_info_state_0
  }
};

const MR_TypeCtorInfo_Struct mercury__dir__dir__type_ctor_info_foldl_pred_1 = {
  (MR_Integer) 1,
  (MR_Integer) 16,
  (MR_Integer) -1,
  mercury__private_builtin__MR_TYPECTOR_REP_EQUIV,
  ((MR_Box) (mercury__dir____Unify____foldl_pred_1_0_10001)),
  ((MR_Box) (mercury__dir____Compare____foldl_pred_1_0_10001)),
  (MR_String) "dir",
  (MR_String) "foldl_pred",
  {     NULL },
  {     (MR_PseudoTypeInfo) &mercury__dir____vpti_pred_8__plain_builtin__type_ctor_info_string_0__plain_builtin__type_ctor_info_string_0__plain_io__type_ctor_info_file_type_0__plain_bool__type_ctor_info_bool_0__pseudo_1__pseudo_1__plain_io__type_ctor_info_state_0__plain_io__type_ctor_info_state_0 },
  (MR_Integer) -1,
  (MR_Integer) 0,
  NULL
};

const MR_TypeCtorInfo_Struct mercury__dir__dir__type_ctor_info_stream_0 = {
  (MR_Integer) 0,
  (MR_Integer) 16,
  (MR_Integer) -1,
  mercury__private_builtin__MR_TYPECTOR_REP_FOREIGN,
  ((MR_Box) (mercury__dir____Unify____stream_0_0_10001)),
  ((MR_Box) (mercury__dir____Compare____stream_0_0_10001)),
  (MR_String) "dir",
  (MR_String) "stream",
  {     NULL },
  {     NULL },
  (MR_Integer) -1,
  (MR_Integer) 0,
  NULL
};

static MR_bool MR_CALL 
mercury__dir____Unify____foldl_pred_1_0_10001(
  MR_Box mercury__dir__wrapper_arg_1,
  MR_Box mercury__dir__wrapper_arg_2,
  MR_Box mercury__dir__wrapper_arg_3)
{
  {
    MR_bool mercury__dir__succeeded;

    {
      mercury__dir__succeeded = mercury__dir____Unify____foldl_pred_1_0(((MR_Word) mercury__dir__wrapper_arg_1), ((MR_Word) mercury__dir__wrapper_arg_2), ((MR_Word) mercury__dir__wrapper_arg_3));
    }
    return mercury__dir__succeeded;
  }
}

static void MR_CALL 
mercury__dir____Compare____foldl_pred_1_0_10001(
  MR_Box mercury__dir__wrapper_arg_1,
  MR_Box * mercury__dir__wrapper_arg_2,
  MR_Box mercury__dir__wrapper_arg_3,
  MR_Box mercury__dir__wrapper_arg_4)
{
  {
    MR_Word mercury__dir__conv0_HeadVar__1_1;

    {
      mercury__dir____Compare____foldl_pred_1_0(((MR_Word) mercury__dir__wrapper_arg_1), &mercury__dir__conv0_HeadVar__1_1, ((MR_Word) mercury__dir__wrapper_arg_3), ((MR_Word) mercury__dir__wrapper_arg_4));
    }
    *mercury__dir__wrapper_arg_2 = ((MR_Box) (mercury__dir__conv0_HeadVar__1_1));
  }
}

static MR_bool MR_CALL 
mercury__dir____Unify____stream_0_0_10001(
  MR_Box mercury__dir__wrapper_arg_1,
  MR_Box mercury__dir__wrapper_arg_2)
{
  {
    MR_bool mercury__dir__succeeded;

    {
      mercury__dir__succeeded = mercury__dir____Unify____stream_0_0(((MR_Box) mercury__dir__wrapper_arg_1), ((MR_Box) mercury__dir__wrapper_arg_2));
    }
    return mercury__dir__succeeded;
  }
}

static void MR_CALL 
mercury__dir____Compare____stream_0_0_10001(
  MR_Box * mercury__dir__wrapper_arg_1,
  MR_Box mercury__dir__wrapper_arg_2,
  MR_Box mercury__dir__wrapper_arg_3)
{
  {
    MR_Word mercury__dir__conv0_HeadVar__1_1;

    {
      mercury__dir____Compare____stream_0_0(&mercury__dir__conv0_HeadVar__1_1, ((MR_Box) mercury__dir__wrapper_arg_2), ((MR_Box) mercury__dir__wrapper_arg_3));
    }
    *mercury__dir__wrapper_arg_1 = ((MR_Box) (mercury__dir__conv0_HeadVar__1_1));
  }
}

static void MR_CALL 
mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_112_114_101_100_95_95_116_114_121_95_105_111_95_95_104_111_53_95_95_91_49_44_32_50_44_32_51_44_32_52_44_32_53_44_32_54_44_32_55_44_32_56_44_32_57_44_32_49_48_44_32_49_49_44_32_49_50_44_32_49_51_93_95_48_4_p_in__exception_0_1(
  MR_Box mercury__dir__closure_arg,
  MR_Box * mercury__dir__wrapper_arg_1)
{
  {
    MR_Box mercury__dir__closure = mercury__dir__closure_arg;
    MR_Tuple mercury__dir__conv0_V_3_6;

    {
      mercury__exception__unsafe_call_io_goal_3_p_0(((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__closure, (MR_Integer) 3))), ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__closure, (MR_Integer) 4))), &mercury__dir__conv0_V_3_6);
    }
    *mercury__dir__wrapper_arg_1 = ((MR_Box) (mercury__dir__conv0_V_3_6));
  }
}

static void MR_CALL 
mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_112_114_101_100_95_95_116_114_121_95_105_111_95_95_104_111_53_95_95_91_49_44_32_50_44_32_51_44_32_52_44_32_53_44_32_54_44_32_55_44_32_56_44_32_57_44_32_49_48_44_32_49_49_44_32_49_50_44_32_49_51_93_95_48_4_p_in__exception_0(
  MR_Word mercury__dir__TypeInfo_for_T_16,
  MR_Word mercury__dir__V_5_5,
  MR_Word * mercury__dir__V_6_6)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__TypeCtorInfo_18_18;
    MR_Word mercury__dir__TypeCtorInfo_19_19;
    MR_Word mercury__dir__TypeInfo_21_21;
    MR_Word mercury__dir__V_13_9;
    MR_Word mercury__dir__V_9_11;
    MR_Word mercury__dir__conv1_V_9_11;

    {
      mercury__dir__V_13_9 = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 6 * sizeof(MR_Word)), NULL, NULL);
      MR_hl_field(MR_mktag(0), mercury__dir__V_13_9, 0) = ((MR_Box) (&mercury__dir_scalar_common_8[0]));
      MR_hl_field(MR_mktag(0), mercury__dir__V_13_9, 1) = ((MR_Box) (mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_112_114_101_100_95_95_116_114_121_95_105_111_95_95_104_111_53_95_95_91_49_44_32_50_44_32_51_44_32_52_44_32_53_44_32_54_44_32_55_44_32_56_44_32_57_44_32_49_48_44_32_49_49_44_32_49_50_44_32_49_51_93_95_48_4_p_in__exception_0_1));
      MR_hl_field(MR_mktag(0), mercury__dir__V_13_9, 2) = ((MR_Box) (MR_Word) ((MR_Integer) 3));
      MR_hl_field(MR_mktag(0), mercury__dir__V_13_9, 3) = ((MR_Box) (mercury__dir__TypeInfo_for_T_16));
      MR_hl_field(MR_mktag(0), mercury__dir__V_13_9, 4) = ((MR_Box) (mercury__dir__V_5_5));
      MR_hl_field(MR_mktag(0), mercury__dir__V_13_9, 5) = NULL;
    }
    mercury__dir__TypeCtorInfo_19_19 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_tuple_0;
    mercury__dir__TypeCtorInfo_18_18 = (MR_Word) &mercury__io__io__type_ctor_info_state_0;
    {
      mercury__dir__TypeInfo_21_21 = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 4 * sizeof(MR_Word)), NULL, NULL);
      MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_21_21, 0) = ((MR_Box) (mercury__dir__TypeCtorInfo_19_19));
      MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_21_21, 1) = ((MR_Box) ((MR_Integer) 2));
      MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_21_21, 2) = ((MR_Box) (mercury__dir__TypeInfo_for_T_16));
      MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_21_21, 3) = ((MR_Box) (mercury__dir__TypeCtorInfo_18_18));
    }
    {
      mercury__exception__try_2_p_0(mercury__dir__TypeInfo_21_21, (MR_Word) mercury__dir__V_13_9, &mercury__dir__conv1_V_9_11);
    }
    mercury__dir__V_9_11 = (MR_Word) mercury__dir__conv1_V_9_11;
    if (((MR_tag((MR_Word) mercury__dir__V_9_11)) == (MR_mktag((MR_Integer) 2))))
      {
        *mercury__dir__V_6_6 = (MR_Word) mercury__dir__V_9_11;
        mercury__private_builtin__dummy_var = mercury__private_builtin__dummy_var;
      }
    else
      {
        MR_Tuple mercury__dir__V_14_12 = ((MR_Tuple) (MR_hl_field(MR_mktag(1), mercury__dir__V_9_11, (MR_Integer) 0)));
        MR_Tuple mercury__dir__V_10_13 = ((MR_Tuple) (MR_hl_field(MR_mktag(0), mercury__dir__V_14_12, (MR_Integer) 0)));

        {
          MR_Word base;
          base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
          *mercury__dir__V_6_6 = base;
          MR_hl_field(MR_mktag(1), base, 0) = ((MR_Box) (mercury__dir__V_10_13));
        }
        mercury__private_builtin__dummy_var = mercury__private_builtin__dummy_var;
      }
  }
}

static MR_Word MR_CALL 
mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_109_97_112_95_95_104_111_51_95_95_91_50_93_95_48_2_f_in__list_0(
  MR_Word mercury__dir__V_12_12,
  MR_Word mercury__dir__HeadVar__2_2)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__HeadVar__3_3;

    if ((mercury__dir__HeadVar__2_2 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
      mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
    else
      {
        MR_Word mercury__dir__V_6_6 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 0)));
        MR_Word mercury__dir__V_7_7 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 1)));
        MR_Word mercury__dir__V_8_8;
        MR_Word mercury__dir__V_9_9;

        {
          mercury__dir__V_8_8 = mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_109_97_112_95_95_104_111_49_95_95_91_50_93_95_48_2_f_in__list_0(mercury__dir__V_6_6, mercury__dir__V_12_12);
        }
        {
          mercury__dir__V_9_9 = mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_109_97_112_95_95_104_111_51_95_95_91_50_93_95_48_2_f_in__list_0(mercury__dir__V_12_12, mercury__dir__V_7_7);
        }
        {
          mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
          MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__3_3, 0) = ((MR_Box) (mercury__dir__V_8_8));
          MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__3_3, 1) = ((MR_Box) (mercury__dir__V_9_9));
        }
      }
    return mercury__dir__HeadVar__3_3;
  }
}

static MR_Word MR_CALL 
mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_109_97_112_95_95_104_111_50_95_95_91_50_93_95_48_2_f_in__list_0(
  MR_Char mercury__dir__V_12_12,
  MR_Word mercury__dir__HeadVar__2_2)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__HeadVar__3_3;

    if ((mercury__dir__HeadVar__2_2 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
      mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
    else
      {
        MR_Word mercury__dir__TypeCtorInfo_8_17 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_character_0;
        MR_Word mercury__dir__V_6_6 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 0)));
        MR_Word mercury__dir__V_7_7 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 1)));
        MR_Word mercury__dir__V_8_8;
        MR_Word mercury__dir__V_9_9;
        MR_Word mercury__dir__V_15_15;
        MR_Word mercury__dir__V_16_16 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));

        {
          mercury__dir__V_15_15 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
          MR_hl_field(MR_mktag(1), mercury__dir__V_15_15, 0) = ((MR_Box) (MR_Word) (mercury__dir__V_12_12));
          MR_hl_field(MR_mktag(1), mercury__dir__V_15_15, 1) = ((MR_Box) (mercury__dir__V_16_16));
        }
        {
          mercury__list__append_3_p_1(mercury__dir__TypeCtorInfo_8_17, mercury__dir__V_6_6, mercury__dir__V_15_15, &mercury__dir__V_8_8);
        }
        {
          mercury__dir__V_9_9 = mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_109_97_112_95_95_104_111_50_95_95_91_50_93_95_48_2_f_in__list_0(mercury__dir__V_12_12, mercury__dir__V_7_7);
        }
        {
          mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
          MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__3_3, 0) = ((MR_Box) (mercury__dir__V_8_8));
          MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__3_3, 1) = ((MR_Box) (mercury__dir__V_9_9));
        }
      }
    return mercury__dir__HeadVar__3_3;
  }
}

static MR_Word MR_CALL 
mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_109_97_112_95_95_104_111_49_95_95_91_50_93_95_48_2_f_in__list_0(
  MR_Word mercury__dir__V_12_12,
  MR_Word mercury__dir__HeadVar__2_2)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__HeadVar__3_3;

    if ((mercury__dir__HeadVar__2_2 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
      mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
    else
      {
        MR_Word mercury__dir__TypeCtorInfo_10_19 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_character_0;
        MR_Word mercury__dir__V_6_6 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 0)));
        MR_Word mercury__dir__V_7_7 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 1)));
        MR_Word mercury__dir__V_8_8;
        MR_Word mercury__dir__V_9_9;

        {
          mercury__list__append_3_p_1(mercury__dir__TypeCtorInfo_10_19, mercury__dir__V_12_12, mercury__dir__V_6_6, &mercury__dir__V_8_8);
        }
        {
          mercury__dir__V_9_9 = mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_109_97_112_95_95_104_111_49_95_95_91_50_93_95_48_2_f_in__list_0(mercury__dir__V_12_12, mercury__dir__V_7_7);
        }
        {
          mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
          MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__3_3, 0) = ((MR_Box) (mercury__dir__V_8_8));
          MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__3_3, 1) = ((MR_Box) (mercury__dir__V_9_9));
        }
      }
    return mercury__dir__HeadVar__3_3;
  }
}

static MR_Integer MR_CALL 
mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_67_108_97_115_115_77_101_116_104_111_100_95_102_111_114_95_111_112_115_95_95_111_112_95_116_97_98_108_101_95_95_95_95_111_112_115_95_95_109_101_114_99_117_114_121_95_111_112_95_116_97_98_108_101_95_95_97_114_105_116_121_48_95_95_95_95_95_95_111_112_115_95_95_109_97_120_95_112_114_105_111_114_105_116_121_95_49_95_95_91_49_93_95_48_1_f_in__ops_0(void)
{
  {
    MR_bool mercury__dir__succeeded;

    return (MR_Integer) 1200;
  }
}

static MR_Word MR_CALL 
mercury__dir__map__ho9_2_f_in__list_0(
  MR_Word mercury__dir__HeadVar__2_2)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__HeadVar__3_3;

    if ((mercury__dir__HeadVar__2_2 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
      mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
    else
      {
        MR_Word mercury__dir__V_6_6 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 0)));
        MR_Word mercury__dir__V_7_7 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 1)));
        MR_String mercury__dir__V_8_8;
        MR_Word mercury__dir__V_9_9;

        {
          mercury__string__from_char_list_2_p_0(mercury__dir__V_6_6, &mercury__dir__V_8_8);
        }
        {
          mercury__dir__V_9_9 = mercury__dir__map__ho9_2_f_in__list_0(mercury__dir__V_7_7);
        }
        {
          mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
          MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__3_3, 0) = ((MR_Box) (mercury__dir__V_8_8));
          MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__3_3, 1) = ((MR_Box) (mercury__dir__V_9_9));
        }
      }
    return mercury__dir__HeadVar__3_3;
  }
}

static void MR_CALL 
mercury__dir__take_while__ho8_4_p_in__list_0(
  MR_Word mercury__dir__HeadVar__2_2,
  MR_Word * mercury__dir__HeadVar__3_3,
  MR_Word * mercury__dir__HeadVar__4_4)
{
  {
    MR_bool mercury__dir__succeeded;

    if ((mercury__dir__HeadVar__2_2 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
      {
        *mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
        *mercury__dir__HeadVar__4_4 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
      }
    else
      {
        MR_Char mercury__dir__V_7_7 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 0)));
        MR_Word mercury__dir__V_8_8 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 1)));

        {
          mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__V_7_7);
        }
        mercury__dir__succeeded = !(mercury__dir__succeeded);
        if (mercury__dir__succeeded)
          {
            MR_Word mercury__dir__V_11_11;

            {
              mercury__dir__take_while__ho8_4_p_in__list_0(mercury__dir__V_8_8, &mercury__dir__V_11_11, mercury__dir__HeadVar__4_4);
            }
            {
              MR_Word base;
              base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
              *mercury__dir__HeadVar__3_3 = base;
              MR_hl_field(MR_mktag(1), base, 0) = ((MR_Box) (MR_Word) (mercury__dir__V_7_7));
              MR_hl_field(MR_mktag(1), base, 1) = ((MR_Box) (mercury__dir__V_11_11));
            }
          }
        else
          {
            *mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
            *mercury__dir__HeadVar__4_4 = mercury__dir__HeadVar__2_2;
          }
      }
  }
}

static void MR_CALL 
mercury__dir__take_while__ho7_4_p_in__list_0(
  MR_Word mercury__dir__HeadVar__2_2,
  MR_Word * mercury__dir__HeadVar__3_3,
  MR_Word * mercury__dir__HeadVar__4_4)
{
  {
    MR_bool mercury__dir__succeeded;

    if ((mercury__dir__HeadVar__2_2 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
      {
        *mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
        *mercury__dir__HeadVar__4_4 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
      }
    else
      {
        MR_Char mercury__dir__V_7_7 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 0)));
        MR_Word mercury__dir__V_8_8 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 1)));

        {
          mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__V_7_7);
        }
        mercury__dir__succeeded = !(mercury__dir__succeeded);
        if (mercury__dir__succeeded)
          {
            MR_Word mercury__dir__V_11_11;

            {
              mercury__dir__take_while__ho7_4_p_in__list_0(mercury__dir__V_8_8, &mercury__dir__V_11_11, mercury__dir__HeadVar__4_4);
            }
            {
              MR_Word base;
              base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
              *mercury__dir__HeadVar__3_3 = base;
              MR_hl_field(MR_mktag(1), base, 0) = ((MR_Box) (MR_Word) (mercury__dir__V_7_7));
              MR_hl_field(MR_mktag(1), base, 1) = ((MR_Box) (mercury__dir__V_11_11));
            }
          }
        else
          {
            *mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
            *mercury__dir__HeadVar__4_4 = mercury__dir__HeadVar__2_2;
          }
      }
  }
}

static void MR_CALL 
mercury__dir__take_while__ho6_4_p_in__list_0(
  MR_Word mercury__dir__HeadVar__2_2,
  MR_Word * mercury__dir__HeadVar__3_3,
  MR_Word * mercury__dir__HeadVar__4_4)
{
  {
    MR_bool mercury__dir__succeeded;

    if ((mercury__dir__HeadVar__2_2 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
      {
        *mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
        *mercury__dir__HeadVar__4_4 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
      }
    else
      {
        MR_Char mercury__dir__V_7_7 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 0)));
        MR_Word mercury__dir__V_8_8 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 1)));

        {
          mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__V_7_7);
        }
        mercury__dir__succeeded = !(mercury__dir__succeeded);
        if (mercury__dir__succeeded)
          {
            MR_Word mercury__dir__V_11_11;

            {
              mercury__dir__take_while__ho6_4_p_in__list_0(mercury__dir__V_8_8, &mercury__dir__V_11_11, mercury__dir__HeadVar__4_4);
            }
            {
              MR_Word base;
              base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
              *mercury__dir__HeadVar__3_3 = base;
              MR_hl_field(MR_mktag(1), base, 0) = ((MR_Box) (MR_Word) (mercury__dir__V_7_7));
              MR_hl_field(MR_mktag(1), base, 1) = ((MR_Box) (mercury__dir__V_11_11));
            }
          }
        else
          {
            *mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
            *mercury__dir__HeadVar__4_4 = mercury__dir__HeadVar__2_2;
          }
      }
  }
}

static MR_Word MR_CALL 
mercury__dir__map__ho4_2_f_in__list_0(
  MR_Word mercury__dir__HeadVar__2_2)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__HeadVar__3_3;

    if ((mercury__dir__HeadVar__2_2 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
      mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
    else
      {
        MR_Word mercury__dir__V_6_6 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 0)));
        MR_Word mercury__dir__V_7_7 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__2_2, (MR_Integer) 1)));
        MR_Word mercury__dir__V_8_8;
        MR_Word mercury__dir__V_9_9;
        MR_Word mercury__dir__V_13_13 = (MR_Word) MR_mkword(MR_mktag(1), &mercury__dir_scalar_common_1[5]);
        MR_Word mercury__dir__V_14_14 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
        MR_Word mercury__dir__V_15_15 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));

        {
          mercury__dir__V_8_8 = mercury__dir__expand_acc_2_f_0(mercury__dir__V_6_6, mercury__dir__V_13_13);
        }
        {
          mercury__dir__V_9_9 = mercury__dir__map__ho4_2_f_in__list_0(mercury__dir__V_7_7);
        }
        {
          mercury__dir__HeadVar__3_3 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
          MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__3_3, 0) = ((MR_Box) (mercury__dir__V_8_8));
          MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__3_3, 1) = ((MR_Box) (mercury__dir__V_9_9));
        }
      }
    return mercury__dir__HeadVar__3_3;
  }
}

static void MR_CALL 
mercury__dir__IntroducedFrom__pred__foldl2_process_dir__1348__1_13_p_0(
  MR_Word mercury__dir__TypeInfo_for_T_69,
  MR_Word mercury__dir__SymLinkParent_12,
  MR_Word mercury__dir__P_13,
  MR_String mercury__dir__DirName_14,
  MR_Word mercury__dir__Recursive_16,
  MR_Word mercury__dir__FollowLinks_17,
  MR_Box mercury__dir__T0_19,
  MR_Word mercury__dir__ParentIds_23,
  MR_Box mercury__dir__Dir0_25,
  MR_String mercury__dir__FirstEntry_26,
  MR_Tuple * mercury__dir__LambdaHeadVar__1_50)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Tuple mercury__dir__V_53_53;
    MR_Word mercury__dir__DirRes1_63;
    MR_Word mercury__dir__Continue1_64;
    MR_Box mercury__dir__Dir1_65;

    {
      mercury__dir__foldl2_process_dir2_13_p_0(mercury__dir__TypeInfo_for_T_69, mercury__dir__Dir0_25, &mercury__dir__Dir1_65, mercury__dir__SymLinkParent_12, mercury__dir__P_13, mercury__dir__DirName_14, mercury__dir__ParentIds_23, mercury__dir__FirstEntry_26, mercury__dir__Recursive_16, mercury__dir__FollowLinks_17, mercury__dir__T0_19, &mercury__dir__V_53_53);
    }
    mercury__dir__DirRes1_63 = ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__V_53_53, (MR_Integer) 0)));
    mercury__dir__Continue1_64 = ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__V_53_53, (MR_Integer) 1)));
    {
      MR_Tuple base;
      base = (MR_Tuple) MR_new_object(MR_Tuple, ((MR_Integer) 3 * sizeof(MR_Word)), NULL, NULL);
      *mercury__dir__LambdaHeadVar__1_50 = base;
      MR_hl_field(MR_mktag(0), base, 0) = ((MR_Box) (mercury__dir__DirRes1_63));
      MR_hl_field(MR_mktag(0), base, 1) = ((MR_Box) (mercury__dir__Continue1_64));
      MR_hl_field(MR_mktag(0), base, 2) = ((MR_Box) (mercury__dir__Dir1_65));
    }
  }
}

void MR_CALL 
mercury__dir____Compare____stream_0_0(
  MR_Word * mercury__dir__HeadVar__1_1,
  MR_Box mercury__dir__HeadVar__2_2,
  MR_Box mercury__dir__HeadVar__3_3)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__Cast_HeadVar1_4 = (MR_Word) mercury__dir__HeadVar__2_2;
    MR_Word mercury__dir__Cast_HeadVar2_5 = (MR_Word) mercury__dir__HeadVar__3_3;

    {
      mercury__builtin____Compare____c_pointer_0_0(mercury__dir__HeadVar__1_1, mercury__dir__Cast_HeadVar1_4, mercury__dir__Cast_HeadVar2_5);
    }
  }
}

MR_bool MR_CALL 
mercury__dir____Unify____stream_0_0(
  MR_Box mercury__dir__HeadVar__1_1,
  MR_Box mercury__dir__HeadVar__2_2)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__Cast_HeadVar1_3 = (MR_Word) mercury__dir__HeadVar__1_1;
    MR_Word mercury__dir__Cast_HeadVar2_4 = (MR_Word) mercury__dir__HeadVar__2_2;

    {
      mercury__dir__succeeded = mercury__builtin____Unify____c_pointer_0_0(mercury__dir__Cast_HeadVar1_3, mercury__dir__Cast_HeadVar2_4);
    }
    return mercury__dir__succeeded;
  }
}

void MR_CALL 
mercury__dir____Compare____foldl_pred_1_0(
  MR_Word mercury__dir__TypeInfo_for_T_6,
  MR_Word * mercury__dir__HeadVar__1_1,
  MR_Word mercury__dir__HeadVar__2_2,
  MR_Word mercury__dir__HeadVar__3_3)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__Cast_HeadVar1_4 = mercury__dir__HeadVar__2_2;
    MR_Word mercury__dir__Cast_HeadVar2_5 = mercury__dir__HeadVar__3_3;

    {
      mercury__private_builtin__builtin_compare_pred_3_p_0(mercury__dir__HeadVar__1_1, (MR_Word) mercury__dir__Cast_HeadVar1_4, (MR_Word) mercury__dir__Cast_HeadVar2_5);
    }
  }
}

MR_bool MR_CALL 
mercury__dir____Unify____foldl_pred_1_0(
  MR_Word mercury__dir__TypeInfo_for_T_5,
  MR_Word mercury__dir__HeadVar__1_1,
  MR_Word mercury__dir__HeadVar__2_2)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__Cast_HeadVar1_3 = mercury__dir__HeadVar__1_1;
    MR_Word mercury__dir__Cast_HeadVar2_4 = mercury__dir__HeadVar__2_2;

    {
      mercury__dir__succeeded = mercury__private_builtin__builtin_unify_pred_2_p_0((MR_Word) mercury__dir__Cast_HeadVar1_3, (MR_Word) mercury__dir__Cast_HeadVar2_4);
    }
    return mercury__dir__succeeded;
  }
}

static void MR_CALL 
mercury__dir__find_matching_brace_or_comma_6_p_0(
  MR_Word mercury__dir__HeadVar__1_1,
  MR_Word mercury__dir__Alternatives0_2,
  MR_Word mercury__dir__CurAlternative_3,
  MR_Integer mercury__dir__BraceLevel_4,
  MR_Word * mercury__dir__Alternatives_5,
  MR_Word * mercury__dir__Left_6)
{
  while (MR_TRUE)
    {
      /* tailcall optimized into a loop */
      {
        MR_bool mercury__dir__succeeded;

        if ((mercury__dir__HeadVar__1_1 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
          {
            MR_Word mercury__dir__TypeCtorInfo_42_42 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_string_0;

            {
              mercury__exception__throw_1_p_0(mercury__dir__TypeCtorInfo_42_42, ((MR_Box) ((MR_String) "no matching brace")));
              return;
            }
          }
        else
          {
            MR_Char mercury__dir__Char_13 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__1_1, (MR_Integer) 0)));
            MR_Word mercury__dir__Chars_14 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__1_1, (MR_Integer) 1)));

            mercury__dir__succeeded = (mercury__dir__Char_13 == (MR_Char) 125);
            if (mercury__dir__succeeded)
              {
                mercury__dir__succeeded = (mercury__dir__BraceLevel_4 == (MR_Integer) 0);
                if (mercury__dir__succeeded)
                  {
                    MR_Word mercury__dir__TypeInfo_43_43;
                    MR_Word mercury__dir__V_21_21;
                    MR_Word mercury__dir__V_22_22 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));

                    {
                      mercury__dir__V_21_21 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                      MR_hl_field(MR_mktag(1), mercury__dir__V_21_21, 0) = ((MR_Box) (mercury__dir__CurAlternative_3));
                      MR_hl_field(MR_mktag(1), mercury__dir__V_21_21, 1) = ((MR_Box) (mercury__dir__V_22_22));
                    }
                    mercury__dir__TypeInfo_43_43 = (MR_Word) &mercury__dir_scalar_common_1[0];
                    {
                      mercury__list__append_3_p_1(mercury__dir__TypeInfo_43_43, mercury__dir__Alternatives0_2, mercury__dir__V_21_21, mercury__dir__Alternatives_5);
                    }
                    *mercury__dir__Left_6 = mercury__dir__Chars_14;
                  }
                else
                  {
                    MR_Word mercury__dir__TypeCtorInfo_44_44 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_character_0;
                    MR_Word mercury__dir__V_23_23;
                    MR_Integer mercury__dir__V_24_24;
                    MR_Word mercury__dir__V_25_25;
                    MR_Word mercury__dir__V_26_26 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));

                    {
                      mercury__dir__V_25_25 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                      MR_hl_field(MR_mktag(1), mercury__dir__V_25_25, 0) = ((MR_Box) (MR_Word) (mercury__dir__Char_13));
                      MR_hl_field(MR_mktag(1), mercury__dir__V_25_25, 1) = ((MR_Box) (mercury__dir__V_26_26));
                    }
                    {
                      mercury__list__append_3_p_1(mercury__dir__TypeCtorInfo_44_44, mercury__dir__CurAlternative_3, mercury__dir__V_25_25, &mercury__dir__V_23_23);
                    }
                    mercury__dir__V_24_24 = (mercury__dir__BraceLevel_4 - (MR_Integer) 1);
                    /* direct tailcall eliminated */
                    {
                      MR_Word mercury__dir__HeadVar__1__tmp_copy_1 = mercury__dir__Chars_14;
                      MR_Word mercury__dir__CurAlternative__tmp_copy_3 = mercury__dir__V_23_23;
                      MR_Integer mercury__dir__BraceLevel__tmp_copy_4 = mercury__dir__V_24_24;

                      mercury__dir__BraceLevel_4 = mercury__dir__BraceLevel__tmp_copy_4;
                      mercury__dir__CurAlternative_3 = mercury__dir__CurAlternative__tmp_copy_3;
                      mercury__dir__HeadVar__1_1 = mercury__dir__HeadVar__1__tmp_copy_1;
                    }
                    continue;
                  }
              }
            else
              {
                mercury__dir__succeeded = (mercury__dir__Char_13 == (MR_Char) 123);
                if (mercury__dir__succeeded)
                  {
                    MR_Word mercury__dir__TypeCtorInfo_45_45 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_character_0;
                    MR_Word mercury__dir__V_28_28;
                    MR_Integer mercury__dir__V_29_29;
                    MR_Word mercury__dir__V_30_30;
                    MR_Word mercury__dir__V_31_31 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));

                    {
                      mercury__dir__V_30_30 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                      MR_hl_field(MR_mktag(1), mercury__dir__V_30_30, 0) = ((MR_Box) (MR_Word) (mercury__dir__Char_13));
                      MR_hl_field(MR_mktag(1), mercury__dir__V_30_30, 1) = ((MR_Box) (mercury__dir__V_31_31));
                    }
                    {
                      mercury__list__append_3_p_1(mercury__dir__TypeCtorInfo_45_45, mercury__dir__CurAlternative_3, mercury__dir__V_30_30, &mercury__dir__V_28_28);
                    }
                    mercury__dir__V_29_29 = (mercury__dir__BraceLevel_4 + (MR_Integer) 1);
                    /* direct tailcall eliminated */
                    {
                      MR_Word mercury__dir__HeadVar__1__tmp_copy_1 = mercury__dir__Chars_14;
                      MR_Word mercury__dir__CurAlternative__tmp_copy_3 = mercury__dir__V_28_28;
                      MR_Integer mercury__dir__BraceLevel__tmp_copy_4 = mercury__dir__V_29_29;

                      mercury__dir__BraceLevel_4 = mercury__dir__BraceLevel__tmp_copy_4;
                      mercury__dir__CurAlternative_3 = mercury__dir__CurAlternative__tmp_copy_3;
                      mercury__dir__HeadVar__1_1 = mercury__dir__HeadVar__1__tmp_copy_1;
                    }
                    continue;
                  }
                else
                  {
                    mercury__dir__succeeded = (mercury__dir__Char_13 == (MR_Char) 44);
                    if (mercury__dir__succeeded)
                      {
                        mercury__dir__succeeded = (mercury__dir__BraceLevel_4 == (MR_Integer) 0);
                        if (mercury__dir__succeeded)
                          {
                            MR_Word mercury__dir__TypeInfo_46_46;
                            MR_Word mercury__dir__Alternatives1_20;
                            MR_Word mercury__dir__V_33_33;
                            MR_Word mercury__dir__V_34_34 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
                            MR_Word mercury__dir__V_35_35;

                            {
                              mercury__dir__V_33_33 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                              MR_hl_field(MR_mktag(1), mercury__dir__V_33_33, 0) = ((MR_Box) (mercury__dir__CurAlternative_3));
                              MR_hl_field(MR_mktag(1), mercury__dir__V_33_33, 1) = ((MR_Box) (mercury__dir__V_34_34));
                            }
                            mercury__dir__TypeInfo_46_46 = (MR_Word) &mercury__dir_scalar_common_1[0];
                            {
                              mercury__list__append_3_p_1(mercury__dir__TypeInfo_46_46, mercury__dir__Alternatives0_2, mercury__dir__V_33_33, &mercury__dir__Alternatives1_20);
                            }
                            mercury__dir__V_35_35 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
                            /* direct tailcall eliminated */
                            {
                              MR_Word mercury__dir__HeadVar__1__tmp_copy_1 = mercury__dir__Chars_14;
                              MR_Word mercury__dir__Alternatives0__tmp_copy_2 = mercury__dir__Alternatives1_20;
                              MR_Word mercury__dir__CurAlternative__tmp_copy_3 = mercury__dir__V_35_35;

                              mercury__dir__CurAlternative_3 = mercury__dir__CurAlternative__tmp_copy_3;
                              mercury__dir__Alternatives0_2 = mercury__dir__Alternatives0__tmp_copy_2;
                              mercury__dir__HeadVar__1_1 = mercury__dir__HeadVar__1__tmp_copy_1;
                            }
                            continue;
                          }
                        else
                          {
                            MR_Word mercury__dir__TypeCtorInfo_47_47 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_character_0;
                            MR_Word mercury__dir__V_36_36;
                            MR_Word mercury__dir__V_37_37;
                            MR_Word mercury__dir__V_38_38 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));

                            {
                              mercury__dir__V_37_37 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                              MR_hl_field(MR_mktag(1), mercury__dir__V_37_37, 0) = ((MR_Box) (MR_Word) (mercury__dir__Char_13));
                              MR_hl_field(MR_mktag(1), mercury__dir__V_37_37, 1) = ((MR_Box) (mercury__dir__V_38_38));
                            }
                            {
                              mercury__list__append_3_p_1(mercury__dir__TypeCtorInfo_47_47, mercury__dir__CurAlternative_3, mercury__dir__V_37_37, &mercury__dir__V_36_36);
                            }
                            /* direct tailcall eliminated */
                            {
                              MR_Word mercury__dir__HeadVar__1__tmp_copy_1 = mercury__dir__Chars_14;
                              MR_Word mercury__dir__CurAlternative__tmp_copy_3 = mercury__dir__V_36_36;

                              mercury__dir__CurAlternative_3 = mercury__dir__CurAlternative__tmp_copy_3;
                              mercury__dir__HeadVar__1_1 = mercury__dir__HeadVar__1__tmp_copy_1;
                            }
                            continue;
                          }
                      }
                    else
                      {
                        MR_Word mercury__dir__TypeCtorInfo_48_48 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_character_0;
                        MR_Word mercury__dir__V_39_39;
                        MR_Word mercury__dir__V_40_40;
                        MR_Word mercury__dir__V_41_41 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));

                        {
                          mercury__dir__V_40_40 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                          MR_hl_field(MR_mktag(1), mercury__dir__V_40_40, 0) = ((MR_Box) (MR_Word) (mercury__dir__Char_13));
                          MR_hl_field(MR_mktag(1), mercury__dir__V_40_40, 1) = ((MR_Box) (mercury__dir__V_41_41));
                        }
                        {
                          mercury__list__append_3_p_1(mercury__dir__TypeCtorInfo_48_48, mercury__dir__CurAlternative_3, mercury__dir__V_40_40, &mercury__dir__V_39_39);
                        }
                        /* direct tailcall eliminated */
                        {
                          MR_Word mercury__dir__HeadVar__1__tmp_copy_1 = mercury__dir__Chars_14;
                          MR_Word mercury__dir__CurAlternative__tmp_copy_3 = mercury__dir__V_39_39;

                          mercury__dir__CurAlternative_3 = mercury__dir__CurAlternative__tmp_copy_3;
                          mercury__dir__HeadVar__1_1 = mercury__dir__HeadVar__1__tmp_copy_1;
                        }
                        continue;
                      }
                  }
              }
          }
      }
      break;
    }
}

MR_Word MR_CALL 
mercury__dir__expand_acc_2_f_0(
  MR_Word mercury__dir__HeadVar__1_1,
  MR_Word mercury__dir__HeadVar__2_2)
{
  while (MR_TRUE)
    {
      /* tailcall optimized into a loop */
      {
        MR_bool mercury__dir__succeeded;
        MR_Word mercury__dir__HeadVar__3_3;

        if ((mercury__dir__HeadVar__1_1 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
          mercury__dir__HeadVar__3_3 = mercury__dir__HeadVar__2_2;
        else
          {
            MR_Char mercury__dir__Char_5 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__1_1, (MR_Integer) 0)));
            MR_Word mercury__dir__Chars_6 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__1_1, (MR_Integer) 1)));

            mercury__dir__succeeded = (mercury__dir__Char_5 == (MR_Char) 123);
            if (mercury__dir__succeeded)
              {
                MR_Word mercury__dir__TypeInfo_19_19;
                MR_Word mercury__dir__TypeCtorInfo_9_41;
                MR_Word mercury__dir__TypeInfo_10_51;
                MR_Word mercury__dir__Alternatives0_9;
                MR_Word mercury__dir__Left_10;
                MR_Word mercury__dir__AlternativeLists_11;
                MR_Word mercury__dir__Alternatives_12;
                MR_Word mercury__dir__PrefixLists_13;
                MR_Word mercury__dir__Prefixes1_14;
                MR_Word mercury__dir__V_31_31 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
                MR_Word mercury__dir__V_32_32 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
                MR_Word mercury__dir__V_5_38;
                MR_Word mercury__dir__V_6_39;
                MR_Word mercury__dir__V_5_47;
                MR_Word mercury__dir__V_6_48;

                {
                  mercury__dir__find_matching_brace_or_comma_6_p_0(mercury__dir__Chars_6, mercury__dir__V_31_31, mercury__dir__V_32_32, (MR_Integer) 0, &mercury__dir__Alternatives0_9, &mercury__dir__Left_10);
                }
                mercury__dir__TypeInfo_19_19 = (MR_Word) &mercury__dir_scalar_common_1[0];
                {
                  mercury__dir__AlternativeLists_11 = mercury__dir__map__ho4_2_f_in__list_0(mercury__dir__Alternatives0_9);
                }
                mercury__dir__TypeCtorInfo_9_41 = (MR_Word) &mercury__list__list__type_ctor_info_list_1;
                mercury__dir__TypeInfo_10_51 = (MR_Word) &mercury__dir_scalar_common_1[7];
                {
                  mercury__list__reverse_2_p_0(mercury__dir__TypeInfo_10_51, mercury__dir__AlternativeLists_11, &mercury__dir__V_5_38);
                }
                mercury__dir__V_6_39 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
                {
                  mercury__list__condense_acc_3_p_0(mercury__dir__TypeInfo_19_19, mercury__dir__V_5_38, mercury__dir__V_6_39, &mercury__dir__Alternatives_12);
                }
                {
                  mercury__dir__PrefixLists_13 = mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_109_97_112_95_95_104_111_51_95_95_91_50_93_95_48_2_f_in__list_0(mercury__dir__Alternatives_12, mercury__dir__HeadVar__2_2);
                }
                {
                  mercury__list__reverse_2_p_0(mercury__dir__TypeInfo_10_51, mercury__dir__PrefixLists_13, &mercury__dir__V_5_47);
                }
                mercury__dir__V_6_48 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
                {
                  mercury__list__condense_acc_3_p_0(mercury__dir__TypeInfo_19_19, mercury__dir__V_5_47, mercury__dir__V_6_48, &mercury__dir__Prefixes1_14);
                }
                /* direct tailcall eliminated */
                {
                  MR_Word mercury__dir__HeadVar__1__tmp_copy_1 = mercury__dir__Left_10;
                  MR_Word mercury__dir__HeadVar__2__tmp_copy_2 = mercury__dir__Prefixes1_14;

                  mercury__dir__HeadVar__2_2 = mercury__dir__HeadVar__2__tmp_copy_2;
                  mercury__dir__HeadVar__1_1 = mercury__dir__HeadVar__1__tmp_copy_1;
                }
                continue;
              }
            else
              {
                MR_Word mercury__dir__Prefixes1_18;

                {
                  mercury__dir__Prefixes1_18 = mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_109_97_112_95_95_104_111_50_95_95_91_50_93_95_48_2_f_in__list_0(mercury__dir__Char_5, mercury__dir__HeadVar__2_2);
                }
                /* direct tailcall eliminated */
                {
                  MR_Word mercury__dir__HeadVar__1__tmp_copy_1 = mercury__dir__Chars_6;
                  MR_Word mercury__dir__HeadVar__2__tmp_copy_2 = mercury__dir__Prefixes1_18;

                  mercury__dir__HeadVar__2_2 = mercury__dir__HeadVar__2__tmp_copy_2;
                  mercury__dir__HeadVar__1_1 = mercury__dir__HeadVar__1__tmp_copy_1;
                }
                continue;
              }
          }
        return mercury__dir__HeadVar__3_3;
      }
      break;
    }
}

MR_Word MR_CALL 
mercury__dir__expand_1_f_0(
  MR_Word mercury__dir__Chars_3)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__HeadVar__2_2;
    MR_Word mercury__dir__V_4_4 = (MR_Word) MR_mkword(MR_mktag(1), &mercury__dir_scalar_common_1[5]);
    MR_Word mercury__dir__V_5_5 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
    MR_Word mercury__dir__V_6_6 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));

    {
      mercury__dir__HeadVar__2_2 = mercury__dir__expand_acc_2_f_0(mercury__dir__Chars_3, mercury__dir__V_4_4);
    }
    return mercury__dir__HeadVar__2_2;
  }
}

static void MR_CALL 
mercury__dir__read_entry_2_7_p_0(
  MR_Box mercury__dir__Dir0_1,
  MR_Box * mercury__dir__Dir_2,
  MR_Integer * mercury__dir__Status_3,
  MR_Box * mercury__dir__Error_4,
  MR_String * mercury__dir__FileName_5)
{
  {
    MR_bool mercury__dir__succeeded;

{
#define MR_PROC_LABEL mercury__dir__read_entry_2_7_p_0

	ML_DIR_STREAM Dir0;
	ML_DIR_STREAM Dir;
	MR_Integer Status;
	MR_Integer Error;
	MR_String FileName;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(ML_DIR_STREAM, mercury__dir__Dir0_1 , Dir0);
		{

#if defined(MR_WIN32)
    WIN32_FIND_DATAW file_data;

    Dir = Dir0;
    if (FindNextFileW(Dir, &file_data)) {
        Status = 1;
        FileName = ML_wide_to_utf8(file_data.cFileName, MR_ALLOC_ID);
    } else {
        Error = GetLastError();
        Status = (Error == ERROR_NO_MORE_FILES ? -1 : 0);
        FileName = NULL;
    }

#elif defined(MR_HAVE_READDIR) && defined(MR_HAVE_CLOSEDIR)
    struct dirent *dir_entry;

    Dir = Dir0;
    errno = 0;
    dir_entry = readdir(Dir);
    if (dir_entry == NULL) {
        Error = errno;
        FileName = NULL;
        Status = (Error == 0 ? -1 : 0);
    } else {
        MR_make_aligned_string_copy_msg(FileName, dir_entry->d_name,
            MR_ALLOC_ID);
        Error = 0;
        Status = 1;
    }

#else /* !MR_WIN32 && !(MR_HAVE_READDIR etc.) */
    MR_fatal_error("dir.read_entry_2 called but not supported");
#endif


		;}
#undef MR_PROC_LABEL
	MR_MAYBE_BOX_FOREIGN_TYPE(ML_DIR_STREAM, Dir, *mercury__dir__Dir_2 );
	 *mercury__dir__Status_3  = Status;
	MR_MAYBE_BOX_FOREIGN_TYPE(MR_Integer, Error, *mercury__dir__Error_4 );
	 *mercury__dir__FileName_5  = FileName;
}
  }
}

static void MR_CALL 
mercury__dir__read_entry_4_p_0(
  MR_Box mercury__dir__Dir0_5,
  MR_Word * mercury__dir__Res_6)
{
  while (MR_TRUE)
    {
      /* tailcall optimized into a loop */
      {
        MR_bool mercury__dir__succeeded;
        MR_Box mercury__dir__Dir_8;
        MR_Integer mercury__dir__Status_9;
        MR_Box mercury__dir__Error_10;
        MR_String mercury__dir__FileName_11;

{
#define MR_PROC_LABEL mercury__dir__read_entry_4_p_0

	ML_DIR_STREAM Dir0;
	ML_DIR_STREAM Dir;
	MR_Integer Status;
	MR_Integer Error;
	MR_String FileName;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(ML_DIR_STREAM, mercury__dir__Dir0_5 , Dir0);
		{

#if defined(MR_WIN32)
    WIN32_FIND_DATAW file_data;

    Dir = Dir0;
    if (FindNextFileW(Dir, &file_data)) {
        Status = 1;
        FileName = ML_wide_to_utf8(file_data.cFileName, MR_ALLOC_ID);
    } else {
        Error = GetLastError();
        Status = (Error == ERROR_NO_MORE_FILES ? -1 : 0);
        FileName = NULL;
    }

#elif defined(MR_HAVE_READDIR) && defined(MR_HAVE_CLOSEDIR)
    struct dirent *dir_entry;

    Dir = Dir0;
    errno = 0;
    dir_entry = readdir(Dir);
    if (dir_entry == NULL) {
        Error = errno;
        FileName = NULL;
        Status = (Error == 0 ? -1 : 0);
    } else {
        MR_make_aligned_string_copy_msg(FileName, dir_entry->d_name,
            MR_ALLOC_ID);
        Error = 0;
        Status = 1;
    }

#else /* !MR_WIN32 && !(MR_HAVE_READDIR etc.) */
    MR_fatal_error("dir.read_entry_2 called but not supported");
#endif


		;}
#undef MR_PROC_LABEL
	MR_MAYBE_BOX_FOREIGN_TYPE(ML_DIR_STREAM, Dir, mercury__dir__Dir_8 );
	 mercury__dir__Status_9  = Status;
	MR_MAYBE_BOX_FOREIGN_TYPE(MR_Integer, Error, mercury__dir__Error_10 );
	 mercury__dir__FileName_11  = FileName;
}
        mercury__dir__succeeded = (mercury__dir__Status_9 == (MR_Integer) 0);
        if (mercury__dir__succeeded)
          {
            MR_String mercury__dir__Msg_12;
            MR_Word mercury__dir__V_18_18;

{
#define MR_PROC_LABEL mercury__dir__read_entry_4_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
            if (mercury__dir__succeeded)
              {
{
#define MR_PROC_LABEL mercury__dir__read_entry_4_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_10 , Error);
	Msg0 =  (MR_String) "dir.foldl2: reading directory entry failed: " ;
		{

    ML_maybe_make_win32_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_12  = Msg;
}
              }
            else
              {
{
#define MR_PROC_LABEL mercury__dir__read_entry_4_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_10 , Error);
	Msg0 =  (MR_String) "dir.foldl2: reading directory entry failed: " ;
		{

    ML_maybe_make_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_12  = Msg;
}
              }
            mercury__dir__V_18_18 = (MR_Word) mercury__dir__Msg_12;
            {
              MR_Word base;
              base = (MR_Word) MR_mkword(MR_mktag(2), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
              *mercury__dir__Res_6 = base;
              MR_hl_field(MR_mktag(2), base, 0) = ((MR_Box) (mercury__dir__V_18_18));
            }
          }
        else
          {
            mercury__dir__succeeded = (mercury__dir__Status_9 == (MR_Integer) -1);
            if (mercury__dir__succeeded)
              *mercury__dir__Res_6 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
            else
              {
                mercury__dir__succeeded = (strcmp(mercury__dir__FileName_11, (MR_String) ".") == 0);
                if (!(mercury__dir__succeeded))
                  {
                    mercury__dir__succeeded = (strcmp(mercury__dir__FileName_11, (MR_String) "..") == 0);
                  }
                if (mercury__dir__succeeded)
                  {
                    /* direct tailcall eliminated */
                    continue;
                  }
                else
                  {
                    MR_Tuple mercury__dir__V_20_20;

                    {
                      mercury__dir__V_20_20 = (MR_Tuple) MR_new_object(MR_Tuple, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL);
                      MR_hl_field(MR_mktag(0), mercury__dir__V_20_20, 0) = ((MR_Box) (mercury__dir__Dir_8));
                      MR_hl_field(MR_mktag(0), mercury__dir__V_20_20, 1) = ((MR_Box) (mercury__dir__FileName_11));
                    }
                    {
                      MR_Word base;
                      base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
                      *mercury__dir__Res_6 = base;
                      MR_hl_field(MR_mktag(1), base, 0) = ((MR_Box) (mercury__dir__V_20_20));
                    }
                  }
              }
          }
      }
      break;
    }
}

static void MR_CALL 
mercury__dir__close_2_5_p_0(
  MR_Box mercury__dir__Dir_1,
  MR_Integer * mercury__dir__Status_2,
  MR_Box * mercury__dir__Error_3)
{
  {
    MR_bool mercury__dir__succeeded;

{
#define MR_PROC_LABEL mercury__dir__close_2_5_p_0

	ML_DIR_STREAM Dir;
	MR_Integer Status;
	MR_Integer Error;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(ML_DIR_STREAM, mercury__dir__Dir_1 , Dir);
		{

#if defined(MR_WIN32)
    Status = FindClose(Dir);
    Error = GetLastError();
#elif defined(MR_HAVE_CLOSEDIR)
    Status = (closedir(Dir) == 0);
    Error = errno;
#else
    MR_fatal_error("dir.open called but not supported");
#endif


		;}
#undef MR_PROC_LABEL
	 *mercury__dir__Status_2  = Status;
	MR_MAYBE_BOX_FOREIGN_TYPE(MR_Integer, Error, *mercury__dir__Error_3 );
}
  }
}

static void MR_CALL 
mercury__dir__close_4_p_0(
  MR_Box mercury__dir__Dir_5,
  MR_Word * mercury__dir__Res_6)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Integer mercury__dir__Status_8;
    MR_Box mercury__dir__Error_9;

{
#define MR_PROC_LABEL mercury__dir__close_4_p_0

	ML_DIR_STREAM Dir;
	MR_Integer Status;
	MR_Integer Error;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(ML_DIR_STREAM, mercury__dir__Dir_5 , Dir);
		{

#if defined(MR_WIN32)
    Status = FindClose(Dir);
    Error = GetLastError();
#elif defined(MR_HAVE_CLOSEDIR)
    Status = (closedir(Dir) == 0);
    Error = errno;
#else
    MR_fatal_error("dir.open called but not supported");
#endif


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Status_8  = Status;
	MR_MAYBE_BOX_FOREIGN_TYPE(MR_Integer, Error, mercury__dir__Error_9 );
}
    mercury__dir__succeeded = (mercury__dir__Status_8 == (MR_Integer) 0);
    if (mercury__dir__succeeded)
      {
        MR_String mercury__dir__Msg_10;
        MR_Word mercury__dir__V_16_16;

{
#define MR_PROC_LABEL mercury__dir__close_4_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
        if (mercury__dir__succeeded)
          {
{
#define MR_PROC_LABEL mercury__dir__close_4_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_9 , Error);
	Msg0 =  (MR_String) "dir.foldl2: closing directory failed: " ;
		{

    ML_maybe_make_win32_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_10  = Msg;
}
          }
        else
          {
{
#define MR_PROC_LABEL mercury__dir__close_4_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_9 , Error);
	Msg0 =  (MR_String) "dir.foldl2: closing directory failed: " ;
		{

    ML_maybe_make_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_10  = Msg;
}
          }
        mercury__dir__V_16_16 = (MR_Word) mercury__dir__Msg_10;
        {
          MR_Word base;
          base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
          *mercury__dir__Res_6 = base;
          MR_hl_field(MR_mktag(1), base, 0) = ((MR_Box) (mercury__dir__V_16_16));
        }
      }
    else
      *mercury__dir__Res_6 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
  }
}

static void MR_CALL 
mercury__dir__make_dir_open_result_error_4_p_0(
  MR_Box mercury__dir__Error_5,
  MR_Word * mercury__dir__HeadVar__2_2)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_String mercury__dir__Msg_6;
    MR_Word mercury__dir__V_10_10;

{
#define MR_PROC_LABEL mercury__dir__make_dir_open_result_error_4_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_5 , Error);
	Msg0 =  (MR_String) "dir.foldl2: opening directory failed: " ;
		{

    ML_maybe_make_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_6  = Msg;
}
    mercury__dir__V_10_10 = (MR_Word) mercury__dir__Msg_6;
    {
      MR_Word base;
      base = (MR_Word) MR_mkword(MR_mktag(2), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
      *mercury__dir__HeadVar__2_2 = base;
      MR_hl_field(MR_mktag(2), base, 0) = ((MR_Box) (mercury__dir__V_10_10));
    }
  }
}

static MR_Word MR_CALL 
mercury__dir__make_dir_open_result_eof_0_f_0(void)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__HeadVar__1_1 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));

    return mercury__dir__HeadVar__1_1;
  }
}

static void MR_CALL 
mercury__dir__make_win32_dir_open_result_ok_5_p_0(
  MR_Box mercury__dir__Dir_6,
  MR_String mercury__dir__FirstFile0_7,
  MR_Word * mercury__dir__Result_8)
{
  {
    MR_bool mercury__dir__succeeded;

    mercury__dir__succeeded = (strcmp(mercury__dir__FirstFile0_7, (MR_String) ".") == 0);
    if (!(mercury__dir__succeeded))
      {
        mercury__dir__succeeded = (strcmp(mercury__dir__FirstFile0_7, (MR_String) "..") == 0);
      }
    if (mercury__dir__succeeded)
      {
        MR_Word mercury__dir__ReadResult_10;

        {
          mercury__dir__read_entry_4_p_0(mercury__dir__Dir_6, &mercury__dir__ReadResult_10);
        }
        switch (MR_tag((MR_Word) mercury__dir__ReadResult_10)) {
          default: /*NOTREACHED*/ MR_assert(0);
          case (MR_Integer) 0:
            {
              MR_Word mercury__dir__CloseRes_12;
              MR_Integer mercury__dir__Status_29;
              MR_Box mercury__dir__Error_30;

{
#define MR_PROC_LABEL mercury__dir__make_win32_dir_open_result_ok_5_p_0

	ML_DIR_STREAM Dir;
	MR_Integer Status;
	MR_Integer Error;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(ML_DIR_STREAM, mercury__dir__Dir_6 , Dir);
		{

#if defined(MR_WIN32)
    Status = FindClose(Dir);
    Error = GetLastError();
#elif defined(MR_HAVE_CLOSEDIR)
    Status = (closedir(Dir) == 0);
    Error = errno;
#else
    MR_fatal_error("dir.open called but not supported");
#endif


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Status_29  = Status;
	MR_MAYBE_BOX_FOREIGN_TYPE(MR_Integer, Error, mercury__dir__Error_30 );
}
              mercury__dir__succeeded = (mercury__dir__Status_29 == (MR_Integer) 0);
              if (mercury__dir__succeeded)
                {
                  MR_String mercury__dir__Msg_31;
                  MR_Word mercury__dir__V_35_35;

{
#define MR_PROC_LABEL mercury__dir__make_win32_dir_open_result_ok_5_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
                  if (mercury__dir__succeeded)
                    {
{
#define MR_PROC_LABEL mercury__dir__make_win32_dir_open_result_ok_5_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_30 , Error);
	Msg0 =  (MR_String) "dir.foldl2: closing directory failed: " ;
		{

    ML_maybe_make_win32_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_31  = Msg;
}
                    }
                  else
                    {
{
#define MR_PROC_LABEL mercury__dir__make_win32_dir_open_result_ok_5_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_30 , Error);
	Msg0 =  (MR_String) "dir.foldl2: closing directory failed: " ;
		{

    ML_maybe_make_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_31  = Msg;
}
                    }
                  mercury__dir__V_35_35 = (MR_Word) mercury__dir__Msg_31;
                  {
                    mercury__dir__CloseRes_12 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
                    MR_hl_field(MR_mktag(1), mercury__dir__CloseRes_12, 0) = ((MR_Box) (mercury__dir__V_35_35));
                  }
                }
              else
                mercury__dir__CloseRes_12 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
              if ((mercury__dir__CloseRes_12 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
                *mercury__dir__Result_8 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
              else
                {
                  MR_Word mercury__dir__Error_13 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__CloseRes_12, (MR_Integer) 0)));

                  {
                    MR_Word base;
                    base = (MR_Word) MR_mkword(MR_mktag(2), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
                    *mercury__dir__Result_8 = base;
                    MR_hl_field(MR_mktag(2), base, 0) = ((MR_Box) (mercury__dir__Error_13));
                  }
                }
            }
            break;
          case (MR_Integer) 1:
            *mercury__dir__Result_8 = mercury__dir__ReadResult_10;
            break;
          case (MR_Integer) 2:
            {
              MR_Integer mercury__dir__Status_47;
              MR_Box mercury__dir__Error_48;

{
#define MR_PROC_LABEL mercury__dir__make_win32_dir_open_result_ok_5_p_0

	ML_DIR_STREAM Dir;
	MR_Integer Status;
	MR_Integer Error;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(ML_DIR_STREAM, mercury__dir__Dir_6 , Dir);
		{

#if defined(MR_WIN32)
    Status = FindClose(Dir);
    Error = GetLastError();
#elif defined(MR_HAVE_CLOSEDIR)
    Status = (closedir(Dir) == 0);
    Error = errno;
#else
    MR_fatal_error("dir.open called but not supported");
#endif


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Status_47  = Status;
	MR_MAYBE_BOX_FOREIGN_TYPE(MR_Integer, Error, mercury__dir__Error_48 );
}
              mercury__dir__succeeded = (mercury__dir__Status_47 == (MR_Integer) 0);
              if (mercury__dir__succeeded)
                {
{
#define MR_PROC_LABEL mercury__dir__make_win32_dir_open_result_ok_5_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
                  if (mercury__dir__succeeded)
                    {
                      MR_String mercury__dir__Msg_49;

{
#define MR_PROC_LABEL mercury__dir__make_win32_dir_open_result_ok_5_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_48 , Error);
	Msg0 =  (MR_String) "dir.foldl2: closing directory failed: " ;
		{

    ML_maybe_make_win32_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_49  = Msg;
}
                    }
                  else
                    {
                      MR_String mercury__dir__Msg_62;

{
#define MR_PROC_LABEL mercury__dir__make_win32_dir_open_result_ok_5_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_48 , Error);
	Msg0 =  (MR_String) "dir.foldl2: closing directory failed: " ;
		{

    ML_maybe_make_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_62  = Msg;
}
                    }
                }
              else
                {
                }
              *mercury__dir__Result_8 = mercury__dir__ReadResult_10;
            }
            break;
        }
      }
    else
      {
        MR_Tuple mercury__dir__V_20_20;

        {
          mercury__dir__V_20_20 = (MR_Tuple) MR_new_object(MR_Tuple, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL);
          MR_hl_field(MR_mktag(0), mercury__dir__V_20_20, 0) = ((MR_Box) (mercury__dir__Dir_6));
          MR_hl_field(MR_mktag(0), mercury__dir__V_20_20, 1) = ((MR_Box) (mercury__dir__FirstFile0_7));
        }
        {
          MR_Word base;
          base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
          *mercury__dir__Result_8 = base;
          MR_hl_field(MR_mktag(1), base, 0) = ((MR_Box) (mercury__dir__V_20_20));
        }
      }
  }
}

static void MR_CALL 
mercury__dir__read_first_entry_4_p_0(
  MR_Box mercury__dir__Dir_5,
  MR_Word * mercury__dir__Result_6)
{
  {
    MR_bool mercury__dir__succeeded;

    {
      mercury__dir__read_entry_4_p_0(mercury__dir__Dir_5, mercury__dir__Result_6);
    }
    switch (MR_tag((MR_Word) *mercury__dir__Result_6)) {
      default: /*NOTREACHED*/ MR_assert(0);
      case (MR_Integer) 0:
        {
          MR_Integer mercury__dir__Status_20;
          MR_Box mercury__dir__Error_21;

{
#define MR_PROC_LABEL mercury__dir__read_first_entry_4_p_0

	ML_DIR_STREAM Dir;
	MR_Integer Status;
	MR_Integer Error;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(ML_DIR_STREAM, mercury__dir__Dir_5 , Dir);
		{

#if defined(MR_WIN32)
    Status = FindClose(Dir);
    Error = GetLastError();
#elif defined(MR_HAVE_CLOSEDIR)
    Status = (closedir(Dir) == 0);
    Error = errno;
#else
    MR_fatal_error("dir.open called but not supported");
#endif


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Status_20  = Status;
	MR_MAYBE_BOX_FOREIGN_TYPE(MR_Integer, Error, mercury__dir__Error_21 );
}
          mercury__dir__succeeded = (mercury__dir__Status_20 == (MR_Integer) 0);
          if (mercury__dir__succeeded)
            {
{
#define MR_PROC_LABEL mercury__dir__read_first_entry_4_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
              if (mercury__dir__succeeded)
                {
                  MR_String mercury__dir__Msg_22;

{
#define MR_PROC_LABEL mercury__dir__read_first_entry_4_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_21 , Error);
	Msg0 =  (MR_String) "dir.foldl2: closing directory failed: " ;
		{

    ML_maybe_make_win32_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_22  = Msg;
}
                }
              else
                {
                  MR_String mercury__dir__Msg_35;

{
#define MR_PROC_LABEL mercury__dir__read_first_entry_4_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_21 , Error);
	Msg0 =  (MR_String) "dir.foldl2: closing directory failed: " ;
		{

    ML_maybe_make_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_35  = Msg;
}
                }
            }
          else
            {
            }
        }
        break;
      case (MR_Integer) 1:
        {
        }
        break;
      case (MR_Integer) 2:
        {
          MR_Integer mercury__dir__Status_20;
          MR_Box mercury__dir__Error_21;

{
#define MR_PROC_LABEL mercury__dir__read_first_entry_4_p_0

	ML_DIR_STREAM Dir;
	MR_Integer Status;
	MR_Integer Error;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(ML_DIR_STREAM, mercury__dir__Dir_5 , Dir);
		{

#if defined(MR_WIN32)
    Status = FindClose(Dir);
    Error = GetLastError();
#elif defined(MR_HAVE_CLOSEDIR)
    Status = (closedir(Dir) == 0);
    Error = errno;
#else
    MR_fatal_error("dir.open called but not supported");
#endif


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Status_20  = Status;
	MR_MAYBE_BOX_FOREIGN_TYPE(MR_Integer, Error, mercury__dir__Error_21 );
}
          mercury__dir__succeeded = (mercury__dir__Status_20 == (MR_Integer) 0);
          if (mercury__dir__succeeded)
            {
{
#define MR_PROC_LABEL mercury__dir__read_first_entry_4_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
              if (mercury__dir__succeeded)
                {
                  MR_String mercury__dir__Msg_22;

{
#define MR_PROC_LABEL mercury__dir__read_first_entry_4_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_21 , Error);
	Msg0 =  (MR_String) "dir.foldl2: closing directory failed: " ;
		{

    ML_maybe_make_win32_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_22  = Msg;
}
                }
              else
                {
                  MR_String mercury__dir__Msg_35;

{
#define MR_PROC_LABEL mercury__dir__read_first_entry_4_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_21 , Error);
	Msg0 =  (MR_String) "dir.foldl2: closing directory failed: " ;
		{

    ML_maybe_make_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_35  = Msg;
}
                }
            }
          else
            {
            }
        }
        break;
    }
  }
}

static void MR_CALL 
mercury__dir__check_dir_readable_5_p_0(
  MR_String mercury__dir__DirName_6,
  MR_Integer * mercury__dir__IsReadable_7,
  MR_Word * mercury__dir__Result_8)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__FileTypeRes_10;

    {
      mercury__io__file_type_5_p_0((MR_Integer) 1, mercury__dir__DirName_6, &mercury__dir__FileTypeRes_10);
    }
    if (((MR_tag((MR_Word) mercury__dir__FileTypeRes_10)) == (MR_mktag((MR_Integer) 1))))
      {
        MR_Word mercury__dir__Msg_28 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileTypeRes_10, (MR_Integer) 0)));

        *mercury__dir__IsReadable_7 = (MR_Integer) 0;
        {
          MR_Word base;
          base = (MR_Word) MR_mkword(MR_mktag(2), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
          *mercury__dir__Result_8 = base;
          MR_hl_field(MR_mktag(2), base, 0) = ((MR_Box) (mercury__dir__Msg_28));
        }
      }
    else
      {
        MR_Word mercury__dir__FileType_11 = ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__FileTypeRes_10, (MR_Integer) 0)));

        switch (mercury__dir__FileType_11) {
          default: /*NOTREACHED*/ MR_assert(0);
          case (MR_Integer) 6:
          case (MR_Integer) 5:
          case (MR_Integer) 7:
          case (MR_Integer) 3:
          case (MR_Integer) 0:
          case (MR_Integer) 8:
          case (MR_Integer) 9:
          case (MR_Integer) 4:
          case (MR_Integer) 2:
          case (MR_Integer) 10:
            {
              MR_Word mercury__dir__V_18_18;

              *mercury__dir__IsReadable_7 = (MR_Integer) 0;
              mercury__dir__V_18_18 = (MR_Word) ((MR_Box) ((MR_String) "dir.foldl2: pathname is not a directory"));
              *mercury__dir__Result_8 = (MR_Word) MR_mkword(MR_mktag(2), &mercury__dir_scalar_common_5[3]);
            }
            break;
          case (MR_Integer) 1:
            {
              MR_Word mercury__dir__AccessResult_12;
              MR_Word mercury__dir__V_20_20 = (MR_Word) MR_mkword(MR_mktag(1), &mercury__dir_scalar_common_1[4]);

{
#define MR_PROC_LABEL mercury__dir__check_dir_readable_5_p_0

	MR_bool SUCCESS_INDICATOR;

		{

    SUCCESS_INDICATOR = MR_FALSE;


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
              if (mercury__dir__succeeded)
                {
                  mercury__io__check_file_accessibility_dotnet_5_p_0(mercury__dir__DirName_6, mercury__dir__V_20_20, &mercury__dir__AccessResult_12);
                }
              else
                {
{
#define MR_PROC_LABEL mercury__dir__check_dir_readable_5_p_0

	MR_String FileName;
	MR_Word AccessTypes;
	MR_Word Result;

	FileName =  mercury__dir__DirName_6 ;
	AccessTypes =  mercury__dir__V_20_20 ;
		{

#if defined(MR_HAVE_ACCESS)
  #ifdef F_OK
    int mode = F_OK;
  #else
    int mode = 0;
  #endif
    int access_result;

  #if !defined(MR_WIN32) || defined(MR_CYGWIN)
    /*
    ** Earlier versions of MSVCRT ignored flags it doesn't support,
    ** later versions return an error (e.g. on Vista).
    */
    if (ML_access_types_includes_execute(AccessTypes)) {
      #ifdef X_OK
        mode |= X_OK;
      #else
        mode |= 1;
      #endif
    }
  #endif
    if (ML_access_types_includes_write(AccessTypes)) {
  #ifdef W_OK
        mode |= W_OK;
  #else
        mode |= 2;
  #endif
    }
    if (ML_access_types_includes_read(AccessTypes)) {
  #ifdef R_OK
        mode |= R_OK;
  #else
        mode |= 4;
  #endif
    }

  #ifdef MR_WIN32
    access_result = _waccess(ML_utf8_to_wide(FileName), mode);
  #else
    access_result = access(FileName, mode);
  #endif

    if (access_result == 0) {
        Result = ML_make_io_res_0_ok();
    } else {
        ML_make_io_res_0_error(errno,
            MR_make_string_const("file not accessible: "), &Result);
    }
#else /* !MR_HAVE_ACCESS */
    Result = ML_make_io_res_0_error_msg(
        "io.check_file_accessibility not supported on this platform");
#endif


		;}
#undef MR_PROC_LABEL
	 mercury__dir__AccessResult_12  = Result;
}
                }
              if ((mercury__dir__AccessResult_12 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
                {
                  MR_Word mercury__dir__V_26_26;

                  *mercury__dir__IsReadable_7 = (MR_Integer) 1;
                  mercury__dir__V_26_26 = (MR_Word) ((MR_Box) ((MR_String) "no error"));
                  *mercury__dir__Result_8 = (MR_Word) MR_mkword(MR_mktag(2), &mercury__dir_scalar_common_5[4]);
                }
              else
                {
                  MR_Word mercury__dir__Msg_13 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__AccessResult_12, (MR_Integer) 0)));

                  *mercury__dir__IsReadable_7 = (MR_Integer) 0;
                  {
                    MR_Word base;
                    base = (MR_Word) MR_mkword(MR_mktag(2), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
                    *mercury__dir__Result_8 = base;
                    MR_hl_field(MR_mktag(2), base, 0) = ((MR_Box) (mercury__dir__Msg_13));
                  }
                }
            }
            break;
        }
      }
  }
}

static void MR_CALL 
mercury__dir__open_2_4_p_0(
  MR_String mercury__dir__DirName_1,
  MR_Word * mercury__dir__Result_2)
{
  {
    MR_bool mercury__dir__succeeded;

{
#define MR_PROC_LABEL mercury__dir__open_2_4_p_0

	MR_String DirName;
	MR_Word Result;

	DirName =  mercury__dir__DirName_1 ;
		{

#if defined(MR_WIN32)
    WIN32_FIND_DATAW    file_data;
    ML_DIR_STREAM       Dir;
    LPTSTR              FirstFileName;
    char                *dir_pattern;
    MR_Integer          is_readable;
    char                *filename;

    ML_check_dir_readable(DirName, &is_readable, &Result);
    if (is_readable) {
        dir_pattern = ML_make_path_name(DirName, MR_make_string_const("*"));
        Dir = FindFirstFileW(ML_utf8_to_wide(dir_pattern), &file_data);
        if (Dir == INVALID_HANDLE_VALUE) {
            int error = GetLastError();
            if (error == ERROR_NO_MORE_FILES) {
                Result = ML_make_dir_open_result_eof();
            } else {
                ML_make_dir_open_result_error(error, &Result);
            }
        } else {
            filename = ML_wide_to_utf8(file_data.cFileName, MR_ALLOC_ID);
            ML_make_win32_dir_open_result_ok(Dir, filename, &Result);
        }
    }

#elif defined(MR_HAVE_OPENDIR) && defined(MR_HAVE_READDIR) && \
        defined(MR_HAVE_CLOSEDIR)
    ML_DIR_STREAM Dir;

    Dir = opendir(DirName);
    if (Dir == NULL) {
        ML_make_dir_open_result_error(errno, &Result);
    } else {
        ML_dir_read_first_entry(Dir, &Result);
    }

#else /* !MR_WIN32 && !(MR_HAVE_OPENDIR etc.) */
    MR_fatal_error("dir.open called but not supported");
#endif


		;}
#undef MR_PROC_LABEL
	 *mercury__dir__Result_2  = Result;
}
  }
}

static MR_bool MR_CALL 
mercury__dir__can_implement_dir_foldl_0_p_0(void)
{
  {
    MR_bool mercury__dir__succeeded;

{
#define MR_PROC_LABEL mercury__dir__can_implement_dir_foldl_0_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_HAVE_OPENDIR) && defined(MR_HAVE_READDIR) && \
        defined(MR_HAVE_CLOSEDIR)
    SUCCESS_INDICATOR = MR_TRUE;
#elif defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    return mercury__dir__succeeded;
  }
}

static void MR_CALL 
mercury__dir__check_for_symlink_loop_7_p_0(
  MR_Word mercury__dir__SymLinkParent_8,
  MR_String mercury__dir__DirName_9,
  MR_Word * mercury__dir__LoopRes_10,
  MR_Word mercury__dir__STATE_VARIABLE_ParentIds_0_17,
  MR_Word * mercury__dir__STATE_VARIABLE_ParentIds_18)
{
  {
    MR_bool mercury__dir__succeeded;

{
#define MR_PROC_LABEL mercury__dir__check_for_symlink_loop_7_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_HAVE_SYMLINK) && defined(MR_HAVE_READLINK)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    if (mercury__dir__succeeded)
      {
        MR_Word mercury__dir__IdRes_13;

        {
          mercury__io__file_id_4_p_0(mercury__dir__DirName_9, &mercury__dir__IdRes_13);
        }
        if (((MR_tag((MR_Word) mercury__dir__IdRes_13)) == (MR_mktag((MR_Integer) 1))))
          {
            *mercury__dir__LoopRes_10 = (MR_Word) mercury__dir__IdRes_13;
            *mercury__dir__STATE_VARIABLE_ParentIds_18 = mercury__dir__STATE_VARIABLE_ParentIds_0_17;
          }
        else
          {
            MR_Box mercury__dir__Id_14 = ((MR_Box) (MR_hl_field(MR_mktag(0), mercury__dir__IdRes_13, (MR_Integer) 0)));
            MR_Word mercury__dir__Loop_15;
            MR_Word mercury__dir__TypeCtorInfo_24_24;

            mercury__dir__succeeded = (mercury__dir__SymLinkParent_8 == (MR_Integer) 1);
            if (mercury__dir__succeeded)
              {
                mercury__dir__TypeCtorInfo_24_24 = (MR_Word) &mercury__io__io__type_ctor_info_file_id_0;
                {
                  mercury__dir__succeeded = mercury__list__member_2_p_0(mercury__dir__TypeCtorInfo_24_24, ((MR_Box) (mercury__dir__Id_14)), mercury__dir__STATE_VARIABLE_ParentIds_0_17);
                }
              }
            if (mercury__dir__succeeded)
              {
                mercury__dir__Loop_15 = (MR_Integer) 1;
                *mercury__dir__STATE_VARIABLE_ParentIds_18 = mercury__dir__STATE_VARIABLE_ParentIds_0_17;
              }
            else
              {
                {
                  MR_Word base;
                  base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                  *mercury__dir__STATE_VARIABLE_ParentIds_18 = base;
                  MR_hl_field(MR_mktag(1), base, 0) = ((MR_Box) (mercury__dir__Id_14));
                  MR_hl_field(MR_mktag(1), base, 1) = ((MR_Box) (mercury__dir__STATE_VARIABLE_ParentIds_0_17));
                }
                mercury__dir__Loop_15 = (MR_Integer) 0;
              }
            {
              MR_Word base;
              base = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL);
              *mercury__dir__LoopRes_10 = base;
              MR_hl_field(MR_mktag(0), base, 0) = ((MR_Box) (mercury__dir__Loop_15));
            }
          }
      }
    else
      {
        *mercury__dir__LoopRes_10 = (MR_Word) &mercury__dir_scalar_common_5[1];
        *mercury__dir__STATE_VARIABLE_ParentIds_18 = mercury__dir__STATE_VARIABLE_ParentIds_0_17;
      }
  }
}

static void MR_CALL 
mercury__dir__foldl2_process_entries_14_p_0(
  MR_Word mercury__dir__TypeInfo_for_T_87,
  MR_Box mercury__dir__STATE_VARIABLE_Dir_0_1,
  MR_Box * mercury__dir__STATE_VARIABLE_Dir_2,
  MR_Word mercury__dir__SymLinkParent_3,
  MR_Word mercury__dir__P_4,
  MR_String mercury__dir__DirName_5,
  MR_Word mercury__dir__HeadVar__6_6,
  MR_Word mercury__dir__ParentIds_7,
  MR_Word mercury__dir__Recursive_8,
  MR_Word mercury__dir__FollowLinks_9,
  MR_Word * mercury__dir__HeadVar__10_10,
  MR_Box mercury__dir__T0_11,
  MR_Word * mercury__dir__HeadVar__12_12)
{
  while (MR_TRUE)
    {
      /* tailcall optimized into a loop */
      {
        MR_bool mercury__dir__succeeded;

        switch (MR_tag((MR_Word) mercury__dir__HeadVar__6_6)) {
          default: /*NOTREACHED*/ MR_assert(0);
          case (MR_Integer) 0:
            {
              *mercury__dir__HeadVar__10_10 = (MR_Integer) 1;
              {
                MR_Word base;
                base = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL);
                *mercury__dir__HeadVar__12_12 = base;
                MR_hl_field(MR_mktag(0), base, 0) = mercury__dir__T0_11;
              }
              *mercury__dir__STATE_VARIABLE_Dir_2 = mercury__dir__STATE_VARIABLE_Dir_0_1;
            }
            break;
          case (MR_Integer) 1:
            {
              MR_String mercury__dir__FileName_46 = ((MR_String) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__6_6, (MR_Integer) 0)));
              MR_String mercury__dir__PathName_54;
              MR_Word mercury__dir__FileTypeRes_55;

              {
                mercury__dir__PathName_54 = mercury__dir__f_slash_2_f_0(mercury__dir__DirName_5, mercury__dir__FileName_46);
              }
              {
                mercury__io__file_type_5_p_0((MR_Integer) 0, mercury__dir__PathName_54, &mercury__dir__FileTypeRes_55);
              }
              if (((MR_tag((MR_Word) mercury__dir__FileTypeRes_55)) == (MR_mktag((MR_Integer) 1))))
                {
                  MR_Word mercury__dir__Error_86 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileTypeRes_55, (MR_Integer) 0)));

                  *mercury__dir__HeadVar__10_10 = (MR_Integer) 0;
                  {
                    MR_Word base;
                    base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                    *mercury__dir__HeadVar__12_12 = base;
                    MR_hl_field(MR_mktag(1), base, 0) = mercury__dir__T0_11;
                    MR_hl_field(MR_mktag(1), base, 1) = ((MR_Box) (mercury__dir__Error_86));
                  }
                  *mercury__dir__STATE_VARIABLE_Dir_2 = mercury__dir__STATE_VARIABLE_Dir_0_1;
                }
              else
                {
                  MR_Word mercury__dir__Type_56 = ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__FileTypeRes_55, (MR_Integer) 0)));
                  MR_Word mercury__dir__Continue1_57;
                  MR_Box mercury__dir__T1_58;
                  void MR_CALL (* mercury__dir__func_0)(MR_Box, MR_Box, MR_Box, MR_Box, MR_Box *, MR_Box, MR_Box *, MR_Box, MR_Box *) = ((void MR_CALL (*)(MR_Box, MR_Box, MR_Box, MR_Box, MR_Box *, MR_Box, MR_Box *, MR_Box, MR_Box *)) (MR_hl_field(MR_mktag(0), mercury__dir__P_4, (MR_Integer) 1)));
                  MR_Box mercury__dir__conv2_Continue1_57;
                  MR_Box mercury__dir__conv1_STATE_VARIABLE_IO_75_75;

                  {
                    mercury__dir__func_0(((MR_Box) mercury__dir__P_4), ((MR_Box) (mercury__dir__DirName_5)), ((MR_Box) (mercury__dir__FileName_46)), ((MR_Box) (mercury__dir__Type_56)), &mercury__dir__conv2_Continue1_57, mercury__dir__T0_11, &mercury__dir__T1_58, ((MR_Box) ((MR_Integer) 0)), &mercury__dir__conv1_STATE_VARIABLE_IO_75_75);
                  }
                  mercury__dir__Continue1_57 = ((MR_Word) mercury__dir__conv2_Continue1_57);
                  switch (mercury__dir__Continue1_57) {
                    default: /*NOTREACHED*/ MR_assert(0);
                    case (MR_Integer) 0:
                      {
                        {
                          MR_Word base;
                          base = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL);
                          *mercury__dir__HeadVar__12_12 = base;
                          MR_hl_field(MR_mktag(0), base, 0) = mercury__dir__T1_58;
                        }
                        *mercury__dir__HeadVar__10_10 = (MR_Integer) 0;
                        *mercury__dir__STATE_VARIABLE_Dir_2 = mercury__dir__STATE_VARIABLE_Dir_0_1;
                      }
                      break;
                    case (MR_Integer) 1:
                      {
                        MR_Word mercury__dir__Continue2_59;
                        MR_Word mercury__dir__Res1_60;
                        MR_Box mercury__dir__T_64;

                        mercury__dir__succeeded = (mercury__dir__Recursive_8 == (MR_Integer) 1);
                        if (mercury__dir__succeeded)
                          mercury__dir__succeeded = (mercury__dir__Type_56 == (MR_Integer) 1);
                        if (mercury__dir__succeeded)
                          {
                            mercury__dir__foldl2_process_dir_11_p_0(mercury__dir__TypeInfo_for_T_87, mercury__dir__SymLinkParent_3, mercury__dir__P_4, mercury__dir__PathName_54, mercury__dir__ParentIds_7, mercury__dir__Recursive_8, mercury__dir__FollowLinks_9, &mercury__dir__Continue2_59, mercury__dir__T1_58, &mercury__dir__Res1_60);
                          }
                        else
                          {
                            mercury__dir__succeeded = (mercury__dir__Recursive_8 == (MR_Integer) 1);
                            if (mercury__dir__succeeded)
                              {
                                mercury__dir__succeeded = (mercury__dir__Type_56 == (MR_Integer) 2);
                                if (mercury__dir__succeeded)
                                  mercury__dir__succeeded = (mercury__dir__FollowLinks_9 == (MR_Integer) 1);
                              }
                            if (mercury__dir__succeeded)
                              {
                                MR_Word mercury__dir__TargetTypeRes_61;

                                {
                                  mercury__io__file_type_5_p_0((MR_Integer) 1, mercury__dir__PathName_54, &mercury__dir__TargetTypeRes_61);
                                }
                                if (((MR_tag((MR_Word) mercury__dir__TargetTypeRes_61)) == (MR_mktag((MR_Integer) 1))))
                                  {
                                    MR_Word mercury__dir__TargetTypeError_63 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__TargetTypeRes_61, (MR_Integer) 0)));

                                    mercury__dir__Continue2_59 = (MR_Integer) 0;
                                    {
                                      mercury__dir__Res1_60 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                                      MR_hl_field(MR_mktag(1), mercury__dir__Res1_60, 0) = mercury__dir__T1_58;
                                      MR_hl_field(MR_mktag(1), mercury__dir__Res1_60, 1) = ((MR_Box) (mercury__dir__TargetTypeError_63));
                                    }
                                  }
                                else
                                  {
                                    MR_Word mercury__dir__TargetType_62 = ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__TargetTypeRes_61, (MR_Integer) 0)));

                                    switch (mercury__dir__TargetType_62) {
                                      default: /*NOTREACHED*/ MR_assert(0);
                                      case (MR_Integer) 6:
                                      case (MR_Integer) 5:
                                      case (MR_Integer) 7:
                                      case (MR_Integer) 3:
                                      case (MR_Integer) 0:
                                      case (MR_Integer) 8:
                                      case (MR_Integer) 9:
                                      case (MR_Integer) 4:
                                      case (MR_Integer) 2:
                                      case (MR_Integer) 10:
                                        {
                                          mercury__dir__Continue2_59 = (MR_Integer) 1;
                                          {
                                            mercury__dir__Res1_60 = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL);
                                            MR_hl_field(MR_mktag(0), mercury__dir__Res1_60, 0) = mercury__dir__T1_58;
                                          }
                                        }
                                        break;
                                      case (MR_Integer) 1:
                                        {
                                          {
                                            mercury__dir__foldl2_process_dir_11_p_0(mercury__dir__TypeInfo_for_T_87, (MR_Integer) 1, mercury__dir__P_4, mercury__dir__PathName_54, mercury__dir__ParentIds_7, mercury__dir__Recursive_8, mercury__dir__FollowLinks_9, &mercury__dir__Continue2_59, mercury__dir__T1_58, &mercury__dir__Res1_60);
                                          }
                                        }
                                        break;
                                    }
                                  }
                              }
                            else
                              {
                                mercury__dir__Continue2_59 = (MR_Integer) 1;
                                {
                                  mercury__dir__Res1_60 = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL);
                                  MR_hl_field(MR_mktag(0), mercury__dir__Res1_60, 0) = mercury__dir__T1_58;
                                }
                              }
                          }
                        mercury__dir__succeeded = (mercury__dir__Continue2_59 == (MR_Integer) 1);
                        if (mercury__dir__succeeded)
                          {
                            mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__Res1_60)) == (MR_mktag((MR_Integer) 0)));
                            if (mercury__dir__succeeded)
                              mercury__dir__T_64 = (MR_hl_field(MR_mktag(0), mercury__dir__Res1_60, (MR_Integer) 0));
                          }
                        if (mercury__dir__succeeded)
                          {
                            MR_Word mercury__dir__EntryResult0_65;
                            MR_Word mercury__dir__EntryResult_67;
                            MR_Box mercury__dir__STATE_VARIABLE_Dir_83_83;

                            {
                              mercury__dir__read_entry_4_p_0(mercury__dir__STATE_VARIABLE_Dir_0_1, &mercury__dir__EntryResult0_65);
                            }
                            switch (MR_tag((MR_Word) mercury__dir__EntryResult0_65)) {
                              default: /*NOTREACHED*/ MR_assert(0);
                              case (MR_Integer) 0:
                                {
                                  mercury__dir__EntryResult_67 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
                                  mercury__dir__STATE_VARIABLE_Dir_83_83 = mercury__dir__STATE_VARIABLE_Dir_0_1;
                                }
                                break;
                              case (MR_Integer) 1:
                                {
                                  MR_String mercury__dir__FileName1_66;
                                  MR_Tuple mercury__dir__V_82_82 = ((MR_Tuple) (MR_hl_field(MR_mktag(1), mercury__dir__EntryResult0_65, (MR_Integer) 0)));

                                  mercury__dir__STATE_VARIABLE_Dir_83_83 = ((MR_Box) (MR_hl_field(MR_mktag(0), mercury__dir__V_82_82, (MR_Integer) 0)));
                                  mercury__dir__FileName1_66 = ((MR_String) (MR_hl_field(MR_mktag(0), mercury__dir__V_82_82, (MR_Integer) 1)));
                                  {
                                    mercury__dir__EntryResult_67 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
                                    MR_hl_field(MR_mktag(1), mercury__dir__EntryResult_67, 0) = ((MR_Box) (mercury__dir__FileName1_66));
                                  }
                                }
                                break;
                              case (MR_Integer) 2:
                                {
                                  mercury__dir__EntryResult_67 = (MR_Word) mercury__dir__EntryResult0_65;
                                  mercury__dir__STATE_VARIABLE_Dir_83_83 = mercury__dir__STATE_VARIABLE_Dir_0_1;
                                }
                                break;
                            }
                            /* direct tailcall eliminated */
                            {
                              MR_Box mercury__dir__STATE_VARIABLE_Dir_0__tmp_copy_1 = mercury__dir__STATE_VARIABLE_Dir_83_83;
                              MR_Word mercury__dir__HeadVar__6__tmp_copy_6 = mercury__dir__EntryResult_67;
                              MR_Box mercury__dir__T0__tmp_copy_11 = mercury__dir__T_64;

                              mercury__dir__T0_11 = mercury__dir__T0__tmp_copy_11;
                              mercury__dir__HeadVar__6_6 = mercury__dir__HeadVar__6__tmp_copy_6;
                              mercury__dir__STATE_VARIABLE_Dir_0_1 = mercury__dir__STATE_VARIABLE_Dir_0__tmp_copy_1;
                            }
                            continue;
                          }
                        else
                          {
                            *mercury__dir__HeadVar__10_10 = (MR_Integer) 0;
                            *mercury__dir__HeadVar__12_12 = mercury__dir__Res1_60;
                            *mercury__dir__STATE_VARIABLE_Dir_2 = mercury__dir__STATE_VARIABLE_Dir_0_1;
                          }
                      }
                      break;
                  }
                }
            }
            break;
          case (MR_Integer) 2:
            {
              MR_Word mercury__dir__Error_19 = ((MR_Word) (MR_hl_field(MR_mktag(2), mercury__dir__HeadVar__6_6, (MR_Integer) 0)));

              *mercury__dir__HeadVar__10_10 = (MR_Integer) 0;
              {
                MR_Word base;
                base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                *mercury__dir__HeadVar__12_12 = base;
                MR_hl_field(MR_mktag(1), base, 0) = mercury__dir__T0_11;
                MR_hl_field(MR_mktag(1), base, 1) = ((MR_Box) (mercury__dir__Error_19));
              }
              *mercury__dir__STATE_VARIABLE_Dir_2 = mercury__dir__STATE_VARIABLE_Dir_0_1;
            }
            break;
        }
      }
      break;
    }
}

static void MR_CALL 
mercury__dir__foldl2_process_dir2_13_p_0(
  MR_Word mercury__dir__TypeInfo_for_T_33,
  MR_Box mercury__dir__STATE_VARIABLE_Dir_0_26,
  MR_Box * mercury__dir__STATE_VARIABLE_Dir_27,
  MR_Word mercury__dir__SymLinkParent_15,
  MR_Word mercury__dir__P_16,
  MR_String mercury__dir__DirName_17,
  MR_Word mercury__dir__ParentIds_18,
  MR_String mercury__dir__FirstEntry_19,
  MR_Word mercury__dir__Recursive_20,
  MR_Word mercury__dir__FollowLinks_21,
  MR_Box mercury__dir__T0_22,
  MR_Tuple * mercury__dir__HeadVar__11_11)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__Res_23;
    MR_Word mercury__dir__Cont_24;
    MR_Word mercury__dir__V_31_31;

    {
      mercury__dir__V_31_31 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
      MR_hl_field(MR_mktag(1), mercury__dir__V_31_31, 0) = ((MR_Box) (mercury__dir__FirstEntry_19));
    }
    {
      mercury__dir__foldl2_process_entries_14_p_0(mercury__dir__TypeInfo_for_T_33, mercury__dir__STATE_VARIABLE_Dir_0_26, mercury__dir__STATE_VARIABLE_Dir_27, mercury__dir__SymLinkParent_15, mercury__dir__P_16, mercury__dir__DirName_17, mercury__dir__V_31_31, mercury__dir__ParentIds_18, mercury__dir__Recursive_20, mercury__dir__FollowLinks_21, &mercury__dir__Cont_24, mercury__dir__T0_22, &mercury__dir__Res_23);
    }
    {
      MR_Tuple base;
      base = (MR_Tuple) MR_new_object(MR_Tuple, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL);
      *mercury__dir__HeadVar__11_11 = base;
      MR_hl_field(MR_mktag(0), base, 0) = ((MR_Box) (mercury__dir__Res_23));
      MR_hl_field(MR_mktag(0), base, 1) = ((MR_Box) (mercury__dir__Cont_24));
    }
  }
}

static void MR_CALL 
mercury__dir__foldl2_process_dir_11_p_0_1(
  MR_Box mercury__dir__closure_arg,
  MR_Box * mercury__dir__wrapper_arg_1,
  MR_Box mercury__dir__wrapper_arg_2,
  MR_Box * mercury__dir__wrapper_arg_3)
{
  {
    MR_Box mercury__dir__closure = mercury__dir__closure_arg;
    MR_Tuple mercury__dir__conv0_LambdaHeadVar__1_50;

    {
      mercury__dir__IntroducedFrom__pred__foldl2_process_dir__1348__1_13_p_0(((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__closure, (MR_Integer) 3))), ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__closure, (MR_Integer) 4))), ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__closure, (MR_Integer) 5))), ((MR_String) (MR_hl_field(MR_mktag(0), mercury__dir__closure, (MR_Integer) 6))), ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__closure, (MR_Integer) 7))), ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__closure, (MR_Integer) 8))), (MR_hl_field(MR_mktag(0), mercury__dir__closure, (MR_Integer) 9)), ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__closure, (MR_Integer) 10))), ((MR_Box) (MR_hl_field(MR_mktag(0), mercury__dir__closure, (MR_Integer) 11))), ((MR_String) (MR_hl_field(MR_mktag(0), mercury__dir__closure, (MR_Integer) 12))), &mercury__dir__conv0_LambdaHeadVar__1_50);
    }
    *mercury__dir__wrapper_arg_1 = ((MR_Box) (mercury__dir__conv0_LambdaHeadVar__1_50));
  }
}

void MR_CALL 
mercury__dir__foldl2_process_dir_11_p_0(
  MR_Word mercury__dir__TypeInfo_for_T_69,
  MR_Word mercury__dir__SymLinkParent_12,
  MR_Word mercury__dir__P_13,
  MR_String mercury__dir__DirName_14,
  MR_Word mercury__dir__ParentIds0_15,
  MR_Word mercury__dir__Recursive_16,
  MR_Word mercury__dir__FollowLinks_17,
  MR_Word * mercury__dir__Continue_18,
  MR_Box mercury__dir__T0_19,
  MR_Word * mercury__dir__Result_20)
{
  {
    MR_bool mercury__dir__succeeded;

{
#define MR_PROC_LABEL mercury__dir__foldl2_process_dir_11_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_HAVE_OPENDIR) && defined(MR_HAVE_READDIR) && \
        defined(MR_HAVE_CLOSEDIR)
    SUCCESS_INDICATOR = MR_TRUE;
#elif defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    if (mercury__dir__succeeded)
      {
        MR_Word mercury__dir__LoopRes_22;
        MR_Word mercury__dir__ParentIds_23;

        mercury__dir__succeeded = (mercury__dir__Recursive_16 == (MR_Integer) 1);
        if (mercury__dir__succeeded)
          mercury__dir__succeeded = (mercury__dir__FollowLinks_17 == (MR_Integer) 1);
        if (mercury__dir__succeeded)
          {
            mercury__dir__check_for_symlink_loop_7_p_0(mercury__dir__SymLinkParent_12, mercury__dir__DirName_14, &mercury__dir__LoopRes_22, mercury__dir__ParentIds0_15, &mercury__dir__ParentIds_23);
          }
        else
          {
            mercury__dir__ParentIds_23 = mercury__dir__ParentIds0_15;
            mercury__dir__LoopRes_22 = (MR_Word) &mercury__dir_scalar_common_5[1];
          }
        if (((MR_tag((MR_Word) mercury__dir__LoopRes_22)) == (MR_mktag((MR_Integer) 1))))
          {
            MR_Word mercury__dir__Error_68 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__LoopRes_22, (MR_Integer) 0)));

            *mercury__dir__Continue_18 = (MR_Integer) 0;
            {
              MR_Word base;
              base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
              *mercury__dir__Result_20 = base;
              MR_hl_field(MR_mktag(1), base, 0) = mercury__dir__T0_19;
              MR_hl_field(MR_mktag(1), base, 1) = ((MR_Box) (mercury__dir__Error_68));
            }
          }
        else
          {
            MR_Word mercury__dir__V_84_84 = ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__LoopRes_22, (MR_Integer) 0)));

            switch (mercury__dir__V_84_84) {
              default: /*NOTREACHED*/ MR_assert(0);
              case (MR_Integer) 0:
                {
                  MR_Word mercury__dir__OpenResult_24;

{
#define MR_PROC_LABEL mercury__dir__foldl2_process_dir_11_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_HAVE_OPENDIR) && defined(MR_HAVE_READDIR) && \
        defined(MR_HAVE_CLOSEDIR)
    SUCCESS_INDICATOR = MR_TRUE;
#elif defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
                  if (mercury__dir__succeeded)
                    {
{
#define MR_PROC_LABEL mercury__dir__foldl2_process_dir_11_p_0

	MR_String DirName;
	MR_Word Result;

	DirName =  mercury__dir__DirName_14 ;
		{

#if defined(MR_WIN32)
    WIN32_FIND_DATAW    file_data;
    ML_DIR_STREAM       Dir;
    LPTSTR              FirstFileName;
    char                *dir_pattern;
    MR_Integer          is_readable;
    char                *filename;

    ML_check_dir_readable(DirName, &is_readable, &Result);
    if (is_readable) {
        dir_pattern = ML_make_path_name(DirName, MR_make_string_const("*"));
        Dir = FindFirstFileW(ML_utf8_to_wide(dir_pattern), &file_data);
        if (Dir == INVALID_HANDLE_VALUE) {
            int error = GetLastError();
            if (error == ERROR_NO_MORE_FILES) {
                Result = ML_make_dir_open_result_eof();
            } else {
                ML_make_dir_open_result_error(error, &Result);
            }
        } else {
            filename = ML_wide_to_utf8(file_data.cFileName, MR_ALLOC_ID);
            ML_make_win32_dir_open_result_ok(Dir, filename, &Result);
        }
    }

#elif defined(MR_HAVE_OPENDIR) && defined(MR_HAVE_READDIR) && \
        defined(MR_HAVE_CLOSEDIR)
    ML_DIR_STREAM Dir;

    Dir = opendir(DirName);
    if (Dir == NULL) {
        ML_make_dir_open_result_error(errno, &Result);
    } else {
        ML_dir_read_first_entry(Dir, &Result);
    }

#else /* !MR_WIN32 && !(MR_HAVE_OPENDIR etc.) */
    MR_fatal_error("dir.open called but not supported");
#endif


		;}
#undef MR_PROC_LABEL
	 mercury__dir__OpenResult_24  = Result;
}
                    }
                  else
                    {
                      MR_Word mercury__dir__V_91_91 = (MR_Word) ((MR_Box) ((MR_String) "dir.foldl2 not implemented on this platform"));

                      mercury__dir__OpenResult_24 = (MR_Word) MR_mkword(MR_mktag(2), &mercury__dir_scalar_common_5[2]);
                    }
                  switch (MR_tag((MR_Word) mercury__dir__OpenResult_24)) {
                    default: /*NOTREACHED*/ MR_assert(0);
                    case (MR_Integer) 0:
                      {
                        *mercury__dir__Continue_18 = (MR_Integer) 1;
                        {
                          MR_Word base;
                          base = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL);
                          *mercury__dir__Result_20 = base;
                          MR_hl_field(MR_mktag(0), base, 0) = mercury__dir__T0_19;
                        }
                      }
                      break;
                    case (MR_Integer) 1:
                      {
                        MR_Box mercury__dir__Dir0_25;
                        MR_String mercury__dir__FirstEntry_26;
                        MR_Word mercury__dir__ProcessDir_27;
                        MR_Word mercury__dir__ExcpResult_32;
                        MR_Tuple mercury__dir__V_49_49 = ((MR_Tuple) (MR_hl_field(MR_mktag(1), mercury__dir__OpenResult_24, (MR_Integer) 0)));
                        MR_Word mercury__dir__TypeCtorInfo_70_70;
                        MR_Word mercury__dir__TypeInfo_71_71;
                        MR_Word mercury__dir__TypeCtorInfo_72_72;
                        MR_Word mercury__dir__TypeCtorInfo_73_73;
                        MR_Word mercury__dir__TypeCtorInfo_74_74;
                        MR_Word mercury__dir__TypeInfo_76_76;

                        mercury__dir__Dir0_25 = ((MR_Box) (MR_hl_field(MR_mktag(0), mercury__dir__V_49_49, (MR_Integer) 0)));
                        mercury__dir__FirstEntry_26 = ((MR_String) (MR_hl_field(MR_mktag(0), mercury__dir__V_49_49, (MR_Integer) 1)));
                        {
                          mercury__dir__ProcessDir_27 = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 13 * sizeof(MR_Word)), NULL, NULL);
                          MR_hl_field(MR_mktag(0), mercury__dir__ProcessDir_27, 0) = ((MR_Box) (&mercury__dir_scalar_common_7[0]));
                          MR_hl_field(MR_mktag(0), mercury__dir__ProcessDir_27, 1) = ((MR_Box) (mercury__dir__foldl2_process_dir_11_p_0_1));
                          MR_hl_field(MR_mktag(0), mercury__dir__ProcessDir_27, 2) = ((MR_Box) (MR_Word) ((MR_Integer) 10));
                          MR_hl_field(MR_mktag(0), mercury__dir__ProcessDir_27, 3) = ((MR_Box) (mercury__dir__TypeInfo_for_T_69));
                          MR_hl_field(MR_mktag(0), mercury__dir__ProcessDir_27, 4) = ((MR_Box) (mercury__dir__SymLinkParent_12));
                          MR_hl_field(MR_mktag(0), mercury__dir__ProcessDir_27, 5) = ((MR_Box) (mercury__dir__P_13));
                          MR_hl_field(MR_mktag(0), mercury__dir__ProcessDir_27, 6) = ((MR_Box) (mercury__dir__DirName_14));
                          MR_hl_field(MR_mktag(0), mercury__dir__ProcessDir_27, 7) = ((MR_Box) (mercury__dir__Recursive_16));
                          MR_hl_field(MR_mktag(0), mercury__dir__ProcessDir_27, 8) = ((MR_Box) (mercury__dir__FollowLinks_17));
                          MR_hl_field(MR_mktag(0), mercury__dir__ProcessDir_27, 9) = mercury__dir__T0_19;
                          MR_hl_field(MR_mktag(0), mercury__dir__ProcessDir_27, 10) = ((MR_Box) (mercury__dir__ParentIds_23));
                          MR_hl_field(MR_mktag(0), mercury__dir__ProcessDir_27, 11) = ((MR_Box) (mercury__dir__Dir0_25));
                          MR_hl_field(MR_mktag(0), mercury__dir__ProcessDir_27, 12) = ((MR_Box) (mercury__dir__FirstEntry_26));
                        }
                        mercury__dir__TypeCtorInfo_74_74 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_tuple_0;
                        mercury__dir__TypeCtorInfo_70_70 = (MR_Word) &mercury__io__io__type_ctor_info_maybe_partial_res_1;
                        {
                          mercury__dir__TypeInfo_71_71 = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL);
                          MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_71_71, 0) = ((MR_Box) (mercury__dir__TypeCtorInfo_70_70));
                          MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_71_71, 1) = ((MR_Box) (mercury__dir__TypeInfo_for_T_69));
                        }
                        mercury__dir__TypeCtorInfo_72_72 = (MR_Word) &mercury__bool__bool__type_ctor_info_bool_0;
                        mercury__dir__TypeCtorInfo_73_73 = (MR_Word) &mercury__dir__dir__type_ctor_info_stream_0;
                        {
                          mercury__dir__TypeInfo_76_76 = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 5 * sizeof(MR_Word)), NULL, NULL);
                          MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_76_76, 0) = ((MR_Box) (mercury__dir__TypeCtorInfo_74_74));
                          MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_76_76, 1) = ((MR_Box) ((MR_Integer) 3));
                          MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_76_76, 2) = ((MR_Box) (mercury__dir__TypeInfo_71_71));
                          MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_76_76, 3) = ((MR_Box) (mercury__dir__TypeCtorInfo_72_72));
                          MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_76_76, 4) = ((MR_Box) (mercury__dir__TypeCtorInfo_73_73));
                        }
                        {
                          mercury__dir__f_85_110_117_115_101_100_65_114_103_115_95_95_112_114_101_100_95_95_116_114_121_95_105_111_95_95_104_111_53_95_95_91_49_44_32_50_44_32_51_44_32_52_44_32_53_44_32_54_44_32_55_44_32_56_44_32_57_44_32_49_48_44_32_49_49_44_32_49_50_44_32_49_51_93_95_48_4_p_in__exception_0(mercury__dir__TypeInfo_76_76, mercury__dir__ProcessDir_27, &mercury__dir__ExcpResult_32);
                        }
                        if (((MR_tag((MR_Word) mercury__dir__ExcpResult_32)) == (MR_mktag((MR_Integer) 2))))
                          {
                            MR_Word mercury__dir__TypeCtorInfo_77_77;
                            MR_Word mercury__dir__TypeInfo_78_78;
                            MR_Word mercury__dir__TypeCtorInfo_79_79;
                            MR_Word mercury__dir__TypeCtorInfo_80_80;
                            MR_Word mercury__dir__TypeCtorInfo_81_81;
                            MR_Word mercury__dir__TypeInfo_83_83;
                            MR_Word mercury__dir__V_41_41;

                            {
                              mercury__dir__close_4_p_0(mercury__dir__Dir0_25, &mercury__dir__V_41_41);
                            }
                            mercury__dir__TypeCtorInfo_81_81 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_tuple_0;
                            mercury__dir__TypeCtorInfo_77_77 = (MR_Word) &mercury__io__io__type_ctor_info_maybe_partial_res_1;
                            {
                              mercury__dir__TypeInfo_78_78 = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL);
                              MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_78_78, 0) = ((MR_Box) (mercury__dir__TypeCtorInfo_77_77));
                              MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_78_78, 1) = ((MR_Box) (mercury__dir__TypeInfo_for_T_69));
                            }
                            mercury__dir__TypeCtorInfo_79_79 = (MR_Word) &mercury__bool__bool__type_ctor_info_bool_0;
                            mercury__dir__TypeCtorInfo_80_80 = (MR_Word) &mercury__dir__dir__type_ctor_info_stream_0;
                            {
                              mercury__dir__TypeInfo_83_83 = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 5 * sizeof(MR_Word)), NULL, NULL);
                              MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_83_83, 0) = ((MR_Box) (mercury__dir__TypeCtorInfo_81_81));
                              MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_83_83, 1) = ((MR_Box) ((MR_Integer) 3));
                              MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_83_83, 2) = ((MR_Box) (mercury__dir__TypeInfo_78_78));
                              MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_83_83, 3) = ((MR_Box) (mercury__dir__TypeCtorInfo_79_79));
                              MR_hl_field(MR_mktag(0), mercury__dir__TypeInfo_83_83, 4) = ((MR_Box) (mercury__dir__TypeCtorInfo_80_80));
                            }
                            {
                              mercury__exception__rethrow_1_p_0(mercury__dir__TypeInfo_83_83, (MR_Word) mercury__dir__ExcpResult_32);
                              return;
                            }
                          }
                        else
                          {
                            MR_Word mercury__dir__DirRes_33;
                            MR_Box mercury__dir__Dir_34;
                            MR_Word mercury__dir__CleanupRes_35;
                            MR_Tuple mercury__dir__V_56_56 = ((MR_Tuple) (MR_hl_field(MR_mktag(1), mercury__dir__ExcpResult_32, (MR_Integer) 0)));

                            mercury__dir__DirRes_33 = ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__V_56_56, (MR_Integer) 0)));
                            *mercury__dir__Continue_18 = ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__V_56_56, (MR_Integer) 1)));
                            mercury__dir__Dir_34 = ((MR_Box) (MR_hl_field(MR_mktag(0), mercury__dir__V_56_56, (MR_Integer) 2)));
                            {
                              mercury__dir__close_4_p_0(mercury__dir__Dir_34, &mercury__dir__CleanupRes_35);
                            }
                            if (((MR_tag((MR_Word) mercury__dir__DirRes_33)) == (MR_mktag((MR_Integer) 1))))
                              *mercury__dir__Result_20 = mercury__dir__DirRes_33;
                            else
                              {
                                MR_Box mercury__dir__T_36 = (MR_hl_field(MR_mktag(0), mercury__dir__DirRes_33, (MR_Integer) 0));

                                if ((mercury__dir__CleanupRes_35 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
                                  *mercury__dir__Result_20 = mercury__dir__DirRes_33;
                                else
                                  {
                                    MR_Word mercury__dir__Error_37 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__CleanupRes_35, (MR_Integer) 0)));

                                    {
                                      MR_Word base;
                                      base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                                      *mercury__dir__Result_20 = base;
                                      MR_hl_field(MR_mktag(1), base, 0) = mercury__dir__T_36;
                                      MR_hl_field(MR_mktag(1), base, 1) = ((MR_Box) (mercury__dir__Error_37));
                                    }
                                  }
                              }
                          }
                      }
                      break;
                    case (MR_Integer) 2:
                      {
                        MR_Word mercury__dir__Error_67 = ((MR_Word) (MR_hl_field(MR_mktag(2), mercury__dir__OpenResult_24, (MR_Integer) 0)));

                        *mercury__dir__Continue_18 = (MR_Integer) 0;
                        {
                          MR_Word base;
                          base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                          *mercury__dir__Result_20 = base;
                          MR_hl_field(MR_mktag(1), base, 0) = mercury__dir__T0_19;
                          MR_hl_field(MR_mktag(1), base, 1) = ((MR_Box) (mercury__dir__Error_67));
                        }
                      }
                      break;
                  }
                }
                break;
              case (MR_Integer) 1:
                {
                  *mercury__dir__Continue_18 = (MR_Integer) 1;
                  {
                    MR_Word base;
                    base = (MR_Word) MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL);
                    *mercury__dir__Result_20 = base;
                    MR_hl_field(MR_mktag(0), base, 0) = mercury__dir__T0_19;
                  }
                }
                break;
            }
          }
      }
    else
      {
        MR_Word mercury__dir__V_58_58;

        *mercury__dir__Continue_18 = (MR_Integer) 0;
        mercury__dir__V_58_58 = (MR_Word) ((MR_Box) ((MR_String) "dir.foldl2 not implemented on this platform"));
        {
          MR_Word base;
          base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
          *mercury__dir__Result_20 = base;
          MR_hl_field(MR_mktag(1), base, 0) = mercury__dir__T0_19;
          MR_hl_field(MR_mktag(1), base, 1) = ((MR_Box) (mercury__dir__V_58_58));
        }
      }
  }
}

MR_String MR_CALL 
mercury__dir__fixup_dirname_1_f_0(
  MR_String mercury__dir__Dir0_3)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_String mercury__dir__Dir_4;
    MR_Word mercury__dir__DirChars_5;
    MR_Word mercury__dir__V_6_6;

    {
      mercury__string__to_char_list_2_p_0(mercury__dir__Dir0_3, &mercury__dir__V_6_6);
    }
    {
      mercury__dir__DirChars_5 = mercury__dir__canonicalize_path_chars_1_f_0(mercury__dir__V_6_6);
    }
    {
      mercury__dir__succeeded = mercury__dir__is_root_directory_1_p_0(mercury__dir__DirChars_5);
    }
    if (mercury__dir__succeeded)
      mercury__dir__Dir_4 = mercury__dir__Dir0_3;
    else
      {
        MR_Word mercury__dir__V_7_7;
        MR_Word mercury__dir__Chars1_11;
        MR_Word mercury__dir__TypeCtorInfo_6_13 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_character_0;
        MR_Char mercury__dir__Sep_12;
        MR_Box mercury__dir__conv0_Sep_12;

        {
          mercury__dir__succeeded = mercury__list__split_last_3_p_0(mercury__dir__TypeCtorInfo_6_13, mercury__dir__DirChars_5, &mercury__dir__Chars1_11, &mercury__dir__conv0_Sep_12);
        }
        if (mercury__dir__succeeded)
          {
            mercury__dir__Sep_12 = ((MR_Char) (MR_Word) mercury__dir__conv0_Sep_12);
            mercury__dir__succeeded = MR_TRUE;
          }
        if (mercury__dir__succeeded)
          {
            mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Sep_12);
          }
        if (mercury__dir__succeeded)
          mercury__dir__V_7_7 = mercury__dir__Chars1_11;
        else
          mercury__dir__V_7_7 = mercury__dir__DirChars_5;
        {
          mercury__string__from_char_list_2_p_0(mercury__dir__V_7_7, &mercury__dir__Dir_4);
        }
      }
    return mercury__dir__Dir_4;
  }
}

static void MR_CALL 
mercury__dir__check_dir_accessibility_4_p_0(
  MR_String mercury__dir__DirName_5,
  MR_Word * mercury__dir__Res_6)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__V_10_10 = (MR_Word) MR_mkword(MR_mktag(1), &mercury__dir_scalar_common_1[3]);

{
#define MR_PROC_LABEL mercury__dir__check_dir_accessibility_4_p_0

	MR_bool SUCCESS_INDICATOR;

		{

    SUCCESS_INDICATOR = MR_FALSE;


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    if (mercury__dir__succeeded)
      {
        mercury__io__check_file_accessibility_dotnet_5_p_0(mercury__dir__DirName_5, mercury__dir__V_10_10, mercury__dir__Res_6);
      }
    else
      {
{
#define MR_PROC_LABEL mercury__dir__check_dir_accessibility_4_p_0

	MR_String FileName;
	MR_Word AccessTypes;
	MR_Word Result;

	FileName =  mercury__dir__DirName_5 ;
	AccessTypes =  mercury__dir__V_10_10 ;
		{

#if defined(MR_HAVE_ACCESS)
  #ifdef F_OK
    int mode = F_OK;
  #else
    int mode = 0;
  #endif
    int access_result;

  #if !defined(MR_WIN32) || defined(MR_CYGWIN)
    /*
    ** Earlier versions of MSVCRT ignored flags it doesn't support,
    ** later versions return an error (e.g. on Vista).
    */
    if (ML_access_types_includes_execute(AccessTypes)) {
      #ifdef X_OK
        mode |= X_OK;
      #else
        mode |= 1;
      #endif
    }
  #endif
    if (ML_access_types_includes_write(AccessTypes)) {
  #ifdef W_OK
        mode |= W_OK;
  #else
        mode |= 2;
  #endif
    }
    if (ML_access_types_includes_read(AccessTypes)) {
  #ifdef R_OK
        mode |= R_OK;
  #else
        mode |= 4;
  #endif
    }

  #ifdef MR_WIN32
    access_result = _waccess(ML_utf8_to_wide(FileName), mode);
  #else
    access_result = access(FileName, mode);
  #endif

    if (access_result == 0) {
        Result = ML_make_io_res_0_ok();
    } else {
        ML_make_io_res_0_error(errno,
            MR_make_string_const("file not accessible: "), &Result);
    }
#else /* !MR_HAVE_ACCESS */
    Result = ML_make_io_res_0_error_msg(
        "io.check_file_accessibility not supported on this platform");
#endif


		;}
#undef MR_PROC_LABEL
	 *mercury__dir__Res_6  = Result;
}
      }
  }
}

static void MR_CALL 
mercury__dir__make_mkdir_res_exists_5_p_0(
  MR_Box mercury__dir__Error_6,
  MR_String mercury__dir__DirName_7,
  MR_Word * mercury__dir__Res_8)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__TypeResult_10;
    MR_Word mercury__dir__V_15_15;

    {
      mercury__io__file_type_5_p_0((MR_Integer) 1, mercury__dir__DirName_7, &mercury__dir__TypeResult_10);
    }
    mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__TypeResult_10)) == (MR_mktag((MR_Integer) 0)));
    if (mercury__dir__succeeded)
      {
        mercury__dir__V_15_15 = ((MR_Word) (MR_hl_field(MR_mktag(0), mercury__dir__TypeResult_10, (MR_Integer) 0)));
        mercury__dir__succeeded = (mercury__dir__V_15_15 == (MR_Integer) 1);
      }
    if (mercury__dir__succeeded)
      {
        MR_Word mercury__dir__V_23_23 = (MR_Word) MR_mkword(MR_mktag(1), &mercury__dir_scalar_common_1[3]);

{
#define MR_PROC_LABEL mercury__dir__make_mkdir_res_exists_5_p_0

	MR_bool SUCCESS_INDICATOR;

		{

    SUCCESS_INDICATOR = MR_FALSE;


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
        if (mercury__dir__succeeded)
          {
            mercury__io__check_file_accessibility_dotnet_5_p_0(mercury__dir__DirName_7, mercury__dir__V_23_23, mercury__dir__Res_8);
          }
        else
          {
{
#define MR_PROC_LABEL mercury__dir__make_mkdir_res_exists_5_p_0

	MR_String FileName;
	MR_Word AccessTypes;
	MR_Word Result;

	FileName =  mercury__dir__DirName_7 ;
	AccessTypes =  mercury__dir__V_23_23 ;
		{

#if defined(MR_HAVE_ACCESS)
  #ifdef F_OK
    int mode = F_OK;
  #else
    int mode = 0;
  #endif
    int access_result;

  #if !defined(MR_WIN32) || defined(MR_CYGWIN)
    /*
    ** Earlier versions of MSVCRT ignored flags it doesn't support,
    ** later versions return an error (e.g. on Vista).
    */
    if (ML_access_types_includes_execute(AccessTypes)) {
      #ifdef X_OK
        mode |= X_OK;
      #else
        mode |= 1;
      #endif
    }
  #endif
    if (ML_access_types_includes_write(AccessTypes)) {
  #ifdef W_OK
        mode |= W_OK;
  #else
        mode |= 2;
  #endif
    }
    if (ML_access_types_includes_read(AccessTypes)) {
  #ifdef R_OK
        mode |= R_OK;
  #else
        mode |= 4;
  #endif
    }

  #ifdef MR_WIN32
    access_result = _waccess(ML_utf8_to_wide(FileName), mode);
  #else
    access_result = access(FileName, mode);
  #endif

    if (access_result == 0) {
        Result = ML_make_io_res_0_ok();
    } else {
        ML_make_io_res_0_error(errno,
            MR_make_string_const("file not accessible: "), &Result);
    }
#else /* !MR_HAVE_ACCESS */
    Result = ML_make_io_res_0_error_msg(
        "io.check_file_accessibility not supported on this platform");
#endif


		;}
#undef MR_PROC_LABEL
	 *mercury__dir__Res_8  = Result;
}
          }
      }
    else
      {
        MR_String mercury__dir__Msg_39;
        MR_Word mercury__dir__V_41_41;

{
#define MR_PROC_LABEL mercury__dir__make_mkdir_res_exists_5_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
        if (mercury__dir__succeeded)
          {
{
#define MR_PROC_LABEL mercury__dir__make_mkdir_res_exists_5_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_6 , Error);
	Msg0 =  (MR_String) "dir.make_directory failed: " ;
		{

    ML_maybe_make_win32_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_39  = Msg;
}
          }
        else
          {
{
#define MR_PROC_LABEL mercury__dir__make_mkdir_res_exists_5_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_6 , Error);
	Msg0 =  (MR_String) "dir.make_directory failed: " ;
		{

    ML_maybe_make_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_39  = Msg;
}
          }
        mercury__dir__V_41_41 = (MR_Word) mercury__dir__Msg_39;
        {
          MR_Word base;
          base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
          *mercury__dir__Res_8 = base;
          MR_hl_field(MR_mktag(1), base, 0) = ((MR_Box) (mercury__dir__V_41_41));
        }
      }
  }
}

static void MR_CALL 
mercury__dir__make_mkdir_res_error_4_p_0(
  MR_Box mercury__dir__Error_5,
  MR_Word * mercury__dir__HeadVar__2_2)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_String mercury__dir__Msg_6;
    MR_Word mercury__dir__V_10_10;

{
#define MR_PROC_LABEL mercury__dir__make_mkdir_res_error_4_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    if (mercury__dir__succeeded)
      {
{
#define MR_PROC_LABEL mercury__dir__make_mkdir_res_error_4_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_5 , Error);
	Msg0 =  (MR_String) "dir.make_directory failed: " ;
		{

    ML_maybe_make_win32_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_6  = Msg;
}
      }
    else
      {
{
#define MR_PROC_LABEL mercury__dir__make_mkdir_res_error_4_p_0

	MR_Integer Error;
	MR_String Msg0;
	MR_String Msg;

	MR_MAYBE_UNBOX_FOREIGN_TYPE(MR_Integer, mercury__dir__Error_5 , Error);
	Msg0 =  (MR_String) "dir.make_directory failed: " ;
		{

    ML_maybe_make_err_msg(MR_TRUE, Error, Msg0, MR_ALLOC_ID, Msg);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Msg_6  = Msg;
}
      }
    mercury__dir__V_10_10 = (MR_Word) mercury__dir__Msg_6;
    {
      MR_Word base;
      base = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 1 * sizeof(MR_Word)), NULL, NULL));
      *mercury__dir__HeadVar__2_2 = base;
      MR_hl_field(MR_mktag(1), base, 0) = ((MR_Box) (mercury__dir__V_10_10));
    }
  }
}

static MR_Word MR_CALL 
mercury__dir__make_mkdir_res_ok_0_f_0(void)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__HeadVar__1_1 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));

    return mercury__dir__HeadVar__1_1;
  }
}

void MR_CALL 
mercury__dir__make_single_directory_2_5_p_0(
  MR_Integer mercury__dir__ErrorIfExists_1,
  MR_String mercury__dir__DirName_2,
  MR_Word * mercury__dir__Result_3)
{
  {
    MR_bool mercury__dir__succeeded;

{
#define MR_PROC_LABEL mercury__dir__make_single_directory_2_5_p_0

	MR_Integer ErrorIfExists;
	MR_String DirName;
	MR_Word Result;

	ErrorIfExists =  mercury__dir__ErrorIfExists_1 ;
	DirName =  mercury__dir__DirName_2 ;
		{

#if defined(MR_WIN32)
    if (CreateDirectoryW(ML_utf8_to_wide(DirName), NULL)) {
        Result = ML_make_mkdir_res_ok();
    } else {
        int error;

        error = GetLastError();
        if (!ErrorIfExists && error == ERROR_ALREADY_EXISTS) {
            ML_make_mkdir_res_exists(error, DirName, &Result);
        } else {
            ML_make_mkdir_res_error(error, &Result);
        }
    }
#elif defined(MR_HAVE_MKDIR)
    if (mkdir(DirName, 0777) == 0) {
        Result = ML_make_mkdir_res_ok();
  #ifdef EEXIST
    } else if (!ErrorIfExists && errno == EEXIST) {
        ML_make_mkdir_res_exists(errno, DirName, &Result);
  #endif /* EEXIST */
    } else {
        ML_make_mkdir_res_error(errno, &Result);
    }
#else /* !MR_WIN32 && !MR_HAVE_MKDIR */
    MR_fatal_error(
        "dir.make_single_directory_2 called but not supported");
#endif


		;}
#undef MR_PROC_LABEL
	 *mercury__dir__Result_3  = Result;
}
  }
}

static MR_bool MR_CALL 
mercury__dir__can_implement_make_directory_0_p_0(void)
{
  {
    MR_bool mercury__dir__succeeded;

{
#define MR_PROC_LABEL mercury__dir__can_implement_make_directory_0_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#elif defined(MR_HAVE_MKDIR)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    return mercury__dir__succeeded;
  }
}

MR_bool MR_CALL 
mercury__dir__is_root_directory_1_p_0(
  MR_Word mercury__dir__FileName_2)
{
  {
    MR_bool mercury__dir__succeeded;

{
#define MR_PROC_LABEL mercury__dir__is_root_directory_1_p_0

	MR_bool SUCCESS_INDICATOR;

		{

    SUCCESS_INDICATOR = MR_FALSE;


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    if (mercury__dir__succeeded)
      {
        MR_String mercury__dir__V_4_4;

        {
          mercury__string__from_char_list_2_p_0(mercury__dir__FileName_2, &mercury__dir__V_4_4);
        }
        {
          mercury__dir__succeeded = mercury__dir__path_name_is_absolute_1_p_0(mercury__dir__V_4_4);
        }
        if (mercury__dir__succeeded)
          {
            {
              mercury__require__unexpected_2_p_0((MR_String) "predicate \140dir.is_dotnet_root_directory_2\'/1", (MR_String) "called for non-.NET CLI backend");
            }
            mercury__dir__succeeded = MR_TRUE;
          }
      }
    else
      {
        {
          MR_Char mercury__dir__V_29_29;

{
#define MR_PROC_LABEL mercury__dir__is_root_directory_1_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
          if (mercury__dir__succeeded)
            mercury__dir__V_29_29 = (MR_Char) 92;
          else
            mercury__dir__V_29_29 = (MR_Char) 47;
          mercury__dir__succeeded = (mercury__dir__V_29_29 == (MR_Char) 92);
        }
        if (!(mercury__dir__succeeded))
          {
{
#define MR_PROC_LABEL mercury__dir__is_root_directory_1_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_CYGWIN)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
          }
        if (mercury__dir__succeeded)
          {
            MR_Word mercury__dir__TypeInfo_8_8;
            MR_Word mercury__dir__V_5_5 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
            MR_Word mercury__dir__V_7_7;
            MR_Word mercury__dir__STATE_VARIABLE_FileName_6_33;
            MR_Char mercury__dir__Letter_37;
            MR_Char mercury__dir__Sep_38;
            MR_Word mercury__dir__V_41_41;
            MR_Char mercury__dir__V_42_42;
            MR_Word mercury__dir__V_43_43;

            mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__FileName_2)) == (MR_mktag((MR_Integer) 1)));
            if (mercury__dir__succeeded)
              {
                mercury__dir__Letter_37 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName_2, (MR_Integer) 0)));
                mercury__dir__V_41_41 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName_2, (MR_Integer) 1)));
                mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__V_41_41)) == (MR_mktag((MR_Integer) 1)));
                if (mercury__dir__succeeded)
                  {
                    mercury__dir__V_42_42 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_41_41, (MR_Integer) 0)));
                    mercury__dir__V_43_43 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_41_41, (MR_Integer) 1)));
                    mercury__dir__succeeded = (mercury__dir__V_42_42 == (MR_Char) 58);
                    if (mercury__dir__succeeded)
                      {
                        mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__V_43_43)) == (MR_mktag((MR_Integer) 1)));
                        if (mercury__dir__succeeded)
                          {
                            mercury__dir__Sep_38 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_43_43, (MR_Integer) 0)));
                            mercury__dir__STATE_VARIABLE_FileName_6_33 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_43_43, (MR_Integer) 1)));
                            {
                              mercury__dir__succeeded = mercury__char__is_alpha_1_p_0(mercury__dir__Letter_37);
                            }
                            if (mercury__dir__succeeded)
                              {
                                mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Sep_38);
                              }
                          }
                      }
                  }
              }
            if (mercury__dir__succeeded)
              {
                mercury__dir__V_7_7 = mercury__dir__STATE_VARIABLE_FileName_6_33;
                mercury__dir__succeeded = MR_TRUE;
              }
            else
              {
                MR_Word mercury__dir__STATE_VARIABLE_FileName_7_34;
                MR_Char mercury__dir__Sep_45;
                MR_Word mercury__dir__Server_47;
                MR_Word mercury__dir__STATE_VARIABLE_FileName_0_55;
                MR_Word mercury__dir__V_56_56;
                MR_Word mercury__dir__STATE_VARIABLE_FileName_17_58;
                MR_Char mercury__dir__V_72_72;
                MR_Char mercury__dir__V_48_48;
                MR_Word mercury__dir__V_49_49;

                mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__FileName_2)) == (MR_mktag((MR_Integer) 1)));
                if (mercury__dir__succeeded)
                  {
                    mercury__dir__Sep_45 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName_2, (MR_Integer) 0)));
                    mercury__dir__V_56_56 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName_2, (MR_Integer) 1)));
                    mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__V_56_56)) == (MR_mktag((MR_Integer) 1)));
                    if (mercury__dir__succeeded)
                      {
                        mercury__dir__V_72_72 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_56_56, (MR_Integer) 0)));
                        mercury__dir__STATE_VARIABLE_FileName_0_55 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_56_56, (MR_Integer) 1)));
                        mercury__dir__succeeded = (mercury__dir__Sep_45 == mercury__dir__V_72_72);
                        if (mercury__dir__succeeded)
                          {
                            {
                              mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Sep_45);
                            }
                            if (mercury__dir__succeeded)
                              {
                                {
                                  mercury__dir__take_while__ho7_4_p_in__list_0(mercury__dir__STATE_VARIABLE_FileName_0_55, &mercury__dir__Server_47, &mercury__dir__STATE_VARIABLE_FileName_17_58);
                                }
                                mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__Server_47)) == (MR_mktag((MR_Integer) 1)));
                                if (mercury__dir__succeeded)
                                  {
                                    mercury__dir__V_48_48 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__Server_47, (MR_Integer) 0)));
                                    mercury__dir__V_49_49 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__Server_47, (MR_Integer) 1)));
                                    if ((mercury__dir__STATE_VARIABLE_FileName_17_58 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
                                      {
                                        mercury__dir__STATE_VARIABLE_FileName_7_34 = mercury__dir__STATE_VARIABLE_FileName_17_58;
                                        mercury__dir__succeeded = MR_TRUE;
                                      }
                                    else
                                      {
                                        MR_Word mercury__dir__STATE_VARIABLE_FileName_19_60 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__STATE_VARIABLE_FileName_17_58, (MR_Integer) 1)));
                                        MR_Char mercury__dir__V_73_73 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__STATE_VARIABLE_FileName_17_58, (MR_Integer) 0)));

                                        mercury__dir__succeeded = (mercury__dir__Sep_45 == mercury__dir__V_73_73);
                                        if (mercury__dir__succeeded)
                                          {
                                            if ((mercury__dir__STATE_VARIABLE_FileName_19_60 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
                                              {
                                                mercury__dir__STATE_VARIABLE_FileName_7_34 = mercury__dir__STATE_VARIABLE_FileName_19_60;
                                                mercury__dir__succeeded = MR_TRUE;
                                              }
                                            else
                                              {
                                                MR_Word mercury__dir__Share_52;
                                                MR_Word mercury__dir__STATE_VARIABLE_FileName_21_62;
                                                MR_Char mercury__dir__V_53_53;
                                                MR_Word mercury__dir__V_54_54;

                                                {
                                                  mercury__dir__take_while__ho6_4_p_in__list_0(mercury__dir__STATE_VARIABLE_FileName_19_60, &mercury__dir__Share_52, &mercury__dir__STATE_VARIABLE_FileName_21_62);
                                                }
                                                mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__Share_52)) == (MR_mktag((MR_Integer) 1)));
                                                if (mercury__dir__succeeded)
                                                  {
                                                    mercury__dir__V_53_53 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__Share_52, (MR_Integer) 0)));
                                                    mercury__dir__V_54_54 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__Share_52, (MR_Integer) 1)));
                                                    if ((mercury__dir__STATE_VARIABLE_FileName_21_62 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
                                                      {
                                                        mercury__dir__STATE_VARIABLE_FileName_7_34 = mercury__dir__STATE_VARIABLE_FileName_21_62;
                                                        mercury__dir__succeeded = MR_TRUE;
                                                      }
                                                    else
                                                      {
                                                        MR_Char mercury__dir__V_74_74 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__STATE_VARIABLE_FileName_21_62, (MR_Integer) 0)));

                                                        mercury__dir__STATE_VARIABLE_FileName_7_34 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__STATE_VARIABLE_FileName_21_62, (MR_Integer) 1)));
                                                        mercury__dir__succeeded = (mercury__dir__Sep_45 == mercury__dir__V_74_74);
                                                      }
                                                  }
                                              }
                                          }
                                      }
                                  }
                              }
                          }
                      }
                  }
                if (mercury__dir__succeeded)
                  {
                    mercury__dir__V_7_7 = mercury__dir__STATE_VARIABLE_FileName_7_34;
                    mercury__dir__succeeded = MR_TRUE;
                  }
                else
                  {
                    MR_Char mercury__dir__Char1_76;
                    MR_Word mercury__dir__STATE_VARIABLE_FileName_0_79;

                    mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__FileName_2)) == (MR_mktag((MR_Integer) 1)));
                    if (mercury__dir__succeeded)
                      {
                        mercury__dir__Char1_76 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName_2, (MR_Integer) 0)));
                        mercury__dir__STATE_VARIABLE_FileName_0_79 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName_2, (MR_Integer) 1)));
                        {
                          mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Char1_76);
                        }
                        if (mercury__dir__succeeded)
                          {
                            if ((mercury__dir__STATE_VARIABLE_FileName_0_79 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
                              {
                                mercury__dir__V_7_7 = mercury__dir__STATE_VARIABLE_FileName_0_79;
                                mercury__dir__succeeded = MR_TRUE;
                              }
                            else
                              {
                                MR_Char mercury__dir__Char2_78 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__STATE_VARIABLE_FileName_0_79, (MR_Integer) 0)));

                                mercury__dir__V_7_7 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__STATE_VARIABLE_FileName_0_79, (MR_Integer) 1)));
                                {
                                  mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Char2_78);
                                }
                                mercury__dir__succeeded = !(mercury__dir__succeeded);
                              }
                          }
                      }
                  }
              }
            if (mercury__dir__succeeded)
              {
                mercury__dir__TypeInfo_8_8 = (MR_Word) &mercury__dir_scalar_common_1[0];
                {
                  mercury__dir__succeeded = mercury__builtin__unify_2_p_0(mercury__dir__TypeInfo_8_8, ((MR_Box) (mercury__dir__V_5_5)), ((MR_Box) (mercury__dir__V_7_7)));
                }
              }
          }
        else
          {
            MR_Char mercury__dir__Char_3;
            MR_Word mercury__dir__V_6_6;

            mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__FileName_2)) == (MR_mktag((MR_Integer) 1)));
            if (mercury__dir__succeeded)
              {
                mercury__dir__Char_3 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName_2, (MR_Integer) 0)));
                mercury__dir__V_6_6 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName_2, (MR_Integer) 1)));
                mercury__dir__succeeded = (mercury__dir__V_6_6 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0))));
                if (mercury__dir__succeeded)
                  {
                    mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Char_3);
                  }
              }
          }
      }
    return mercury__dir__succeeded;
  }
}

static MR_Word MR_CALL 
mercury__dir__canonicalize_path_chars_2_2_f_0(
  MR_Word mercury__dir__HeadVar__1_1,
  MR_Word mercury__dir__HeadVar__2_2)
{
  while (MR_TRUE)
    {
      /* tailcall optimized into a loop */
      {
        MR_bool mercury__dir__succeeded;
        MR_Word mercury__dir__HeadVar__3_3;

        if ((mercury__dir__HeadVar__1_1 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
          {
            MR_Word mercury__dir__TypeCtorInfo_12_12 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_character_0;

            {
              mercury__list__reverse_2_p_0(mercury__dir__TypeCtorInfo_12_12, mercury__dir__HeadVar__2_2, &mercury__dir__HeadVar__3_3);
            }
          }
        else
          {
            MR_Char mercury__dir__C0_5 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__1_1, (MR_Integer) 0)));
            MR_Word mercury__dir__FileName0_6 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__HeadVar__1_1, (MR_Integer) 1)));
            MR_Word mercury__dir__RevFileName_8;
            MR_Char mercury__dir__C_9;
            MR_Char mercury__dir__C2_10;
            MR_Word mercury__dir__V_11_11;

{
#define MR_PROC_LABEL mercury__dir__canonicalize_path_chars_2_2_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_CYGWIN)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
            mercury__dir__succeeded = !(mercury__dir__succeeded);
            if (mercury__dir__succeeded)
              {
                mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__C0_5);
              }
            if (mercury__dir__succeeded)
              {
{
#define MR_PROC_LABEL mercury__dir__canonicalize_path_chars_2_2_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
                if (mercury__dir__succeeded)
                  mercury__dir__C_9 = (MR_Char) 92;
                else
                  mercury__dir__C_9 = (MR_Char) 47;
              }
            else
              mercury__dir__C_9 = mercury__dir__C0_5;
            {
              mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__C_9);
            }
            if (mercury__dir__succeeded)
              {
                mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__FileName0_6)) == (MR_mktag((MR_Integer) 1)));
                if (mercury__dir__succeeded)
                  {
                    mercury__dir__C2_10 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName0_6, (MR_Integer) 0)));
                    mercury__dir__V_11_11 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName0_6, (MR_Integer) 1)));
                    {
                      mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__C2_10);
                    }
                  }
              }
            if (mercury__dir__succeeded)
              mercury__dir__RevFileName_8 = mercury__dir__HeadVar__2_2;
            else
              {
                mercury__dir__RevFileName_8 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                MR_hl_field(MR_mktag(1), mercury__dir__RevFileName_8, 0) = ((MR_Box) (MR_Word) (mercury__dir__C_9));
                MR_hl_field(MR_mktag(1), mercury__dir__RevFileName_8, 1) = ((MR_Box) (mercury__dir__HeadVar__2_2));
              }
            /* direct tailcall eliminated */
            {
              MR_Word mercury__dir__HeadVar__1__tmp_copy_1 = mercury__dir__FileName0_6;
              MR_Word mercury__dir__HeadVar__2__tmp_copy_2 = mercury__dir__RevFileName_8;

              mercury__dir__HeadVar__2_2 = mercury__dir__HeadVar__2__tmp_copy_2;
              mercury__dir__HeadVar__1_1 = mercury__dir__HeadVar__1__tmp_copy_1;
            }
            continue;
          }
        return mercury__dir__HeadVar__3_3;
      }
      break;
    }
}

MR_Word MR_CALL 
mercury__dir__canonicalize_path_chars_1_f_0(
  MR_Word mercury__dir__FileName0_3)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__FileName_4;
    MR_Char mercury__dir__Char1_5;
    MR_Word mercury__dir__FileName1_6;

    {
      MR_Char mercury__dir__V_14_14;

{
#define MR_PROC_LABEL mercury__dir__canonicalize_path_chars_1_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
      if (mercury__dir__succeeded)
        mercury__dir__V_14_14 = (MR_Char) 92;
      else
        mercury__dir__V_14_14 = (MR_Char) 47;
      mercury__dir__succeeded = (mercury__dir__V_14_14 == (MR_Char) 92);
    }
    if (!(mercury__dir__succeeded))
      {
{
#define MR_PROC_LABEL mercury__dir__canonicalize_path_chars_1_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_CYGWIN)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
      }
    if (mercury__dir__succeeded)
      {
        mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__FileName0_3)) == (MR_mktag((MR_Integer) 1)));
        if (mercury__dir__succeeded)
          {
            mercury__dir__Char1_5 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName0_3, (MR_Integer) 0)));
            mercury__dir__FileName1_6 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName0_3, (MR_Integer) 1)));
            {
              mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Char1_5);
            }
          }
      }
    if (mercury__dir__succeeded)
      {
        MR_Char mercury__dir__CanonicalChar1_7;
        MR_Word mercury__dir__FileName2_8;
        MR_Word mercury__dir__V_10_10;
        MR_Char mercury__dir__Char2_9;
        MR_Word mercury__dir__V_11_11;

{
#define MR_PROC_LABEL mercury__dir__canonicalize_path_chars_1_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_CYGWIN)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
        if (mercury__dir__succeeded)
          mercury__dir__CanonicalChar1_7 = mercury__dir__Char1_5;
        else
          {
{
#define MR_PROC_LABEL mercury__dir__canonicalize_path_chars_1_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
            if (mercury__dir__succeeded)
              mercury__dir__CanonicalChar1_7 = (MR_Char) 92;
            else
              mercury__dir__CanonicalChar1_7 = (MR_Char) 47;
          }
        mercury__dir__V_10_10 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
        {
          mercury__dir__FileName2_8 = mercury__dir__canonicalize_path_chars_2_2_f_0(mercury__dir__FileName1_6, mercury__dir__V_10_10);
        }
        mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__FileName2_8)) == (MR_mktag((MR_Integer) 1)));
        if (mercury__dir__succeeded)
          {
            mercury__dir__Char2_9 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName2_8, (MR_Integer) 0)));
            mercury__dir__V_11_11 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileName2_8, (MR_Integer) 1)));
            mercury__dir__succeeded = (mercury__dir__V_11_11 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0))));
            if (mercury__dir__succeeded)
              {
                mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Char2_9);
              }
          }
        if (mercury__dir__succeeded)
          {
            MR_Word mercury__dir__V_12_12 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));

            {
              mercury__dir__FileName_4 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
              MR_hl_field(MR_mktag(1), mercury__dir__FileName_4, 0) = ((MR_Box) (MR_Word) (mercury__dir__CanonicalChar1_7));
              MR_hl_field(MR_mktag(1), mercury__dir__FileName_4, 1) = ((MR_Box) (mercury__dir__V_12_12));
            }
          }
        else
          {
            mercury__dir__FileName_4 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
            MR_hl_field(MR_mktag(1), mercury__dir__FileName_4, 0) = ((MR_Box) (MR_Word) (mercury__dir__CanonicalChar1_7));
            MR_hl_field(MR_mktag(1), mercury__dir__FileName_4, 1) = ((MR_Box) (mercury__dir__FileName2_8));
          }
      }
    else
      {
        MR_Word mercury__dir__V_13_13 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));

        {
          mercury__dir__FileName_4 = mercury__dir__canonicalize_path_chars_2_2_f_0(mercury__dir__FileName0_3, mercury__dir__V_13_13);
        }
      }
    return mercury__dir__FileName_4;
  }
}

MR_bool MR_CALL 
mercury__dir__split_name_2_3_p_0(
  MR_Word mercury__dir__FileNameChars0_4,
  MR_String * mercury__dir__DirName_5,
  MR_String * mercury__dir__BaseName_6)
{
  {
    MR_bool mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__FileNameChars0_4)) == (MR_mktag((MR_Integer) 1)));
    MR_Word mercury__dir__FileNameWithoutSlash_9;
    MR_Char mercury__dir__V_7_7;
    MR_Word mercury__dir__V_8_8;
    MR_Word mercury__dir__Chars1_20;
    MR_Word mercury__dir__TypeCtorInfo_6_22;
    MR_Char mercury__dir__Sep_21;
    MR_Box mercury__dir__conv0_Sep_21;
    MR_Word mercury__dir__TypeInfo_17_17;
    MR_String mercury__dir__V_10_10;
    MR_Word mercury__dir__V_14_14;
    MR_Word mercury__dir__TypeInfo_18_18;
    MR_String mercury__dir__V_11_11;
    MR_Word mercury__dir__V_16_16;

    if (mercury__dir__succeeded)
      {
        mercury__dir__V_7_7 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileNameChars0_4, (MR_Integer) 0)));
        mercury__dir__V_8_8 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileNameChars0_4, (MR_Integer) 1)));
        mercury__dir__TypeCtorInfo_6_22 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_character_0;
        {
          mercury__dir__succeeded = mercury__list__split_last_3_p_0(mercury__dir__TypeCtorInfo_6_22, mercury__dir__FileNameChars0_4, &mercury__dir__Chars1_20, &mercury__dir__conv0_Sep_21);
        }
        if (mercury__dir__succeeded)
          {
            mercury__dir__Sep_21 = ((MR_Char) (MR_Word) mercury__dir__conv0_Sep_21);
            mercury__dir__succeeded = MR_TRUE;
          }
        if (mercury__dir__succeeded)
          {
            mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Sep_21);
          }
        if (mercury__dir__succeeded)
          mercury__dir__FileNameWithoutSlash_9 = mercury__dir__Chars1_20;
        else
          mercury__dir__FileNameWithoutSlash_9 = mercury__dir__FileNameChars0_4;
        mercury__dir__V_10_10 = (MR_String) ".";
        {
          mercury__string__to_char_list_2_p_0(mercury__dir__V_10_10, &mercury__dir__V_14_14);
        }
        mercury__dir__TypeInfo_17_17 = (MR_Word) &mercury__dir_scalar_common_1[0];
        {
          mercury__dir__succeeded = mercury__builtin__unify_2_p_0(mercury__dir__TypeInfo_17_17, ((MR_Box) (mercury__dir__FileNameWithoutSlash_9)), ((MR_Box) (mercury__dir__V_14_14)));
        }
        mercury__dir__succeeded = !(mercury__dir__succeeded);
        if (mercury__dir__succeeded)
          {
            mercury__dir__V_11_11 = (MR_String) "..";
            {
              mercury__string__to_char_list_2_p_0(mercury__dir__V_11_11, &mercury__dir__V_16_16);
            }
            mercury__dir__TypeInfo_18_18 = (MR_Word) &mercury__dir_scalar_common_1[0];
            {
              mercury__dir__succeeded = mercury__builtin__unify_2_p_0(mercury__dir__TypeInfo_18_18, ((MR_Box) (mercury__dir__FileNameWithoutSlash_9)), ((MR_Box) (mercury__dir__V_16_16)));
            }
            mercury__dir__succeeded = !(mercury__dir__succeeded);
            if (mercury__dir__succeeded)
              {
{
#define MR_PROC_LABEL mercury__dir__split_name_2_3_p_0

	MR_bool SUCCESS_INDICATOR;

		{

    SUCCESS_INDICATOR = MR_FALSE;


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
                if (mercury__dir__succeeded)
                  {
                    MR_String mercury__dir__V_12_12;

                    {
                      mercury__string__from_char_list_2_p_0(mercury__dir__FileNameWithoutSlash_9, &mercury__dir__V_12_12);
                    }
                    *mercury__dir__DirName_5 = (MR_String) "";
                    *mercury__dir__BaseName_6 = (MR_String) "";
{
#define MR_PROC_LABEL mercury__dir__split_name_2_3_p_0

	MR_bool SUCCESS_INDICATOR;

		{

    SUCCESS_INDICATOR = MR_FALSE;


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
                  }
                else
                  {
                    MR_Word mercury__dir__TypeCtorInfo_36_62 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_character_0;
                    MR_Word mercury__dir__RevFileNameChars0_33;
                    MR_Word mercury__dir__RevFileNameChars_36;
                    MR_Word mercury__dir__RevFileNameChars1_35;
                    MR_Char mercury__dir__LastChar_34;
                    MR_Word mercury__dir__RevBaseName_37;
                    MR_Word mercury__dir__RevDirName0_38;
                    MR_Char mercury__dir__V_39_39;
                    MR_Word mercury__dir__V_40_40;
                    MR_Char mercury__dir__V_41_41;
                    MR_Word mercury__dir__V_42_42;

                    {
                      mercury__list__reverse_2_p_0(mercury__dir__TypeCtorInfo_36_62, mercury__dir__FileNameChars0_4, &mercury__dir__RevFileNameChars0_33);
                    }
                    mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__RevFileNameChars0_33)) == (MR_mktag((MR_Integer) 1)));
                    if (mercury__dir__succeeded)
                      {
                        mercury__dir__LastChar_34 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__RevFileNameChars0_33, (MR_Integer) 0)));
                        mercury__dir__RevFileNameChars1_35 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__RevFileNameChars0_33, (MR_Integer) 1)));
                        {
                          mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__LastChar_34);
                        }
                      }
                    if (mercury__dir__succeeded)
                      mercury__dir__RevFileNameChars_36 = mercury__dir__RevFileNameChars1_35;
                    else
                      mercury__dir__RevFileNameChars_36 = mercury__dir__RevFileNameChars0_33;
                    {
                      mercury__dir__take_while__ho8_4_p_in__list_0(mercury__dir__RevFileNameChars_36, &mercury__dir__RevBaseName_37, &mercury__dir__RevDirName0_38);
                    }
                    mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__RevBaseName_37)) == (MR_mktag((MR_Integer) 1)));
                    if (mercury__dir__succeeded)
                      {
                        mercury__dir__V_39_39 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__RevBaseName_37, (MR_Integer) 0)));
                        mercury__dir__V_40_40 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__RevBaseName_37, (MR_Integer) 1)));
                        mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__RevDirName0_38)) == (MR_mktag((MR_Integer) 1)));
                        if (mercury__dir__succeeded)
                          {
                            mercury__dir__V_41_41 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__RevDirName0_38, (MR_Integer) 0)));
                            mercury__dir__V_42_42 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__RevDirName0_38, (MR_Integer) 1)));
                          }
                      }
                    if (mercury__dir__succeeded)
                      {
                        MR_Word mercury__dir__RevDirName_46;
                        MR_Word mercury__dir__RevDirName1_44 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__RevDirName0_38, (MR_Integer) 1)));
                        MR_Char mercury__dir__Sep_43 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__RevDirName0_38, (MR_Integer) 0)));

                        {
                          mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Sep_43);
                        }
                        if (mercury__dir__succeeded)
                          {
                            {
                              MR_Char mercury__dir__Drive_45;
                              MR_Char mercury__dir__V_52_52;
                              MR_Word mercury__dir__V_53_53;
                              MR_Word mercury__dir__V_54_54;

                              {
                                MR_Char mercury__dir__V_68_68;

{
#define MR_PROC_LABEL mercury__dir__split_name_2_3_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
                                if (mercury__dir__succeeded)
                                  mercury__dir__V_68_68 = (MR_Char) 92;
                                else
                                  mercury__dir__V_68_68 = (MR_Char) 47;
                                mercury__dir__succeeded = (mercury__dir__V_68_68 == (MR_Char) 92);
                              }
                              if (!(mercury__dir__succeeded))
                                {
{
#define MR_PROC_LABEL mercury__dir__split_name_2_3_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_CYGWIN)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
                                }
                              if (mercury__dir__succeeded)
                                {
                                  mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__RevDirName1_44)) == (MR_mktag((MR_Integer) 1)));
                                  if (mercury__dir__succeeded)
                                    {
                                      mercury__dir__V_52_52 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__RevDirName1_44, (MR_Integer) 0)));
                                      mercury__dir__V_53_53 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__RevDirName1_44, (MR_Integer) 1)));
                                      mercury__dir__succeeded = (mercury__dir__V_52_52 == (MR_Char) 58);
                                      if (mercury__dir__succeeded)
                                        {
                                          mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__V_53_53)) == (MR_mktag((MR_Integer) 1)));
                                          if (mercury__dir__succeeded)
                                            {
                                              mercury__dir__Drive_45 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_53_53, (MR_Integer) 0)));
                                              mercury__dir__V_54_54 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_53_53, (MR_Integer) 1)));
                                              mercury__dir__succeeded = (mercury__dir__V_54_54 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0))));
                                              if (mercury__dir__succeeded)
                                                {
                                                  mercury__dir__succeeded = mercury__char__is_alpha_1_p_0(mercury__dir__Drive_45);
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            if (!(mercury__dir__succeeded))
                              mercury__dir__succeeded = (mercury__dir__RevDirName1_44 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0))));
                          }
                        mercury__dir__succeeded = !(mercury__dir__succeeded);
                        if (mercury__dir__succeeded)
                          mercury__dir__RevDirName_46 = mercury__dir__RevDirName1_44;
                        else
                          mercury__dir__RevDirName_46 = mercury__dir__RevDirName0_38;
                        {
                          mercury__string__from_rev_char_list_2_p_0(mercury__dir__RevBaseName_37, mercury__dir__BaseName_6);
                        }
                        {
                          mercury__string__from_rev_char_list_2_p_0(mercury__dir__RevDirName_46, mercury__dir__DirName_5);
                        }
                        mercury__dir__succeeded = MR_TRUE;
                      }
                    else
                      {
                        MR_Word mercury__dir__BaseNameChars_47;
                        MR_Char mercury__dir__BaseNameFirst_48;
                        MR_Word mercury__dir__V_55_55;
                        MR_Char mercury__dir__V_56_56;
                        MR_Word mercury__dir__V_57_57;
                        MR_Word mercury__dir__V_58_58;
                        MR_Char mercury__dir__V_59_59;
                        MR_Word mercury__dir__V_60_60;
                        MR_Char mercury__dir__Drive_61;
                        MR_Char mercury__dir__V_73_73;
                        MR_Word mercury__dir__V_49_49;

{
#define MR_PROC_LABEL mercury__dir__split_name_2_3_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
                        if (mercury__dir__succeeded)
                          mercury__dir__V_73_73 = (MR_Char) 92;
                        else
                          mercury__dir__V_73_73 = (MR_Char) 47;
                        mercury__dir__succeeded = (mercury__dir__V_73_73 == (MR_Char) 92);
                        if (mercury__dir__succeeded)
                          {
                            mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__FileNameChars0_4)) == (MR_mktag((MR_Integer) 1)));
                            if (mercury__dir__succeeded)
                              {
                                mercury__dir__Drive_61 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileNameChars0_4, (MR_Integer) 0)));
                                mercury__dir__V_55_55 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileNameChars0_4, (MR_Integer) 1)));
                                mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__V_55_55)) == (MR_mktag((MR_Integer) 1)));
                                if (mercury__dir__succeeded)
                                  {
                                    mercury__dir__V_56_56 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_55_55, (MR_Integer) 0)));
                                    mercury__dir__BaseNameChars_47 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_55_55, (MR_Integer) 1)));
                                    mercury__dir__succeeded = (mercury__dir__V_56_56 == (MR_Char) 58);
                                    if (mercury__dir__succeeded)
                                      {
                                        {
                                          mercury__dir__succeeded = mercury__char__is_alpha_1_p_0(mercury__dir__Drive_61);
                                        }
                                        if (mercury__dir__succeeded)
                                          {
                                            mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__BaseNameChars_47)) == (MR_mktag((MR_Integer) 1)));
                                            if (mercury__dir__succeeded)
                                              {
                                                mercury__dir__BaseNameFirst_48 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__BaseNameChars_47, (MR_Integer) 0)));
                                                mercury__dir__V_49_49 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__BaseNameChars_47, (MR_Integer) 1)));
                                                {
                                                  mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__BaseNameFirst_48);
                                                }
                                                mercury__dir__succeeded = !(mercury__dir__succeeded);
                                                if (mercury__dir__succeeded)
                                                  {
                                                    {
                                                      mercury__string__from_char_list_2_p_0(mercury__dir__BaseNameChars_47, mercury__dir__BaseName_6);
                                                    }
                                                    mercury__dir__V_59_59 = (MR_Char) 58;
                                                    mercury__dir__V_60_60 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
                                                    mercury__dir__V_58_58 = (MR_Word) MR_mkword(MR_mktag(1), &mercury__dir_scalar_common_1[6]);
                                                    {
                                                      mercury__dir__V_57_57 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                                                      MR_hl_field(MR_mktag(1), mercury__dir__V_57_57, 0) = ((MR_Box) (MR_Word) (mercury__dir__Drive_61));
                                                      MR_hl_field(MR_mktag(1), mercury__dir__V_57_57, 1) = ((MR_Box) (mercury__dir__V_58_58));
                                                    }
                                                    {
                                                      mercury__string__from_char_list_2_p_0(mercury__dir__V_57_57, mercury__dir__DirName_5);
                                                    }
                                                    mercury__dir__succeeded = MR_TRUE;
                                                  }
                                              }
                                          }
                                      }
                                  }
                              }
                          }
                      }
                  }
              }
          }
      }
    return mercury__dir__succeeded;
  }
}

MR_Char MR_CALL 
mercury__dir__alt_directory_separator_0_f_0(void)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Char mercury__dir__HeadVar__1_1;

{
#define MR_PROC_LABEL mercury__dir__alt_directory_separator_0_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_CYGWIN)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    if (mercury__dir__succeeded)
      mercury__dir__HeadVar__1_1 = (MR_Char) 92;
    else
      mercury__dir__HeadVar__1_1 = (MR_Char) 47;
    return mercury__dir__HeadVar__1_1;
  }
}

MR_bool MR_CALL 
mercury__dir__use_windows_paths_0_p_0(void)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Char mercury__dir__V_1_1;

{
#define MR_PROC_LABEL mercury__dir__use_windows_paths_0_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    if (mercury__dir__succeeded)
      mercury__dir__V_1_1 = (MR_Char) 92;
    else
      mercury__dir__V_1_1 = (MR_Char) 47;
    mercury__dir__succeeded = (mercury__dir__V_1_1 == (MR_Char) 92);
    return mercury__dir__succeeded;
  }
}

MR_Word MR_CALL 
mercury__dir__expand_braces_1_f_0(
  MR_String mercury__dir__ArgStr_3)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__ExpandStrs_4;
    MR_Word mercury__dir__ArgChar_5;
    MR_Word mercury__dir__ExpandChars_6;
    MR_Word mercury__dir__V_15_15;
    MR_Word mercury__dir__V_16_16;
    MR_Word mercury__dir__V_17_17;

    {
      mercury__string__to_char_list_2_p_0(mercury__dir__ArgStr_3, &mercury__dir__ArgChar_5);
    }
    mercury__dir__V_16_16 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
    mercury__dir__V_17_17 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
    mercury__dir__V_15_15 = (MR_Word) MR_mkword(MR_mktag(1), &mercury__dir_scalar_common_1[5]);
    {
      mercury__dir__ExpandChars_6 = mercury__dir__expand_acc_2_f_0(mercury__dir__ArgChar_5, mercury__dir__V_15_15);
    }
    {
      mercury__dir__ExpandStrs_4 = mercury__dir__map__ho9_2_f_in__list_0(mercury__dir__ExpandChars_6);
    }
    return mercury__dir__ExpandStrs_4;
  }
}

void MR_CALL 
mercury__dir__recursive_foldl2_7_p_0(
  MR_Word mercury__dir__TypeInfo_for_T_22,
  MR_Word mercury__dir__P_8,
  MR_String mercury__dir__DirName_9,
  MR_Word mercury__dir__FollowLinks_10,
  MR_Box mercury__dir__T_11,
  MR_Word * mercury__dir__Res_12)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_String mercury__dir__V_18_18;
    MR_Word mercury__dir__V_19_19;
    MR_Word mercury__dir__V_14_14;

    {
      mercury__dir__V_18_18 = mercury__dir__fixup_dirname_1_f_0(mercury__dir__DirName_9);
    }
    mercury__dir__V_19_19 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
    {
      mercury__dir__foldl2_process_dir_11_p_0(mercury__dir__TypeInfo_for_T_22, (MR_Integer) 0, mercury__dir__P_8, mercury__dir__V_18_18, mercury__dir__V_19_19, (MR_Integer) 1, mercury__dir__FollowLinks_10, &mercury__dir__V_14_14, mercury__dir__T_11, mercury__dir__Res_12);
    }
  }
}

void MR_CALL 
mercury__dir__foldl2_6_p_0(
  MR_Word mercury__dir__TypeInfo_for_T_21,
  MR_Word mercury__dir__P_7,
  MR_String mercury__dir__DirName_8,
  MR_Box mercury__dir__T_9,
  MR_Word * mercury__dir__Res_10)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_String mercury__dir__V_16_16;
    MR_Word mercury__dir__V_17_17;
    MR_Word mercury__dir__V_12_12;

    {
      mercury__dir__V_16_16 = mercury__dir__fixup_dirname_1_f_0(mercury__dir__DirName_8);
    }
    mercury__dir__V_17_17 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
    {
      mercury__dir__foldl2_process_dir_11_p_0(mercury__dir__TypeInfo_for_T_21, (MR_Integer) 0, mercury__dir__P_7, mercury__dir__V_16_16, mercury__dir__V_17_17, (MR_Integer) 0, (MR_Integer) 0, &mercury__dir__V_12_12, mercury__dir__T_9, mercury__dir__Res_10);
    }
  }
}

void MR_CALL 
mercury__dir__make_single_directory_4_p_0(
  MR_String mercury__dir__DirName_5,
  MR_Word * mercury__dir__Result_6)
{
  {
    MR_bool mercury__dir__succeeded;

    {
      mercury__dir__make_single_directory_2_5_p_0((MR_Integer) 1, mercury__dir__DirName_5, mercury__dir__Result_6);
    }
  }
}

void MR_CALL 
mercury__dir__make_directory_4_p_0(
  MR_String mercury__dir__PathName_5,
  MR_Word * mercury__dir__Result_6)
{
  {
    MR_bool mercury__dir__succeeded;

{
#define MR_PROC_LABEL mercury__dir__make_directory_4_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#elif defined(MR_HAVE_MKDIR)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    if (mercury__dir__succeeded)
      {
        MR_String mercury__dir__DirName_8;

        {
          mercury__dir__DirName_8 = mercury__dir__dirname_1_f_0(mercury__dir__PathName_5);
        }
        mercury__dir__succeeded = (strcmp(mercury__dir__PathName_5, mercury__dir__DirName_8) == 0);
        if (mercury__dir__succeeded)
          {
            {
              mercury__dir__make_single_directory_2_5_p_0((MR_Integer) 0, mercury__dir__PathName_5, mercury__dir__Result_6);
            }
          }
        else
          {
            mercury__dir__succeeded = (strcmp(mercury__dir__DirName_8, (MR_String) ".") == 0);
            if (mercury__dir__succeeded)
              {
                {
                  mercury__dir__make_single_directory_2_5_p_0((MR_Integer) 0, mercury__dir__PathName_5, mercury__dir__Result_6);
                }
              }
            else
              {
                MR_Word mercury__dir__ParentAccessResult_9;
                MR_Word mercury__dir__V_19_19 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));

{
#define MR_PROC_LABEL mercury__dir__make_directory_4_p_0

	MR_bool SUCCESS_INDICATOR;

		{

    SUCCESS_INDICATOR = MR_FALSE;


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
                if (mercury__dir__succeeded)
                  {
                    mercury__io__check_file_accessibility_dotnet_5_p_0(mercury__dir__DirName_8, mercury__dir__V_19_19, &mercury__dir__ParentAccessResult_9);
                  }
                else
                  {
{
#define MR_PROC_LABEL mercury__dir__make_directory_4_p_0

	MR_String FileName;
	MR_Word AccessTypes;
	MR_Word Result;

	FileName =  mercury__dir__DirName_8 ;
	AccessTypes =  mercury__dir__V_19_19 ;
		{

#if defined(MR_HAVE_ACCESS)
  #ifdef F_OK
    int mode = F_OK;
  #else
    int mode = 0;
  #endif
    int access_result;

  #if !defined(MR_WIN32) || defined(MR_CYGWIN)
    /*
    ** Earlier versions of MSVCRT ignored flags it doesn't support,
    ** later versions return an error (e.g. on Vista).
    */
    if (ML_access_types_includes_execute(AccessTypes)) {
      #ifdef X_OK
        mode |= X_OK;
      #else
        mode |= 1;
      #endif
    }
  #endif
    if (ML_access_types_includes_write(AccessTypes)) {
  #ifdef W_OK
        mode |= W_OK;
  #else
        mode |= 2;
  #endif
    }
    if (ML_access_types_includes_read(AccessTypes)) {
  #ifdef R_OK
        mode |= R_OK;
  #else
        mode |= 4;
  #endif
    }

  #ifdef MR_WIN32
    access_result = _waccess(ML_utf8_to_wide(FileName), mode);
  #else
    access_result = access(FileName, mode);
  #endif

    if (access_result == 0) {
        Result = ML_make_io_res_0_ok();
    } else {
        ML_make_io_res_0_error(errno,
            MR_make_string_const("file not accessible: "), &Result);
    }
#else /* !MR_HAVE_ACCESS */
    Result = ML_make_io_res_0_error_msg(
        "io.check_file_accessibility not supported on this platform");
#endif


		;}
#undef MR_PROC_LABEL
	 mercury__dir__ParentAccessResult_9  = Result;
}
                  }
                if ((mercury__dir__ParentAccessResult_9 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
                  {
                    {
                      mercury__dir__make_single_directory_2_5_p_0((MR_Integer) 0, mercury__dir__PathName_5, mercury__dir__Result_6);
                    }
                  }
                else
                  {
                    MR_Word mercury__dir__ParentResult_11;

                    {
                      mercury__dir__make_directory_4_p_0(mercury__dir__DirName_8, &mercury__dir__ParentResult_11);
                    }
                    if ((mercury__dir__ParentResult_11 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
                      {
                        {
                          mercury__dir__make_single_directory_2_5_p_0((MR_Integer) 0, mercury__dir__PathName_5, mercury__dir__Result_6);
                        }
                      }
                    else
                      *mercury__dir__Result_6 = mercury__dir__ParentResult_11;
                  }
              }
          }
      }
    else
      {
        MR_Word mercury__dir__V_26_26 = (MR_Word) ((MR_Box) ((MR_String) "dir.make_directory not implemented on this platform"));

        *mercury__dir__Result_6 = (MR_Word) MR_mkword(MR_mktag(1), &mercury__dir_scalar_common_5[0]);
      }
  }
}

void MR_CALL 
mercury__dir__current_directory_3_p_0(
  MR_Word * mercury__dir__Res_1)
{
  {
    MR_bool mercury__dir__succeeded;

{
#define MR_PROC_LABEL mercury__dir__current_directory_3_p_0

	MR_Word Res;

		{

    /*
    ** Marked thread_safe because ML_make_io_res_1_error_string will acquire
    ** the global lock.
    */

#ifdef MR_WIN32
    wchar_t     *wbuf;
    MR_String   str;

    wbuf = _wgetcwd(NULL, 1);
    if (wbuf != NULL) {
        str = ML_wide_to_utf8(wbuf, MR_ALLOC_ID);
        Res = ML_make_io_res_1_ok_string(str);
        free(wbuf);
    } else {
        ML_make_io_res_1_error_string(errno,
            MR_make_string_const("dir.current_directory failed: "),
            &Res);
    }
#else
    size_t      size = 256;
    MR_Word     ptr;
    char        *buf;
    MR_String   str;

    while (1) {
        MR_offset_incr_hp_atomic_msg(ptr, 0,
            (size + sizeof(MR_Word) - 1) / sizeof(MR_Word),
            MR_ALLOC_ID, "string.string/0");
        buf = (char *) ptr;
        if (getcwd(buf, size)) {
            MR_make_aligned_string(str, buf);
            Res = ML_make_io_res_1_ok_string(str);
            break;
        }
        if (errno != ERANGE) {
            ML_make_io_res_1_error_string(errno,
                MR_make_string_const("dir.current_directory failed: "),
                &Res);
            break;
        }
        /* Buffer too small. Resize and try again. */
        size *= 1.5;
    }
#endif


		;}
#undef MR_PROC_LABEL
	 *mercury__dir__Res_1  = Res;
}
  }
}

MR_String MR_CALL 
mercury__dir__relative_path_name_from_components_1_f_0(
  MR_Word mercury__dir__Components_3)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_String mercury__dir__PathName_4;
    MR_String mercury__dir__Sep_5;
    MR_Char mercury__dir__V_6_6;
    MR_Word mercury__dir__V_5_13;
    MR_Word mercury__dir__V_6_14;

{
#define MR_PROC_LABEL mercury__dir__relative_path_name_from_components_1_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    if (mercury__dir__succeeded)
      mercury__dir__V_6_6 = (MR_Char) 92;
    else
      mercury__dir__V_6_6 = (MR_Char) 47;
    mercury__dir__V_6_14 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
    {
      mercury__dir__V_5_13 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
      MR_hl_field(MR_mktag(1), mercury__dir__V_5_13, 0) = ((MR_Box) (MR_Word) (mercury__dir__V_6_6));
      MR_hl_field(MR_mktag(1), mercury__dir__V_5_13, 1) = ((MR_Box) (mercury__dir__V_6_14));
    }
    {
      mercury__string__to_char_list_2_p_1(&mercury__dir__Sep_5, mercury__dir__V_5_13);
    }
    {
      mercury__dir__PathName_4 = mercury__string__join_list_2_f_0(mercury__dir__Sep_5, mercury__dir__Components_3);
    }
    return mercury__dir__PathName_4;
  }
}

MR_String MR_CALL 
mercury__dir__make_path_name_2_f_0(
  MR_String mercury__dir__DirName_4,
  MR_String mercury__dir__FileName_5)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_String mercury__dir__HeadVar__3_3;

    {
      mercury__dir__HeadVar__3_3 = mercury__dir__f_slash_2_f_0(mercury__dir__DirName_4, mercury__dir__FileName_5);
    }
    return mercury__dir__HeadVar__3_3;
  }
}

MR_String MR_CALL 
mercury__dir__f_slash_2_f_0(
  MR_String mercury__dir__DirName0_4,
  MR_String mercury__dir__FileName0_5)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_String mercury__dir__PathName_6;
    MR_String mercury__dir__DirName_7;
    MR_String mercury__dir__FileName_8;
    MR_Word mercury__dir__V_12_12;
    MR_Word mercury__dir__V_13_13;
    MR_Word mercury__dir__V_14_14;
    MR_Word mercury__dir__V_15_15;

    {
      mercury__string__to_char_list_2_p_0(mercury__dir__DirName0_4, &mercury__dir__V_13_13);
    }
    {
      mercury__dir__V_12_12 = mercury__dir__canonicalize_path_chars_1_f_0(mercury__dir__V_13_13);
    }
    {
      mercury__string__from_char_list_2_p_0(mercury__dir__V_12_12, &mercury__dir__DirName_7);
    }
    {
      mercury__string__to_char_list_2_p_0(mercury__dir__FileName0_5, &mercury__dir__V_15_15);
    }
    {
      mercury__dir__V_14_14 = mercury__dir__canonicalize_path_chars_1_f_0(mercury__dir__V_15_15);
    }
    {
      mercury__string__from_char_list_2_p_0(mercury__dir__V_14_14, &mercury__dir__FileName_8);
    }
    {
      mercury__dir__succeeded = mercury__dir__path_name_is_absolute_1_p_0(mercury__dir__FileName_8);
    }
    if (mercury__dir__succeeded)
      {
        {
          mercury__require__unexpected_2_p_0((MR_String) "function \140dir./\'/2", (MR_String) "second argument is absolute");
        }
      }
    else
      {
        MR_Integer mercury__dir__Length_9;
        MR_Integer mercury__dir__V_18_18;
        MR_Char mercury__dir__V_19_19;
        MR_Integer mercury__dir__V_20_20;
        MR_Char mercury__dir__V_21_21;
        MR_Integer mercury__dir__V_22_22;
        MR_Char mercury__dir__V_47_47;
        MR_Integer mercury__dir__V_23_23;

{
#define MR_PROC_LABEL mercury__dir__f_slash_2_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
        if (mercury__dir__succeeded)
          mercury__dir__V_47_47 = (MR_Char) 92;
        else
          mercury__dir__V_47_47 = (MR_Char) 47;
        mercury__dir__succeeded = (mercury__dir__V_47_47 == (MR_Char) 92);
        if (mercury__dir__succeeded)
          {
{
#define MR_PROC_LABEL mercury__dir__f_slash_2_f_0

	MR_String Str;
	MR_Integer Length;

	Str =  mercury__dir__FileName_8 ;
		{

    Length = strlen(Str);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__Length_9  = Length;
}
            mercury__dir__V_18_18 = (MR_Integer) 2;
            mercury__dir__succeeded = (mercury__dir__Length_9 >= mercury__dir__V_18_18);
            if (mercury__dir__succeeded)
              {
                mercury__dir__V_20_20 = (MR_Integer) 0;
                {
                  mercury__string__unsafe_index_3_p_0(mercury__dir__FileName_8, mercury__dir__V_20_20, &mercury__dir__V_19_19);
                }
                {
                  mercury__dir__succeeded = mercury__char__is_alpha_1_p_0(mercury__dir__V_19_19);
                }
                if (mercury__dir__succeeded)
                  {
                    mercury__dir__V_22_22 = (MR_Integer) 1;
                    {
                      mercury__string__unsafe_index_3_p_0(mercury__dir__FileName_8, mercury__dir__V_22_22, &mercury__dir__V_21_21);
                    }
                    mercury__dir__succeeded = (mercury__dir__V_21_21 == (MR_Char) 58);
                    if (mercury__dir__succeeded)
                      {
                        mercury__dir__V_23_23 = (MR_Integer) 2;
                        mercury__dir__succeeded = (mercury__dir__Length_9 > mercury__dir__V_23_23);
                        if (mercury__dir__succeeded)
                          {
                            MR_Char mercury__dir__V_24_24;

                            {
                              mercury__string__unsafe_index_3_p_0(mercury__dir__FileName_8, (MR_Integer) 2, &mercury__dir__V_24_24);
                            }
                            {
                              mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__V_24_24);
                            }
                            mercury__dir__succeeded = !(mercury__dir__succeeded);
                          }
                        else
                          mercury__dir__succeeded = MR_TRUE;
                      }
                  }
              }
          }
        if (mercury__dir__succeeded)
          {
            {
              mercury__require__unexpected_2_p_0((MR_String) "function \140dir./\'/2", (MR_String) "second argument is a current drive relative path");
            }
          }
        else
          {
            MR_Integer mercury__dir__DirNameLength_10;

{
#define MR_PROC_LABEL mercury__dir__f_slash_2_f_0

	MR_String Str;
	MR_Integer Length;

	Str =  mercury__dir__DirName_7 ;
		{

    Length = strlen(Str);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__DirNameLength_10  = Length;
}
            {
              MR_Char mercury__dir__V_29_29;
              MR_Integer mercury__dir__V_30_30;
              MR_Char mercury__dir__V_31_31;
              MR_Integer mercury__dir__V_32_32;
              MR_Char mercury__dir__V_61_61;

{
#define MR_PROC_LABEL mercury__dir__f_slash_2_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
              if (mercury__dir__succeeded)
                mercury__dir__V_61_61 = (MR_Char) 92;
              else
                mercury__dir__V_61_61 = (MR_Char) 47;
              mercury__dir__succeeded = (mercury__dir__V_61_61 == (MR_Char) 92);
              if (mercury__dir__succeeded)
                {
                  mercury__dir__succeeded = (mercury__dir__DirNameLength_10 == (MR_Integer) 2);
                  if (mercury__dir__succeeded)
                    {
                      mercury__dir__V_30_30 = (MR_Integer) 0;
                      {
                        mercury__string__unsafe_index_3_p_0(mercury__dir__DirName_7, mercury__dir__V_30_30, &mercury__dir__V_29_29);
                      }
                      {
                        mercury__dir__succeeded = mercury__char__is_alpha_1_p_0(mercury__dir__V_29_29);
                      }
                      if (mercury__dir__succeeded)
                        {
                          mercury__dir__V_32_32 = (MR_Integer) 1;
                          {
                            mercury__string__unsafe_index_3_p_0(mercury__dir__DirName_7, mercury__dir__V_32_32, &mercury__dir__V_31_31);
                          }
                          mercury__dir__succeeded = (mercury__dir__V_31_31 == (MR_Char) 58);
                        }
                    }
                }
            }
            if (!(mercury__dir__succeeded))
              {
                MR_Char mercury__dir__Char_71;
                MR_Integer mercury__dir__V_11_11;

                mercury__dir__succeeded = (mercury__dir__DirNameLength_10 > (MR_Integer) 0);
                if (mercury__dir__succeeded)
                  {
{
#define MR_PROC_LABEL mercury__dir__f_slash_2_f_0

	MR_String Str;
	MR_Integer Index;
	MR_Integer PrevIndex;
	MR_Char Ch;
	MR_bool SUCCESS_INDICATOR;

	Str =  mercury__dir__DirName_7 ;
	Index =  mercury__dir__DirNameLength_10 ;
		{

    if (Index > 0) {
        PrevIndex = Index - 1;
        Ch = Str[PrevIndex];
        if (MR_is_ascii(Ch)) {
            SUCCESS_INDICATOR = (Ch != 0);
        } else {
            Ch = MR_utf8_prev_get(Str, &PrevIndex);
            SUCCESS_INDICATOR = (Ch > 0);
        }
    } else {
        SUCCESS_INDICATOR = MR_FALSE;
    }


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	 mercury__dir__V_11_11  = PrevIndex;
	 mercury__dir__Char_71  = Ch;
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
                    if (mercury__dir__succeeded)
                      {
                        mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Char_71);
                      }
                  }
              }
            if (mercury__dir__succeeded)
              {
                mercury__string__append_3_p_2(mercury__dir__DirName_7, mercury__dir__FileName_8, &mercury__dir__PathName_6);
              }
            else
              {
                MR_Word mercury__dir__V_33_33;
                MR_Word mercury__dir__V_34_34;
                MR_String mercury__dir__V_35_35;
                MR_Char mercury__dir__V_36_36;
                MR_Word mercury__dir__V_37_37;
                MR_Word mercury__dir__V_38_38;
                MR_Word mercury__dir__V_5_82;
                MR_Word mercury__dir__V_6_83;

{
#define MR_PROC_LABEL mercury__dir__f_slash_2_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
                if (mercury__dir__succeeded)
                  mercury__dir__V_36_36 = (MR_Char) 92;
                else
                  mercury__dir__V_36_36 = (MR_Char) 47;
                mercury__dir__V_6_83 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
                {
                  mercury__dir__V_5_82 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                  MR_hl_field(MR_mktag(1), mercury__dir__V_5_82, 0) = ((MR_Box) (MR_Word) (mercury__dir__V_36_36));
                  MR_hl_field(MR_mktag(1), mercury__dir__V_5_82, 1) = ((MR_Box) (mercury__dir__V_6_83));
                }
                {
                  mercury__string__to_char_list_2_p_1(&mercury__dir__V_35_35, mercury__dir__V_5_82);
                }
                mercury__dir__V_38_38 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
                {
                  mercury__dir__V_37_37 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                  MR_hl_field(MR_mktag(1), mercury__dir__V_37_37, 0) = ((MR_Box) (mercury__dir__FileName_8));
                  MR_hl_field(MR_mktag(1), mercury__dir__V_37_37, 1) = ((MR_Box) (mercury__dir__V_38_38));
                }
                {
                  mercury__dir__V_34_34 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                  MR_hl_field(MR_mktag(1), mercury__dir__V_34_34, 0) = ((MR_Box) (mercury__dir__V_35_35));
                  MR_hl_field(MR_mktag(1), mercury__dir__V_34_34, 1) = ((MR_Box) (mercury__dir__V_37_37));
                }
                {
                  mercury__dir__V_33_33 = (MR_Word) MR_mkword(MR_mktag(1), MR_new_object(MR_Word, ((MR_Integer) 2 * sizeof(MR_Word)), NULL, NULL));
                  MR_hl_field(MR_mktag(1), mercury__dir__V_33_33, 0) = ((MR_Box) (mercury__dir__DirName_7));
                  MR_hl_field(MR_mktag(1), mercury__dir__V_33_33, 1) = ((MR_Box) (mercury__dir__V_34_34));
                }
                {
                  mercury__dir__PathName_6 = mercury__string__append_list_1_f_0(mercury__dir__V_33_33);
                }
              }
          }
      }
    return mercury__dir__PathName_6;
  }
}

MR_bool MR_CALL 
mercury__dir__path_name_is_root_directory_1_p_0(
  MR_String mercury__dir__PathName_2)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__V_3_3;
    MR_Word mercury__dir__V_4_4;

    {
      mercury__string__to_char_list_2_p_0(mercury__dir__PathName_2, &mercury__dir__V_4_4);
    }
    {
      mercury__dir__V_3_3 = mercury__dir__canonicalize_path_chars_1_f_0(mercury__dir__V_4_4);
    }
    {
      mercury__dir__succeeded = mercury__dir__is_root_directory_1_p_0(mercury__dir__V_3_3);
    }
    return mercury__dir__succeeded;
  }
}

MR_bool MR_CALL 
mercury__dir__path_name_is_absolute_1_p_0(
  MR_String mercury__dir__FileName_2)
{
  {
    MR_bool mercury__dir__succeeded;

{
#define MR_PROC_LABEL mercury__dir__path_name_is_absolute_1_p_0

	MR_bool SUCCESS_INDICATOR;

		{

    SUCCESS_INDICATOR = MR_FALSE;


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    if (mercury__dir__succeeded)
      {
        {
          mercury__require__unexpected_2_p_0((MR_String) "predicate \140dir.dotnet_path_name_is_absolute_2\'/1", (MR_String) "called on non-.NET CLI backend");
        }
        mercury__dir__succeeded = MR_TRUE;
      }
    else
      {
        {
          MR_Char mercury__dir__V_33_33;

{
#define MR_PROC_LABEL mercury__dir__path_name_is_absolute_1_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
          if (mercury__dir__succeeded)
            mercury__dir__V_33_33 = (MR_Char) 92;
          else
            mercury__dir__V_33_33 = (MR_Char) 47;
          mercury__dir__succeeded = (mercury__dir__V_33_33 == (MR_Char) 92);
        }
        if (!(mercury__dir__succeeded))
          {
{
#define MR_PROC_LABEL mercury__dir__path_name_is_absolute_1_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_CYGWIN)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
          }
        if (mercury__dir__succeeded)
          {
            MR_Word mercury__dir__V_5_5;
            MR_Word mercury__dir__V_6_6;
            MR_Char mercury__dir__Letter_43;
            MR_Char mercury__dir__Sep_44;
            MR_Word mercury__dir__V_47_47;
            MR_Char mercury__dir__V_48_48;
            MR_Word mercury__dir__V_49_49;
            MR_Word mercury__dir__STATE_VARIABLE_FileName_6_39;

            {
              mercury__string__to_char_list_2_p_0(mercury__dir__FileName_2, &mercury__dir__V_6_6);
            }
            {
              mercury__dir__V_5_5 = mercury__dir__canonicalize_path_chars_1_f_0(mercury__dir__V_6_6);
            }
            mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__V_5_5)) == (MR_mktag((MR_Integer) 1)));
            if (mercury__dir__succeeded)
              {
                mercury__dir__Letter_43 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_5_5, (MR_Integer) 0)));
                mercury__dir__V_47_47 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_5_5, (MR_Integer) 1)));
                mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__V_47_47)) == (MR_mktag((MR_Integer) 1)));
                if (mercury__dir__succeeded)
                  {
                    mercury__dir__V_48_48 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_47_47, (MR_Integer) 0)));
                    mercury__dir__V_49_49 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_47_47, (MR_Integer) 1)));
                    mercury__dir__succeeded = (mercury__dir__V_48_48 == (MR_Char) 58);
                    if (mercury__dir__succeeded)
                      {
                        mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__V_49_49)) == (MR_mktag((MR_Integer) 1)));
                        if (mercury__dir__succeeded)
                          {
                            mercury__dir__Sep_44 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_49_49, (MR_Integer) 0)));
                            mercury__dir__STATE_VARIABLE_FileName_6_39 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_49_49, (MR_Integer) 1)));
                            {
                              mercury__dir__succeeded = mercury__char__is_alpha_1_p_0(mercury__dir__Letter_43);
                            }
                            if (mercury__dir__succeeded)
                              {
                                mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Sep_44);
                              }
                          }
                      }
                  }
              }
            if (mercury__dir__succeeded)
              mercury__dir__succeeded = MR_TRUE;
            else
              {
                MR_Char mercury__dir__Sep_51;
                MR_Word mercury__dir__Server_53;
                MR_Word mercury__dir__STATE_VARIABLE_FileName_0_61;
                MR_Word mercury__dir__V_62_62;
                MR_Word mercury__dir__STATE_VARIABLE_FileName_17_64;
                MR_Char mercury__dir__V_78_78;
                MR_Char mercury__dir__V_54_54;
                MR_Word mercury__dir__V_55_55;

                mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__V_5_5)) == (MR_mktag((MR_Integer) 1)));
                if (mercury__dir__succeeded)
                  {
                    mercury__dir__Sep_51 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_5_5, (MR_Integer) 0)));
                    mercury__dir__V_62_62 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_5_5, (MR_Integer) 1)));
                    mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__V_62_62)) == (MR_mktag((MR_Integer) 1)));
                    if (mercury__dir__succeeded)
                      {
                        mercury__dir__V_78_78 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_62_62, (MR_Integer) 0)));
                        mercury__dir__STATE_VARIABLE_FileName_0_61 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_62_62, (MR_Integer) 1)));
                        mercury__dir__succeeded = (mercury__dir__Sep_51 == mercury__dir__V_78_78);
                        if (mercury__dir__succeeded)
                          {
                            {
                              mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Sep_51);
                            }
                            if (mercury__dir__succeeded)
                              {
                                {
                                  mercury__dir__take_while__ho7_4_p_in__list_0(mercury__dir__STATE_VARIABLE_FileName_0_61, &mercury__dir__Server_53, &mercury__dir__STATE_VARIABLE_FileName_17_64);
                                }
                                mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__Server_53)) == (MR_mktag((MR_Integer) 1)));
                                if (mercury__dir__succeeded)
                                  {
                                    mercury__dir__V_54_54 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__Server_53, (MR_Integer) 0)));
                                    mercury__dir__V_55_55 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__Server_53, (MR_Integer) 1)));
                                    if ((mercury__dir__STATE_VARIABLE_FileName_17_64 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
                                      mercury__dir__succeeded = MR_TRUE;
                                    else
                                      {
                                        MR_Word mercury__dir__STATE_VARIABLE_FileName_19_66 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__STATE_VARIABLE_FileName_17_64, (MR_Integer) 1)));
                                        MR_Char mercury__dir__V_79_79 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__STATE_VARIABLE_FileName_17_64, (MR_Integer) 0)));

                                        mercury__dir__succeeded = (mercury__dir__Sep_51 == mercury__dir__V_79_79);
                                        if (mercury__dir__succeeded)
                                          {
                                            if ((mercury__dir__STATE_VARIABLE_FileName_19_66 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
                                              mercury__dir__succeeded = MR_TRUE;
                                            else
                                              {
                                                MR_Word mercury__dir__Share_58;
                                                MR_Word mercury__dir__STATE_VARIABLE_FileName_21_68;
                                                MR_Char mercury__dir__V_59_59;
                                                MR_Word mercury__dir__V_60_60;

                                                {
                                                  mercury__dir__take_while__ho6_4_p_in__list_0(mercury__dir__STATE_VARIABLE_FileName_19_66, &mercury__dir__Share_58, &mercury__dir__STATE_VARIABLE_FileName_21_68);
                                                }
                                                mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__Share_58)) == (MR_mktag((MR_Integer) 1)));
                                                if (mercury__dir__succeeded)
                                                  {
                                                    mercury__dir__V_59_59 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__Share_58, (MR_Integer) 0)));
                                                    mercury__dir__V_60_60 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__Share_58, (MR_Integer) 1)));
                                                    if ((mercury__dir__STATE_VARIABLE_FileName_21_68 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
                                                      mercury__dir__succeeded = MR_TRUE;
                                                    else
                                                      {
                                                        MR_Char mercury__dir__V_80_80 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__STATE_VARIABLE_FileName_21_68, (MR_Integer) 0)));
                                                        MR_Word mercury__dir__STATE_VARIABLE_FileName_7_40 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__STATE_VARIABLE_FileName_21_68, (MR_Integer) 1)));

                                                        mercury__dir__succeeded = (mercury__dir__Sep_51 == mercury__dir__V_80_80);
                                                      }
                                                  }
                                              }
                                          }
                                      }
                                  }
                              }
                          }
                      }
                  }
                if (mercury__dir__succeeded)
                  mercury__dir__succeeded = MR_TRUE;
                else
                  {
                    MR_Char mercury__dir__Char1_82;
                    MR_Word mercury__dir__STATE_VARIABLE_FileName_0_85;

                    mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__V_5_5)) == (MR_mktag((MR_Integer) 1)));
                    if (mercury__dir__succeeded)
                      {
                        mercury__dir__Char1_82 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_5_5, (MR_Integer) 0)));
                        mercury__dir__STATE_VARIABLE_FileName_0_85 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_5_5, (MR_Integer) 1)));
                        {
                          mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Char1_82);
                        }
                        if (mercury__dir__succeeded)
                          {
                            if ((mercury__dir__STATE_VARIABLE_FileName_0_85 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0)))))
                              mercury__dir__succeeded = MR_TRUE;
                            else
                              {
                                MR_Char mercury__dir__Char2_84 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__STATE_VARIABLE_FileName_0_85, (MR_Integer) 0)));
                                MR_Word mercury__dir__V_95_95 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__STATE_VARIABLE_FileName_0_85, (MR_Integer) 1)));

                                {
                                  mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Char2_84);
                                }
                                mercury__dir__succeeded = !(mercury__dir__succeeded);
                              }
                          }
                      }
                  }
              }
          }
        else
          {
            MR_Char mercury__dir__FirstChar_4;
            MR_Integer mercury__dir__V_7_90;

{
#define MR_PROC_LABEL mercury__dir__path_name_is_absolute_1_p_0

	MR_String Str;
	MR_Integer Length;

	Str =  mercury__dir__FileName_2 ;
		{

    Length = strlen(Str);


		;}
#undef MR_PROC_LABEL
	 mercury__dir__V_7_90  = Length;
}
{
#define MR_PROC_LABEL mercury__dir__path_name_is_absolute_1_p_0

	MR_Integer Index;
	MR_Integer Length;
	MR_bool SUCCESS_INDICATOR;

	Index =  (MR_Integer) 0 ;
	Length =  mercury__dir__V_7_90 ;
		{

    /*
    ** We do not test for negative values of Index because (a) MR_Unsigned
    ** is unsigned and hence a negative argument will appear as a very large
    ** positive one after the cast and (b) anybody dealing with the case
    ** where strlen(Str) > MAXINT is clearly barking mad (and one may well get
    ** an integer overflow error in this case).
    */
    SUCCESS_INDICATOR = ((MR_Unsigned) Index < (MR_Unsigned) Length);


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
            if (mercury__dir__succeeded)
              {
                {
                  mercury__string__unsafe_index_3_p_0(mercury__dir__FileName_2, (MR_Integer) 0, &mercury__dir__FirstChar_4);
                }
                {
                  mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__FirstChar_4);
                }
              }
          }
      }
    return mercury__dir__succeeded;
  }
}

void MR_CALL 
mercury__dir__dirname_2_p_0(
  MR_String mercury__dir__S_3,
  MR_String * mercury__dir__HeadVar__2_2)
{
  {
    MR_bool mercury__dir__succeeded;

    {
      *mercury__dir__HeadVar__2_2 = mercury__dir__dirname_1_f_0(mercury__dir__S_3);
    }
  }
}

MR_String MR_CALL 
mercury__dir__dirname_1_f_0(
  MR_String mercury__dir__FileName_3)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_String mercury__dir__DirName_4;
    MR_Word mercury__dir__FileNameChars_5;
    MR_Word mercury__dir__V_9_9;

    {
      mercury__string__to_char_list_2_p_0(mercury__dir__FileName_3, &mercury__dir__V_9_9);
    }
    {
      mercury__dir__FileNameChars_5 = mercury__dir__canonicalize_path_chars_1_f_0(mercury__dir__V_9_9);
    }
    {
      mercury__dir__succeeded = mercury__dir__is_root_directory_1_p_0(mercury__dir__FileNameChars_5);
    }
    if (mercury__dir__succeeded)
      {
        mercury__string__from_char_list_2_p_0(mercury__dir__FileNameChars_5, &mercury__dir__DirName_4);
      }
    else
      {
        MR_Char mercury__dir__Drive_6;
        MR_Word mercury__dir__V_10_10;
        MR_Char mercury__dir__V_11_11;
        MR_Word mercury__dir__V_12_12;
        MR_Char mercury__dir__V_22_22;

{
#define MR_PROC_LABEL mercury__dir__dirname_1_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
        if (mercury__dir__succeeded)
          mercury__dir__V_22_22 = (MR_Char) 92;
        else
          mercury__dir__V_22_22 = (MR_Char) 47;
        mercury__dir__succeeded = (mercury__dir__V_22_22 == (MR_Char) 92);
        if (mercury__dir__succeeded)
          {
            mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__FileNameChars_5)) == (MR_mktag((MR_Integer) 1)));
            if (mercury__dir__succeeded)
              {
                mercury__dir__Drive_6 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileNameChars_5, (MR_Integer) 0)));
                mercury__dir__V_10_10 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileNameChars_5, (MR_Integer) 1)));
                mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__V_10_10)) == (MR_mktag((MR_Integer) 1)));
                if (mercury__dir__succeeded)
                  {
                    mercury__dir__V_11_11 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_10_10, (MR_Integer) 0)));
                    mercury__dir__V_12_12 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_10_10, (MR_Integer) 1)));
                    mercury__dir__succeeded = (mercury__dir__V_11_11 == (MR_Char) 58);
                    if (mercury__dir__succeeded)
                      {
                        mercury__dir__succeeded = (mercury__dir__V_12_12 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0))));
                        if (mercury__dir__succeeded)
                          {
                            mercury__dir__succeeded = mercury__char__is_alpha_1_p_0(mercury__dir__Drive_6);
                          }
                      }
                  }
              }
          }
        if (mercury__dir__succeeded)
          {
            mercury__string__from_char_list_2_p_0(mercury__dir__FileNameChars_5, &mercury__dir__DirName_4);
          }
        else
          {
            MR_String mercury__dir__DirName0_7;
            MR_String mercury__dir__V_8_8;

            {
              mercury__dir__succeeded = mercury__dir__split_name_2_3_p_0(mercury__dir__FileNameChars_5, &mercury__dir__DirName0_7, &mercury__dir__V_8_8);
            }
            if (mercury__dir__succeeded)
              mercury__dir__DirName_4 = mercury__dir__DirName0_7;
            else
              {
                MR_Word mercury__dir__TypeInfo_17_17;
                MR_Word mercury__dir__V_13_13;
                MR_Word mercury__dir__V_16_16;
                MR_Word mercury__dir__Chars1_26;
                MR_Word mercury__dir__TypeCtorInfo_6_28 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_character_0;
                MR_Char mercury__dir__Sep_27;
                MR_Box mercury__dir__conv0_Sep_27;

                {
                  mercury__dir__succeeded = mercury__list__split_last_3_p_0(mercury__dir__TypeCtorInfo_6_28, mercury__dir__FileNameChars_5, &mercury__dir__Chars1_26, &mercury__dir__conv0_Sep_27);
                }
                if (mercury__dir__succeeded)
                  {
                    mercury__dir__Sep_27 = ((MR_Char) (MR_Word) mercury__dir__conv0_Sep_27);
                    mercury__dir__succeeded = MR_TRUE;
                  }
                if (mercury__dir__succeeded)
                  {
                    mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Sep_27);
                  }
                if (mercury__dir__succeeded)
                  mercury__dir__V_13_13 = mercury__dir__Chars1_26;
                else
                  mercury__dir__V_13_13 = mercury__dir__FileNameChars_5;
                {
                  mercury__string__to_char_list_2_p_0((MR_String) "..", &mercury__dir__V_16_16);
                }
                mercury__dir__TypeInfo_17_17 = (MR_Word) &mercury__dir_scalar_common_1[0];
                {
                  mercury__dir__succeeded = mercury__builtin__unify_2_p_0(mercury__dir__TypeInfo_17_17, ((MR_Box) (mercury__dir__V_13_13)), ((MR_Box) (mercury__dir__V_16_16)));
                }
                if (mercury__dir__succeeded)
                  mercury__dir__DirName_4 = (MR_String) "..";
                else
                  mercury__dir__DirName_4 = (MR_String) ".";
              }
          }
      }
    return mercury__dir__DirName_4;
  }
}

MR_String MR_CALL 
mercury__dir__det_basename_1_f_0(
  MR_String mercury__dir__FileName_3)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_String mercury__dir__HeadVar__2_2;
    MR_String mercury__dir__BaseName_4;

    {
      mercury__dir__succeeded = mercury__dir__basename_1_f_0(mercury__dir__FileName_3, &mercury__dir__BaseName_4);
    }
    if (mercury__dir__succeeded)
      mercury__dir__HeadVar__2_2 = mercury__dir__BaseName_4;
    else
      {
        {
          mercury__require__unexpected_2_p_0((MR_String) "function \140dir.det_basename\'/1", (MR_String) "given directory is root directory");
        }
      }
    return mercury__dir__HeadVar__2_2;
  }
}

MR_bool MR_CALL 
mercury__dir__basename_2_p_0(
  MR_String mercury__dir__S_3,
  MR_String * mercury__dir__HeadVar__2_2)
{
  {
    MR_bool mercury__dir__succeeded;

    {
      mercury__dir__succeeded = mercury__dir__basename_1_f_0(mercury__dir__S_3, mercury__dir__HeadVar__2_2);
    }
    return mercury__dir__succeeded;
  }
}

MR_bool MR_CALL 
mercury__dir__basename_1_f_0(
  MR_String mercury__dir__FileName_3,
  MR_String * mercury__dir__BaseName_4)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__FileNameChars_5;
    MR_Word mercury__dir__FileNameWithoutSlash_7;
    MR_Word mercury__dir__V_10_10;
    MR_Char mercury__dir__Drive_6;
    MR_Word mercury__dir__V_11_11;
    MR_Char mercury__dir__V_12_12;
    MR_Word mercury__dir__V_13_13;
    MR_Char mercury__dir__V_24_24;
    MR_Word mercury__dir__Chars1_26;
    MR_Word mercury__dir__TypeCtorInfo_6_28;
    MR_Char mercury__dir__Sep_27;
    MR_Box mercury__dir__conv0_Sep_27;
    MR_Word mercury__dir__TypeInfo_20_20;
    MR_String mercury__dir__V_14_14;
    MR_Word mercury__dir__V_17_17;
    MR_Word mercury__dir__TypeInfo_21_21;
    MR_String mercury__dir__V_15_15;
    MR_Word mercury__dir__V_19_19;
    MR_String mercury__dir__BaseName0_9;
    MR_String mercury__dir__V_8_8;

    {
      mercury__string__to_char_list_2_p_0(mercury__dir__FileName_3, &mercury__dir__V_10_10);
    }
    {
      mercury__dir__FileNameChars_5 = mercury__dir__canonicalize_path_chars_1_f_0(mercury__dir__V_10_10);
    }
    {
      mercury__dir__succeeded = mercury__dir__is_root_directory_1_p_0(mercury__dir__FileNameChars_5);
    }
    mercury__dir__succeeded = !(mercury__dir__succeeded);
    if (mercury__dir__succeeded)
      {
{
#define MR_PROC_LABEL mercury__dir__basename_1_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
        if (mercury__dir__succeeded)
          mercury__dir__V_24_24 = (MR_Char) 92;
        else
          mercury__dir__V_24_24 = (MR_Char) 47;
        mercury__dir__succeeded = (mercury__dir__V_24_24 == (MR_Char) 92);
        if (mercury__dir__succeeded)
          {
            mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__FileNameChars_5)) == (MR_mktag((MR_Integer) 1)));
            if (mercury__dir__succeeded)
              {
                mercury__dir__Drive_6 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileNameChars_5, (MR_Integer) 0)));
                mercury__dir__V_11_11 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__FileNameChars_5, (MR_Integer) 1)));
                mercury__dir__succeeded = ((MR_tag((MR_Word) mercury__dir__V_11_11)) == (MR_mktag((MR_Integer) 1)));
                if (mercury__dir__succeeded)
                  {
                    mercury__dir__V_12_12 = ((MR_Char) (MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_11_11, (MR_Integer) 0)));
                    mercury__dir__V_13_13 = ((MR_Word) (MR_hl_field(MR_mktag(1), mercury__dir__V_11_11, (MR_Integer) 1)));
                    mercury__dir__succeeded = (mercury__dir__V_12_12 == (MR_Char) 58);
                    if (mercury__dir__succeeded)
                      {
                        mercury__dir__succeeded = (mercury__dir__V_13_13 == ((MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0))));
                        if (mercury__dir__succeeded)
                          {
                            mercury__dir__succeeded = mercury__char__is_alpha_1_p_0(mercury__dir__Drive_6);
                          }
                      }
                  }
              }
          }
        mercury__dir__succeeded = !(mercury__dir__succeeded);
        if (mercury__dir__succeeded)
          {
            mercury__dir__TypeCtorInfo_6_28 = (MR_Word) &mercury__builtin__builtin__type_ctor_info_character_0;
            {
              mercury__dir__succeeded = mercury__list__split_last_3_p_0(mercury__dir__TypeCtorInfo_6_28, mercury__dir__FileNameChars_5, &mercury__dir__Chars1_26, &mercury__dir__conv0_Sep_27);
            }
            if (mercury__dir__succeeded)
              {
                mercury__dir__Sep_27 = ((MR_Char) (MR_Word) mercury__dir__conv0_Sep_27);
                mercury__dir__succeeded = MR_TRUE;
              }
            if (mercury__dir__succeeded)
              {
                mercury__dir__succeeded = mercury__dir__is_directory_separator_1_p_0(mercury__dir__Sep_27);
              }
            if (mercury__dir__succeeded)
              mercury__dir__FileNameWithoutSlash_7 = mercury__dir__Chars1_26;
            else
              mercury__dir__FileNameWithoutSlash_7 = mercury__dir__FileNameChars_5;
            mercury__dir__V_14_14 = (MR_String) ".";
            {
              mercury__string__to_char_list_2_p_0(mercury__dir__V_14_14, &mercury__dir__V_17_17);
            }
            mercury__dir__TypeInfo_20_20 = (MR_Word) &mercury__dir_scalar_common_1[0];
            {
              mercury__dir__succeeded = mercury__builtin__unify_2_p_0(mercury__dir__TypeInfo_20_20, ((MR_Box) (mercury__dir__FileNameWithoutSlash_7)), ((MR_Box) (mercury__dir__V_17_17)));
            }
            mercury__dir__succeeded = !(mercury__dir__succeeded);
            if (mercury__dir__succeeded)
              {
                mercury__dir__V_15_15 = (MR_String) "..";
                {
                  mercury__string__to_char_list_2_p_0(mercury__dir__V_15_15, &mercury__dir__V_19_19);
                }
                mercury__dir__TypeInfo_21_21 = (MR_Word) &mercury__dir_scalar_common_1[0];
                {
                  mercury__dir__succeeded = mercury__builtin__unify_2_p_0(mercury__dir__TypeInfo_21_21, ((MR_Box) (mercury__dir__FileNameWithoutSlash_7)), ((MR_Box) (mercury__dir__V_19_19)));
                }
                mercury__dir__succeeded = !(mercury__dir__succeeded);
                if (mercury__dir__succeeded)
                  {
                    {
                      mercury__dir__succeeded = mercury__dir__split_name_2_3_p_0(mercury__dir__FileNameChars_5, &mercury__dir__V_8_8, &mercury__dir__BaseName0_9);
                    }
                    if (mercury__dir__succeeded)
                      *mercury__dir__BaseName_4 = mercury__dir__BaseName0_9;
                    else
                      *mercury__dir__BaseName_4 = mercury__dir__FileName_3;
                    mercury__dir__succeeded = MR_TRUE;
                  }
              }
          }
      }
    return mercury__dir__succeeded;
  }
}

MR_bool MR_CALL 
mercury__dir__split_name_3_p_0(
  MR_String mercury__dir__FileName_4,
  MR_String * mercury__dir__DirName_5,
  MR_String * mercury__dir__BaseName_6)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Word mercury__dir__FileNameChars_7;
    MR_Word mercury__dir__V_8_8;

    {
      mercury__string__to_char_list_2_p_0(mercury__dir__FileName_4, &mercury__dir__V_8_8);
    }
    {
      mercury__dir__FileNameChars_7 = mercury__dir__canonicalize_path_chars_1_f_0(mercury__dir__V_8_8);
    }
    {
      mercury__dir__succeeded = mercury__dir__is_root_directory_1_p_0(mercury__dir__FileNameChars_7);
    }
    mercury__dir__succeeded = !(mercury__dir__succeeded);
    if (mercury__dir__succeeded)
      {
        mercury__dir__succeeded = mercury__dir__split_name_2_3_p_0(mercury__dir__FileNameChars_7, mercury__dir__DirName_5, mercury__dir__BaseName_6);
      }
    return mercury__dir__succeeded;
  }
}

void MR_CALL 
mercury__dir__parent_directory_1_p_0(
  MR_String * mercury__dir__HeadVar__1_1)
{
  {
    MR_bool mercury__dir__succeeded;

    *mercury__dir__HeadVar__1_1 = (MR_String) "..";
  }
}

MR_String MR_CALL 
mercury__dir__parent_directory_0_f_0(void)
{
  {
    MR_bool mercury__dir__succeeded;

    return (MR_String) "..";
  }
}

void MR_CALL 
mercury__dir__this_directory_1_p_0(
  MR_String * mercury__dir__HeadVar__1_1)
{
  {
    MR_bool mercury__dir__succeeded;

    *mercury__dir__HeadVar__1_1 = (MR_String) ".";
  }
}

MR_String MR_CALL 
mercury__dir__this_directory_0_f_0(void)
{
  {
    MR_bool mercury__dir__succeeded;

    return (MR_String) ".";
  }
}

void MR_CALL 
mercury__dir__is_directory_separator_1_p_1(
  MR_Char * mercury__dir__Char_2,
  MR_Cont mercury__dir__cont,
  void * mercury__dir__cont_env_ptr)
{
  {
    MR_bool mercury__dir__succeeded;

    {
      MR_Char mercury__dir__V_3_3;

{
#define MR_PROC_LABEL mercury__dir__is_directory_separator_1_p_1

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
      if (mercury__dir__succeeded)
        *mercury__dir__Char_2 = (MR_Char) 92;
      else
        *mercury__dir__Char_2 = (MR_Char) 47;
{
#define MR_PROC_LABEL mercury__dir__is_directory_separator_1_p_1

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_CYGWIN)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
      if (mercury__dir__succeeded)
        mercury__dir__V_3_3 = (MR_Char) 92;
      else
        mercury__dir__V_3_3 = (MR_Char) 47;
      mercury__dir__succeeded = (*mercury__dir__Char_2 == mercury__dir__V_3_3);
      mercury__dir__succeeded = !(mercury__dir__succeeded);
      if (mercury__dir__succeeded)
        {
          mercury__dir__cont(mercury__dir__cont_env_ptr);
        }
    }
{
#define MR_PROC_LABEL mercury__dir__is_directory_separator_1_p_1

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_CYGWIN)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    if (mercury__dir__succeeded)
      *mercury__dir__Char_2 = (MR_Char) 92;
    else
      *mercury__dir__Char_2 = (MR_Char) 47;
    {
      mercury__dir__cont(mercury__dir__cont_env_ptr);
    }
  }
}

MR_bool MR_CALL 
mercury__dir__is_directory_separator_1_p_0(
  MR_Char mercury__dir__Char_2)
{
  {
    MR_bool mercury__dir__succeeded;

    {
      MR_Char mercury__dir__V_3_3;
      MR_Char mercury__dir__V_4_4;

{
#define MR_PROC_LABEL mercury__dir__is_directory_separator_1_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
      if (mercury__dir__succeeded)
        mercury__dir__V_3_3 = (MR_Char) 92;
      else
        mercury__dir__V_3_3 = (MR_Char) 47;
      mercury__dir__succeeded = (mercury__dir__Char_2 == mercury__dir__V_3_3);
      if (mercury__dir__succeeded)
        {
{
#define MR_PROC_LABEL mercury__dir__is_directory_separator_1_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_CYGWIN)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
          if (mercury__dir__succeeded)
            mercury__dir__V_4_4 = (MR_Char) 92;
          else
            mercury__dir__V_4_4 = (MR_Char) 47;
          mercury__dir__succeeded = (mercury__dir__Char_2 == mercury__dir__V_4_4);
          mercury__dir__succeeded = !(mercury__dir__succeeded);
        }
    }
    if (!(mercury__dir__succeeded))
      {
        MR_Char mercury__dir__V_5_5;

{
#define MR_PROC_LABEL mercury__dir__is_directory_separator_1_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_CYGWIN)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
        if (mercury__dir__succeeded)
          mercury__dir__V_5_5 = (MR_Char) 92;
        else
          mercury__dir__V_5_5 = (MR_Char) 47;
        mercury__dir__succeeded = (mercury__dir__Char_2 == mercury__dir__V_5_5);
      }
    return mercury__dir__succeeded;
  }
}

void MR_CALL 
mercury__dir__directory_separator_1_p_0(
  MR_Char * mercury__dir__HeadVar__1_1)
{
  {
    MR_bool mercury__dir__succeeded;

{
#define MR_PROC_LABEL mercury__dir__directory_separator_1_p_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    if (mercury__dir__succeeded)
      *mercury__dir__HeadVar__1_1 = (MR_Char) 92;
    else
      *mercury__dir__HeadVar__1_1 = (MR_Char) 47;
  }
}

MR_Char MR_CALL 
mercury__dir__directory_separator_0_f_0(void)
{
  {
    MR_bool mercury__dir__succeeded;
    MR_Char mercury__dir__HeadVar__1_1;

{
#define MR_PROC_LABEL mercury__dir__directory_separator_0_f_0

	MR_bool SUCCESS_INDICATOR;

		{

#if defined(MR_WIN32)
    SUCCESS_INDICATOR = MR_TRUE;
#else
    SUCCESS_INDICATOR = MR_FALSE;
#endif


		;}
#undef MR_PROC_LABEL
	if (SUCCESS_INDICATOR) {
	}
mercury__dir__succeeded  = SUCCESS_INDICATOR;
}
    if (mercury__dir__succeeded)
      mercury__dir__HeadVar__1_1 = (MR_Char) 92;
    else
      mercury__dir__HeadVar__1_1 = (MR_Char) 47;
    return mercury__dir__HeadVar__1_1;
  }
}

void mercury__dir__init(void)
{
}

void mercury__dir__init_type_tables(void)
{
	static MR_bool initialised = MR_FALSE;
	if (initialised) return;
	initialised = MR_TRUE;

	MR_register_type_ctor_info(&mercury__dir__dir__type_ctor_info_foldl_pred_1);
	MR_register_type_ctor_info(&mercury__dir__dir__type_ctor_info_stream_0);
}

void mercury__dir__init_debugger(void)
{
	MR_fatal_error("debugger initialization in MLDS grade");
}

/* ensure everything is compiled with the same grade */
static const void *const MR_grade = &MR_GRADE_VAR;

/* :- end_module dir. */
