/*
** Automatically generated from `backjump.m'
** by the Mercury compiler,
** version rotd-2015-09-15
** configured for x86_64-apple-darwin13.4.0.
** Do not edit.
**
** The autoconfigured grade settings governing
** the generation of this C file were
**
** TAG_BITS=2
** UNBOXED_FLOAT=no
** PREGENERATED_DIST=yes
** HIGHLEVEL_CODE=yes
**
** END_OF_C_GRADE_INFO
*/


/* :- module backjump. */
/* :- implementation. */

/*
INIT mercury__backjump__init
ENDINIT
*/

#include "backjump.mih"
#include "backjump.mh"


#include "array.mih"
#include "assoc_list.mih"
#include "benchmarking.mih"
#include "bitmap.mih"
#include "bool.mih"
#include "builtin.mih"
#include "calendar.mih"
#include "char.mih"
#include "construct.mih"
#include "cord.mih"
#include "deconstruct.mih"
#include "dir.mih"
#include "enum.mih"
#include "erlang_rtti_implementation.mih"
#include "exception.mih"
#include "float.mih"
#include "int.mih"
#include "integer.mih"
#include "io.mih"
#include "lexer.mih"
#include "list.mih"
#include "map.mih"
#include "math.mih"
#include "maybe.mih"
#include "mutvar.mih"
#include "ops.mih"
#include "pair.mih"
#include "parser.mih"
#include "pretty_printer.mih"
#include "private_builtin.mih"
#include "random.mih"
#include "require.mih"
#include "rtti_implementation.mih"
#include "set.mih"
#include "set_ordlist.mih"
#include "set_tree234.mih"
#include "solutions.mih"
#include "std_util.mih"
#include "stm_builtin.mih"
#include "store.mih"
#include "stream.mih"
#include "string.mih"
#include "table_builtin.mih"
#include "term.mih"
#include "term_conversion.mih"
#include "term_io.mih"
#include "time.mih"
#include "tree234.mih"
#include "type_desc.mih"
#include "unit.mih"
#include "univ.mih"
#include "varset.mih"
#include "version_array.mih"
#include "stream.string_writer.mih"
#include "string.format.mih"
#include "string.parse_runtime.mih"
#include "string.parse_util.mih"
#include "string.to_string.mih"






#line 97 "backjump.c"
static MR_bool MR_CALL 
mercury__backjump____Unify____choice_id_0_0_10001(
#line 100 "backjump.c"
  MR_Box mercury__backjump__wrapper_arg_1,
#line 102 "backjump.c"
  MR_Box mercury__backjump__wrapper_arg_2);

#line 105 "backjump.c"
static void MR_CALL 
mercury__backjump____Compare____choice_id_0_0_10001(
#line 108 "backjump.c"
  MR_Box * mercury__backjump__wrapper_arg_1,
#line 110 "backjump.c"
  MR_Box mercury__backjump__wrapper_arg_2,
#line 112 "backjump.c"
  MR_Box mercury__backjump__wrapper_arg_3);

#line 18 "ops.opt"
static MR_Integer MR_CALL 
mercury__backjump__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_67_108_97_115_115_77_101_116_104_111_100_95_102_111_114_95_111_112_115_95_95_111_112_95_116_97_98_108_101_95_95_95_95_111_112_115_95_95_109_101_114_99_117_114_121_95_111_112_95_116_97_98_108_101_95_95_97_114_105_116_121_48_95_95_95_95_95_95_111_112_115_95_95_109_97_120_95_112_114_105_111_114_105_116_121_95_49_95_95_91_49_93_95_48_1_f_in__ops_0(void);

#line 477 "backjump.m"
static void MR_CALL 
mercury__backjump__report_invalid_backjump_3_p_0(
#line 477 "backjump.m"
  MR_Integer mercury__backjump__Id_4);

#line 106 "backjump.m"
void MR_CALL 
mercury__backjump__builtin_backjump_1_p_0(
#line 106 "backjump.m"
  MR_Integer mercury__backjump__HeadVar__1_1);

#line 103 "backjump.m"
void MR_CALL 
mercury__backjump__builtin_choice_id_1_p_0(
#line 103 "backjump.m"
  MR_Integer * mercury__backjump__HeadVar__1_1,
#line 103 "backjump.m"
  MR_Cont mercury__backjump__cont,
#line 103 "backjump.m"
  void * mercury__backjump__cont_env_ptr);


static /* final */ const MR_Box mercury__backjump_scalar_common_1[1][3];

static /* final */ const MR_Box mercury__backjump_scalar_common_2[1][4];

static /* final */ const MR_Box mercury__backjump_scalar_common_3[2][5];

static /* final */ const MR_Box mercury__backjump_scalar_common_4[1][1];




static /* final */ const MR_Box mercury__backjump_scalar_common_1[1][3] = {
  /* row 0 */
  {
    ((MR_Box) (base_typeclass_info_stream__stream__arity2__io__output_stream__arity0__io__state__arity0__)),
    ((MR_Box) (&mercury__io__io__type_ctor_info_output_stream_0)),
    ((MR_Box) (&mercury__io__io__type_ctor_info_state_0))
  },
};

static /* final */ const MR_Box mercury__backjump_scalar_common_2[1][4] = {
  /* row 0 */
  {
    ((MR_Box) (base_typeclass_info_stream__output__arity2__io__output_stream__arity0__io__state__arity0__)),
    ((MR_Box) (&mercury__backjump_scalar_common_1[0])),
    ((MR_Box) (&mercury__io__io__type_ctor_info_output_stream_0)),
    ((MR_Box) (&mercury__io__io__type_ctor_info_state_0))
  },
};

static /* final */ const MR_Box mercury__backjump_scalar_common_3[2][5] = {
  /* row 0 */
  {
    ((MR_Box) (base_typeclass_info_stream__writer__arity3__io__output_stream__arity0__string__arity0__io__state__arity0__)),
    ((MR_Box) (&mercury__backjump_scalar_common_2[0])),
    ((MR_Box) (&mercury__io__io__type_ctor_info_output_stream_0)),
    ((MR_Box) (&mercury__builtin__builtin__type_ctor_info_string_0)),
    ((MR_Box) (&mercury__io__io__type_ctor_info_state_0))
  },
  /* row 1 */
  {
    ((MR_Box) (base_typeclass_info_stream__writer__arity3__io__output_stream__arity0__character__arity0__io__state__arity0__)),
    ((MR_Box) (&mercury__backjump_scalar_common_2[0])),
    ((MR_Box) (&mercury__io__io__type_ctor_info_output_stream_0)),
    ((MR_Box) (&mercury__builtin__builtin__type_ctor_info_character_0)),
    ((MR_Box) (&mercury__io__io__type_ctor_info_state_0))
  },
};

static /* final */ const MR_Box mercury__backjump_scalar_common_4[1][1] = {
  /* row 0 */
  {
    ((MR_Box) (((MR_Integer) 0 | (((((MR_Integer) 0 << (MR_Integer) 1)) | (((((MR_Integer) 0 << (MR_Integer) 2)) | (((((MR_Integer) 0 << (MR_Integer) 3)) | (((MR_Integer) 0 << (MR_Integer) 4)))))))))))
  },
};



#include "array.mh"
#include "backjump.mh"
#include "benchmarking.mh"
#include "bitmap.mh"
#include "builtin.mh"
#include "char.mh"
#include "construct.mh"
#include "dir.mh"
#include "exception.mh"
#include "float.mh"
#include "int.mh"
#include "io.mh"
#include "math.mh"
#include "pretty_printer.mh"
#include "private_builtin.mh"
#include "rtti_implementation.mh"
#include "stm_builtin.mh"
#include "store.mh"
#include "string.mh"
#include "table_builtin.mh"
#include "time.mh"
#include "type_desc.mh"
#include "version_array.mh"
#line 158 "backjump.m"

#ifdef MR_HIGHLEVEL_CODE

#ifdef MR_NATIVE_GC

/*
** XXX code is needed to trace the local variables
** in the builtin_choice_id predicate for accurate GC.
*/

#endif /* MR_NATIVE_GC */

void MR_CALL
mercury__backjump__builtin_choice_id_1_p_0(MR_Integer *id, MR_CONT_PARAMS)
{
    MR_BackJumpHandler this_handler;

    this_handler.MR_bjh_prev = MR_GET_BACKJUMP_HANDLER();
    this_handler.MR_bjh_id = MR_GET_NEXT_CHOICE_ID();
    MR_SET_BACKJUMP_HANDLER(&this_handler);

    if (setjmp(this_handler.MR_bjh_handler) == 0) {
    #ifdef MR_DEBUG_JMPBUFS
        fprintf(stderr, "choice setjmp %p\n", this_handler.MR_bjh_handler);
    #endif

        *id = this_handler.MR_bjh_id;
        MR_CONT_CALL();
    } else {
    #ifdef MR_DEBUG_JMPBUFS
        fprintf(stderr, "choice caught jmp %p\n", this_handler.MR_bjh_handler);
    #endif
    }

    MR_SET_BACKJUMP_HANDLER(this_handler.MR_bjh_prev);
}

void MR_CALL
mercury__backjump__builtin_backjump_1_p_0(MR_BackJumpChoiceId id)
{
    MR_BackJumpHandler *backjump_handler;

    backjump_handler = MR_GET_BACKJUMP_HANDLER();

    /*
    ** XXX when we commit and prune away nondet stack frames, we leave the
    ** backjump handlers on the stack. If the caller tries to backjump to
    ** a frame that has been pruned away, the handler may still be on the
    ** stack and we won't detect the problem.
    **
    ** We could avoid this problem by adding a trailing function which
    ** prunes back the handler stack on a commit, which would mean that in
    ** this case we will reach the bottom of the stack and call
    ** ML_report_invalid_backjump rather than seg faulting. But that would
    ** require trailing to be always available. Instead, we just rely on
    ** the caller only backjumping to frames that actually do exist.
    **
    ** (The same problem would occur if the caller tries to backjump to a
    ** frame that has already failed. In this case, though, the choice ID
    ** will also no longer be live since the call to get_choice_id would have
    ** been backtracked over, so this isn't as much of a problem as with
    ** commits.)
    */
    while (backjump_handler != NULL) {
        if (backjump_handler->MR_bjh_id == id) {
            break;
        }
        backjump_handler = backjump_handler->MR_bjh_prev;
    }

    if (backjump_handler == NULL) {
        ML_report_invalid_backjump(id);
        exit(EXIT_FAILURE);
    } else {

  #ifdef MR_DEBUG_JMPBUFS
        fprintf(stderr, "backjump longjmp %p\n",
            backjump_handler->MR_bjh_handler);
  #endif
        longjmp(backjump_handler->MR_bjh_handler, 1);
    }
}

#endif /* MR_HIGHLEVEL_CODE */

#line 263 "backjump.m"

void mercury_sys_init_backjumps_init(void);
void mercury_sys_init_backjumps_init_type_tables(void);
#ifdef MR_DEEP_PROFILING
void mercury_sys_init_backjumps_write_out_proc_statics(FILE *deep_fp,
    FILE *procrep_fp);
#endif

#ifndef MR_HIGHLEVEL_CODE

#define ML_DUMMY_LINE 0

#define ML_BACKJUMP_STRUCT     (((MR_BackJumpHandler *) (MR_curfr + 1 - MR_NONDET_FIXED_SIZE)) - 1)

#ifdef ML_DEBUG_BACKJUMPS
#define ML_BACKJUMP_CHECKPOINT(s, p)     do {         fflush(stdout);         fprintf(stderr, "backjumps (%s): "             "loc %p, prev %p, id %d, sp %p, fr %p\n",             s, p, p->MR_bjh_prev, p->MR_bjh_id, p->MR_bjh_saved_sp,             p->MR_bjh_saved_fr);     } while (0)
#else
#define ML_BACKJUMP_CHECKPOINT(s, p)
#endif

MR_define_extern_entry(mercury__backjump__builtin_choice_id_1_0);
MR_define_extern_entry(mercury__backjump__builtin_backjump_1_0);

MR_declare_label(mercury__backjump__builtin_choice_id_1_0_i1);

MR_proc_static_user_no_site(backjump, builtin_choice_id, 1, 0,
    "backjump.m", ML_DUMMY_LINE, MR_TRUE);
MR_proc_static_user_no_site(backjump, builtin_backjump, 1, 0,
    "backjump.m", ML_DUMMY_LINE, MR_TRUE);

MR_EXTERN_USER_PROC_STATIC_PROC_LAYOUT(MR_DETISM_NON,
    MR_PROC_NO_SLOT_COUNT, -1, MR_PREDICATE, backjump, builtin_choice_id,
    1, 0);
MR_EXTERN_USER_PROC_STATIC_PROC_LAYOUT(MR_DETISM_DET, 1,
    MR_LONG_LVAL_STACKVAR_INT(1), MR_PREDICATE, backjump,
    builtin_backjump, 1, 0);

MR_MAKE_USER_INTERNAL_LAYOUT(backjump, builtin_choice_id, 1, 0, 1);

MR_BEGIN_MODULE(hand_written_backjump_module)
    MR_init_entry_sl(mercury__backjump__builtin_choice_id_1_0);
    MR_init_entry_sl(mercury__backjump__builtin_backjump_1_0);

    MR_init_label_sl(mercury__backjump__builtin_choice_id_1_0_i1);
MR_BEGIN_CODE

MR_define_entry(mercury__backjump__builtin_choice_id_1_0);
{
    MR_mkpragmaframe("builtin_choice_id/1", 0, MR_BackJumpHandler_Struct,
        MR_LABEL(mercury__backjump__builtin_choice_id_1_0_i1));

    #if defined(MR_DEEP_PROFILING)
        MR_fatal_error(
            "builtin_choice_id: NYI backjumping and deep profiling");
    #endif

    ML_BACKJUMP_STRUCT->MR_bjh_prev = MR_GET_BACKJUMP_HANDLER();
    ML_BACKJUMP_STRUCT->MR_bjh_id = MR_GET_NEXT_CHOICE_ID();
    ML_BACKJUMP_STRUCT->MR_bjh_saved_sp = MR_sp;
    ML_BACKJUMP_STRUCT->MR_bjh_saved_fr = MR_curfr;
    MR_SET_BACKJUMP_HANDLER(ML_BACKJUMP_STRUCT);

    ML_BACKJUMP_CHECKPOINT("create", ML_BACKJUMP_STRUCT);

    MR_r1 = (MR_Word) ML_BACKJUMP_STRUCT->MR_bjh_id;
    MR_succeed();
}
MR_define_label(mercury__backjump__builtin_choice_id_1_0_i1);
{
    /* Restore the previous handler. */
    MR_SET_BACKJUMP_HANDLER(ML_BACKJUMP_STRUCT->MR_bjh_prev);
    MR_fail();
}

MR_define_entry(mercury__backjump__builtin_backjump_1_0);
{
    MR_BackJumpChoiceId id = MR_r1;
    MR_BackJumpHandler *backjump_handler;

    backjump_handler = MR_GET_BACKJUMP_HANDLER();

    #if defined(MR_DEEP_PROFILING)
        MR_fatal_error(
            "builtin_backjump: NYI backjumping and deep profiling");
    #endif

    /*
    ** XXX see comments in the high-level implementation.
    */
    while (backjump_handler != NULL) {
        if (backjump_handler->MR_bjh_id == id) {
            break;
        }

        ML_BACKJUMP_CHECKPOINT("scan", backjump_handler);

        backjump_handler = backjump_handler->MR_bjh_prev;
    }

    if (backjump_handler == NULL) {
        ML_report_invalid_backjump(id);
        exit(EXIT_FAILURE);
    } else {
        ML_BACKJUMP_CHECKPOINT("found", backjump_handler);

        /*
        ** XXX we should produce some EXCP trace events here, to give
        ** the user an opportunity to retry a goal that calculated a
        ** (possibly incorrect) backjump.
        */

        MR_SET_BACKJUMP_HANDLER(backjump_handler->MR_bjh_prev);
        MR_sp_word = (MR_Word) backjump_handler->MR_bjh_saved_sp;
        MR_maxfr_word = (MR_Word) backjump_handler->MR_bjh_saved_fr;
        MR_fail();
    }
}

MR_END_MODULE

#endif /* !MR_HIGHLEVEL_CODE */

/*
INIT mercury_sys_init_backjumps
*/

void mercury_sys_init_backjumps_init(void)
{
#ifndef MR_HIGHLEVEL_CODE
    hand_written_backjump_module();
#endif
}

void mercury_sys_init_backjumps_init_type_tables(void)
{
    /* no types to register */
}

#ifdef MR_DEEP_PROFILING
void
mercury_sys_init_backjumps_write_out_proc_statics(FILE *deep_fp,
    FILE *procrep_fp)
{
    MR_write_out_user_proc_static(deep_fp, procrep_fp,
        &MR_proc_layout_user_name(backjump, builtin_choice_id, 1, 0));
    MR_write_out_user_proc_static(deep_fp, procrep_fp,
        &MR_proc_layout_user_name(backjump, builtin_backjump, 1, 0));
}
#endif /* MR_DEEP_PROFILING */


#line 474 "backjump.m"
void 
ML_report_invalid_backjump(
#line 474 "backjump.m"
  MR_Integer mercury__backjump__Id_4)
#line 474 "backjump.m"
{
#line 474 "backjump.m"
	mercury__backjump__report_invalid_backjump_3_p_0((MR_Integer) mercury__backjump__Id_4);
}


#line 473 "backjump.c"
const MR_TypeCtorInfo_Struct mercury__backjump__backjump__type_ctor_info_choice_id_0 = {
  (MR_Integer) 0,
  (MR_Integer) 15,
  (MR_Integer) -1,
  mercury__private_builtin__MR_TYPECTOR_REP_EQUIV_GROUND,
  ((MR_Box) (mercury__backjump____Unify____choice_id_0_0_10001)),
  ((MR_Box) (mercury__backjump____Compare____choice_id_0_0_10001)),
  (MR_String) "backjump",
  (MR_String) "choice_id",
  {     NULL },
  {     (MR_PseudoTypeInfo) &mercury__builtin__builtin__type_ctor_info_int_0 },
  (MR_Integer) -1,
  (MR_Integer) 0,
  NULL
};

#line 490 "backjump.c"
static MR_bool MR_CALL 
mercury__backjump____Unify____choice_id_0_0_10001(
#line 493 "backjump.c"
  MR_Box mercury__backjump__wrapper_arg_1,
#line 495 "backjump.c"
  MR_Box mercury__backjump__wrapper_arg_2)
#line 497 "backjump.c"
{
#line 499 "backjump.c"
  {
#line 501 "backjump.c"
    MR_bool mercury__backjump__succeeded;

#line 504 "backjump.c"
    {
#line 506 "backjump.c"
      mercury__backjump__succeeded = mercury__backjump____Unify____choice_id_0_0(((MR_Integer) mercury__backjump__wrapper_arg_1), ((MR_Integer) mercury__backjump__wrapper_arg_2));
    }
#line 509 "backjump.c"
    return mercury__backjump__succeeded;
#line 511 "backjump.c"
  }
#line 513 "backjump.c"
}

#line 516 "backjump.c"
static void MR_CALL 
mercury__backjump____Compare____choice_id_0_0_10001(
#line 519 "backjump.c"
  MR_Box * mercury__backjump__wrapper_arg_1,
#line 521 "backjump.c"
  MR_Box mercury__backjump__wrapper_arg_2,
#line 523 "backjump.c"
  MR_Box mercury__backjump__wrapper_arg_3)
#line 525 "backjump.c"
{
#line 527 "backjump.c"
  {
#line 529 "backjump.c"
    MR_Word mercury__backjump__conv0_HeadVar__1_1;

#line 532 "backjump.c"
    {
#line 534 "backjump.c"
      mercury__backjump____Compare____choice_id_0_0(&mercury__backjump__conv0_HeadVar__1_1, ((MR_Integer) mercury__backjump__wrapper_arg_2), ((MR_Integer) mercury__backjump__wrapper_arg_3));
    }
#line 537 "backjump.c"
    *mercury__backjump__wrapper_arg_1 = ((MR_Box) (mercury__backjump__conv0_HeadVar__1_1));
#line 539 "backjump.c"
  }
#line 541 "backjump.c"
}

#line 18 "ops.opt"
static MR_Integer MR_CALL 
mercury__backjump__f_85_110_117_115_101_100_65_114_103_115_95_95_102_117_110_99_95_95_67_108_97_115_115_77_101_116_104_111_100_95_102_111_114_95_111_112_115_95_95_111_112_95_116_97_98_108_101_95_95_95_95_111_112_115_95_95_109_101_114_99_117_114_121_95_111_112_95_116_97_98_108_101_95_95_97_114_105_116_121_48_95_95_95_95_95_95_111_112_115_95_95_109_97_120_95_112_114_105_111_114_105_116_121_95_49_95_95_91_49_93_95_48_1_f_in__ops_0(void)
#line 18 "ops.opt"
{
#line 47 "ops.opt"
  {
#line 47 "ops.opt"
    MR_bool mercury__backjump__succeeded;

#line 47 "ops.opt"
    return (MR_Integer) 1200;
#line 47 "ops.opt"
  }
#line 18 "ops.opt"
}

#line 89 "backjump.m"
void MR_CALL 
mercury__backjump____Compare____choice_id_0_0(
#line 89 "backjump.m"
  MR_Word * mercury__backjump__HeadVar__1_1,
#line 89 "backjump.m"
  MR_Integer mercury__backjump__HeadVar__2_2,
#line 89 "backjump.m"
  MR_Integer mercury__backjump__HeadVar__3_3)
#line 89 "backjump.m"
{
#line 89 "backjump.m"
  {
#line 89 "backjump.m"
    MR_bool mercury__backjump__succeeded;
#line 89 "backjump.m"
    MR_Integer mercury__backjump__Cast_HeadVar1_4 = mercury__backjump__HeadVar__2_2;
#line 89 "backjump.m"
    MR_Integer mercury__backjump__Cast_HeadVar2_5 = mercury__backjump__HeadVar__3_3;

#line 71 "private_builtin.opt"
    mercury__backjump__succeeded = (mercury__backjump__Cast_HeadVar1_4 < mercury__backjump__Cast_HeadVar2_5);
#line 74 "private_builtin.opt"
    if (mercury__backjump__succeeded)
#line 73 "private_builtin.opt"
      *mercury__backjump__HeadVar__1_1 = (MR_Integer) 1;
#line 74 "private_builtin.opt"
    else
#line 79 "private_builtin.opt"
      {
#line 76 "private_builtin.opt"
        mercury__backjump__succeeded = (mercury__backjump__Cast_HeadVar1_4 == mercury__backjump__Cast_HeadVar2_5);
#line 79 "private_builtin.opt"
        if (mercury__backjump__succeeded)
#line 78 "private_builtin.opt"
          *mercury__backjump__HeadVar__1_1 = (MR_Integer) 0;
#line 79 "private_builtin.opt"
        else
#line 80 "private_builtin.opt"
          *mercury__backjump__HeadVar__1_1 = (MR_Integer) 2;
#line 79 "private_builtin.opt"
      }
#line 89 "backjump.m"
  }
#line 89 "backjump.m"
}

#line 89 "backjump.m"
MR_bool MR_CALL 
mercury__backjump____Unify____choice_id_0_0(
#line 89 "backjump.m"
  MR_Integer mercury__backjump__HeadVar__1_1,
#line 89 "backjump.m"
  MR_Integer mercury__backjump__HeadVar__2_2)
#line 89 "backjump.m"
{
#line 89 "backjump.m"
  {
#line 89 "backjump.m"
    MR_bool mercury__backjump__succeeded;
#line 89 "backjump.m"
    MR_Integer mercury__backjump__Cast_HeadVar1_3 = mercury__backjump__HeadVar__1_1;
#line 89 "backjump.m"
    MR_Integer mercury__backjump__Cast_HeadVar2_4 = mercury__backjump__HeadVar__2_2;

#line 89 "backjump.m"
    mercury__backjump__succeeded = (mercury__backjump__Cast_HeadVar1_3 == mercury__backjump__Cast_HeadVar2_4);
#line 89 "backjump.m"
    return mercury__backjump__succeeded;
#line 89 "backjump.m"
  }
#line 89 "backjump.m"
}

#line 477 "backjump.m"
static void MR_CALL 
mercury__backjump__report_invalid_backjump_3_p_0(
#line 477 "backjump.m"
  MR_Integer mercury__backjump__Id_4)
#line 477 "backjump.m"
{
#line 479 "backjump.m"
  {
#line 479 "backjump.m"
    MR_bool mercury__backjump__succeeded;
#line 479 "backjump.m"
    MR_Word mercury__backjump__StdErr_6;
#line 479 "backjump.m"
    MR_String mercury__backjump__V_20_20;
#line 479 "backjump.m"
    MR_Word mercury__backjump__V_26_26;
#line 479 "backjump.m"
    MR_Box mercury__backjump__V_5_34;
#line 479 "backjump.m"
    MR_Word mercury__backjump__V_7_38;
#line 479 "backjump.m"
    MR_Word mercury__backjump__V_8_39;
#line 479 "backjump.m"
    MR_Box mercury__backjump__V_5_43;
#line 479 "backjump.m"
    MR_Box mercury__backjump__V_5_47;
#line 479 "backjump.m"
    MR_Box mercury__backjump__V_4_50;

#line 732 "io.opt"
{
#define MR_PROC_LABEL mercury__backjump__report_invalid_backjump_3_p_0


		{
#line 732 "io.opt"

    MercuryFilePtr out = mercury_current_text_output();
    if (MR_FLUSH(*out) < 0) {
        mercury_output_error(out, errno);
    }

#line 678 "backjump.c"

		;}
#undef MR_PROC_LABEL
#line 732 "io.opt"
}
#line 1341 "io.opt"
{
#define MR_PROC_LABEL mercury__backjump__report_invalid_backjump_3_p_0

	MercuryFilePtr Stream;

		{
#line 1341 "io.opt"

    Stream = &mercury_stderr;

#line 695 "backjump.c"

		;}
#undef MR_PROC_LABEL
	 mercury__backjump__V_5_34  = (MR_Box) Stream;
#line 1341 "io.opt"
}
#line 1334 "io.opt"
    mercury__backjump__StdErr_6 = (MR_Word) mercury__backjump__V_5_34;
#line 1592 "io.opt"
{
#define MR_PROC_LABEL mercury__backjump__report_invalid_backjump_3_p_0

	MercuryFilePtr Stream;
	MR_String Message;

	Stream = (MercuryFilePtr) mercury__backjump__V_5_34 ;
	Message =  (MR_String) "Uncaught Mercury backjump (" ;
		{
#line 1592 "io.opt"

    mercury_print_string(Stream, Message);

#line 718 "backjump.c"

		;}
#undef MR_PROC_LABEL
#line 1592 "io.opt"
}
#line 724 "backjump.c"
    mercury__backjump__V_26_26 = (MR_Word) &mercury__backjump_scalar_common_4[0];
#line 63 "string.format.opt"
    mercury__backjump__V_7_38 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
#line 64 "string.format.opt"
    mercury__backjump__V_8_39 = (MR_Word) MR_mkword(MR_mktag(0), MR_mkbody((MR_Integer) 0));
#line 65 "string.format.opt"
    {
#line 65 "string.format.opt"
      mercury__string__format__format_signed_int_component_5_p_0(mercury__backjump__V_26_26, mercury__backjump__V_7_38, mercury__backjump__V_8_39, mercury__backjump__Id_4, &mercury__backjump__V_20_20);
    }
#line 1589 "io.opt"
    mercury__backjump__V_5_43 = (MR_Box) mercury__backjump__StdErr_6;
#line 1592 "io.opt"
{
#define MR_PROC_LABEL mercury__backjump__report_invalid_backjump_3_p_0

	MercuryFilePtr Stream;
	MR_String Message;

	Stream = (MercuryFilePtr) mercury__backjump__V_5_43 ;
	Message =  mercury__backjump__V_20_20 ;
		{
#line 1592 "io.opt"

    mercury_print_string(Stream, Message);

#line 751 "backjump.c"

		;}
#undef MR_PROC_LABEL
#line 1592 "io.opt"
}
#line 1589 "io.opt"
    mercury__backjump__V_5_47 = (MR_Box) mercury__backjump__StdErr_6;
#line 1592 "io.opt"
{
#define MR_PROC_LABEL mercury__backjump__report_invalid_backjump_3_p_0

	MercuryFilePtr Stream;
	MR_String Message;

	Stream = (MercuryFilePtr) mercury__backjump__V_5_47 ;
	Message =  (MR_String) ")\n" ;
		{
#line 1592 "io.opt"

    mercury_print_string(Stream, Message);

#line 773 "backjump.c"

		;}
#undef MR_PROC_LABEL
#line 1592 "io.opt"
}
#line 739 "io.opt"
    mercury__backjump__V_4_50 = (MR_Box) mercury__backjump__StdErr_6;
#line 742 "io.opt"
{
#define MR_PROC_LABEL mercury__backjump__report_invalid_backjump_3_p_0

	MercuryFilePtr Stream;

	Stream = (MercuryFilePtr) mercury__backjump__V_4_50 ;
		{
#line 742 "io.opt"

    if (MR_FLUSH(*Stream) < 0) {
        mercury_output_error(Stream, errno);
    }

#line 795 "backjump.c"

		;}
#undef MR_PROC_LABEL
#line 742 "io.opt"
}
#line 479 "backjump.m"
  }
#line 477 "backjump.m"
}

#line 106 "backjump.m"
void MR_CALL 
mercury__backjump__builtin_backjump_1_p_0(
#line 106 "backjump.m"
  MR_Integer mercury__backjump__HeadVar__1_1);

#line 103 "backjump.m"
void MR_CALL 
mercury__backjump__builtin_choice_id_1_p_0(
#line 103 "backjump.m"
  MR_Integer * mercury__backjump__HeadVar__1_1,
#line 103 "backjump.m"
  MR_Cont mercury__backjump__cont,
#line 103 "backjump.m"
  void * mercury__backjump__cont_env_ptr);

#line 79 "backjump.m"
MR_Integer MR_CALL 
mercury__backjump__to_int_1_f_0(
#line 79 "backjump.m"
  MR_Integer mercury__backjump__P_3)
#line 79 "backjump.m"
{
#line 487 "backjump.m"
  {
#line 487 "backjump.m"
    MR_bool mercury__backjump__succeeded;
#line 487 "backjump.m"
    MR_Integer mercury__backjump__P_2 = mercury__backjump__P_3;

#line 487 "backjump.m"
    return mercury__backjump__P_2;
#line 487 "backjump.m"
  }
#line 79 "backjump.m"
}

#line 66 "backjump.m"
void MR_CALL 
mercury__backjump__backjump_1_p_0(
#line 66 "backjump.m"
  MR_Integer mercury__backjump__Id_2)
#line 66 "backjump.m"
{
#line 95 "backjump.m"
  {
#line 95 "backjump.m"
    MR_bool mercury__backjump__succeeded;

#line 95 "backjump.m"
    {
#line 95 "backjump.m"
      mercury__backjump__builtin_backjump_1_p_0(mercury__backjump__Id_2);
#line 95 "backjump.m"
      return;
    }
#line 95 "backjump.m"
  }
#line 66 "backjump.m"
}

#line 60 "backjump.m"
void MR_CALL 
mercury__backjump__get_choice_id_1_p_0(
#line 60 "backjump.m"
  MR_Integer * mercury__backjump__Id_2,
#line 60 "backjump.m"
  MR_Cont mercury__backjump__cont,
#line 60 "backjump.m"
  void * mercury__backjump__cont_env_ptr)
#line 60 "backjump.m"
{
#line 92 "backjump.m"
  {
#line 92 "backjump.m"
    MR_bool mercury__backjump__succeeded;

#line 92 "backjump.m"
    {
#line 92 "backjump.m"
      mercury__backjump__builtin_choice_id_1_p_0(mercury__backjump__Id_2, mercury__backjump__cont, mercury__backjump__cont_env_ptr);
#line 92 "backjump.m"
      return;
    }
#line 92 "backjump.m"
  }
#line 60 "backjump.m"
}

void mercury__backjump__init(void)
{
}

void mercury__backjump__init_type_tables(void)
{
	static MR_bool initialised = MR_FALSE;
	if (initialised) return;
	initialised = MR_TRUE;

	MR_register_type_ctor_info(&mercury__backjump__backjump__type_ctor_info_choice_id_0);
}

void mercury__backjump__init_debugger(void)
{
	MR_fatal_error("debugger initialization in MLDS grade");
}

/* ensure everything is compiled with the same grade */
static const void *const MR_grade = &MR_GRADE_VAR;

/* :- end_module backjump. */
